<!-- Generated by Cython 0.19.1 on Tue Mar 18 15:39:26 2014 -->
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">

body { font-family: courier; font-size: 12; }

.code  { font-size: 9; color: #444444; display: none; margin-left: 20px; }
.py_c_api  { color: red; }
.py_macro_api  { color: #FF7000; }
.pyx_c_api  { color: #FF3000; }
.pyx_macro_api  { color: #FF7000; }
.refnanny  { color: #FFA000; }

.error_goto  { color: #FFA000; }

.tag  {  }

.coerce  { color: #008000; border: 1px dotted #008000 }

.py_attr { color: #FF0000; font-weight: bold; }
.c_attr  { color: #0000FF; }

.py_call { color: #FF0000; font-weight: bold; }
.c_call  { color: #0000FF; }

.line { margin: 0em }

</style>
<script>
function toggleDiv(id) {
    theDiv = document.getElementById(id);
    if (theDiv.style.display == 'none') theDiv.style.display = 'block';
    else theDiv.style.display = 'none';
}
</script>
</head>
        <body>
<p>Generated by Cython 0.19.1 on Tue Mar 18 15:39:26 2014
<p>Raw output: <a href="libchemicalstring_2.c">libchemicalstring_2.c</a>
<pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1")'> 1: #imports</pre>
<pre id='line1' class='code' style='background-color: #FFFF79'>
  /* "libchemicalstring_2.pyx":1
 * #imports             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cimport cython
 * 
 */
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s____test__, ((PyObject *)__pyx_t_2)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2")'> 2: cimport cython</pre>
<pre id='line2' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line3")'> 3: </pre>
<pre id='line3' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line4")'> 4: from libc.math cimport log as log</pre>
<pre id='line4' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line5")'> 5: #from libc.math cimport sin as sinc</pre>
<pre id='line5' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line6")'> 6: #from libc.math cimport cos as cosc</pre>
<pre id='line6' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line7")'> 7: #from math import log as log</pre>
<pre id='line7' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line8")'> 8: from math import sin as sin</pre>
<pre id='line8' class='code' style='background-color: #FFFF57'>
  /* "libchemicalstring_2.pyx":8
 * #from libc.math cimport cos as cosc
 * #from math import log as log
 * from math import sin as sin             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from math import cos as cos
 * import numpy as np
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__sin));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__sin));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__sin));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__math), ((PyObject *)__pyx_t_1), -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s__sin);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__sin, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line9")'> 9: from math import cos as cos</pre>
<pre id='line9' class='code' style='background-color: #FFFF57'>
  /* "libchemicalstring_2.pyx":9
 * #from math import log as log
 * from math import sin as sin
 * from math import cos as cos             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import numpy as np
 * from numpy import random as rnd
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__cos));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__cos));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__cos));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__math), ((PyObject *)__pyx_t_2), -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s__cos);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__cos, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line10")'> 10: import numpy as np</pre>
<pre id='line10' class='code' style='background-color: #FFFF8d'>
  /* "libchemicalstring_2.pyx":10
 * from math import sin as sin
 * from math import cos as cos
 * import numpy as np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from numpy import random as rnd
 * import re
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__numpy), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__np, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line11")'> 11: from numpy import random as rnd</pre>
<pre id='line11' class='code' style='background-color: #FFFF57'>
  /* "libchemicalstring_2.pyx":11
 * from math import cos as cos
 * import numpy as np
 * from numpy import random as rnd             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import re
 * import random
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__random));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__random));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__random));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__numpy), ((PyObject *)__pyx_t_1), -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s__random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__rnd, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line12")'> 12: import re</pre>
<pre id='line12' class='code' style='background-color: #FFFF8d'>
  /* "libchemicalstring_2.pyx":12
 * import numpy as np
 * from numpy import random as rnd
 * import re             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import random
 * 
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__re), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__re, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line13")'> 13: import random</pre>
<pre id='line13' class='code' style='background-color: #FFFF8d'>
  /* "libchemicalstring_2.pyx":13
 * from numpy import random as rnd
 * import re
 * import random             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * pwm_square = None
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__random), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__random, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line14")'> 14: </pre>
<pre id='line14' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line15")'> 15: pwm_square = None</pre>
<pre id='line15' class='code' style='background-color: #FFFFaa'>
  /* "libchemicalstring_2.pyx":15
 * import random
 * 
 * pwm_square = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #Will's random number generator
 */
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__pwm_square, Py_None) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line16")'> 16: </pre>
<pre id='line16' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line17")'> 17: #Will's random number generator</pre>
<pre id='line17' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line18")'> 18: cdef class GENRAND:</pre>
<pre id='line18' class='code' style='background-color: #FFFFff'>
/* "libchemicalstring_2.pyx":18
 * 
 * #Will's random number generator
 * cdef class GENRAND:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	cdef long inow
 */
struct __pyx_obj_14stringchemical_GENRAND {
  PyObject_HEAD
  struct __pyx_vtabstruct_14stringchemical_GENRAND *__pyx_vtab;
  long inow;
  long SIZE;
  __Pyx_memviewslice randbuf;
};


/* "libchemicalstring_2.pyx":18
 * 
 * #Will's random number generator
 * cdef class GENRAND:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	cdef long inow
 */

struct __pyx_vtabstruct_14stringchemical_GENRAND {
  double (*gen)(struct __pyx_obj_14stringchemical_GENRAND *);
};
static struct __pyx_vtabstruct_14stringchemical_GENRAND *__pyx_vtabptr_14stringchemical_GENRAND;

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line19")'> 19: </pre>
<pre id='line19' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line20")'> 20: 	cdef long inow</pre>
<pre id='line20' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line21")'> 21: 	cdef long SIZE</pre>
<pre id='line21' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line22")'> 22: 	cdef double [:] randbuf</pre>
<pre id='line22' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line23")'> 23: </pre>
<pre id='line23' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line24")'> 24: 	def __init__(self, seed=1000):</pre>
<pre id='line24' class='code' style='background-color: #FFFFff'>
/* "libchemicalstring_2.pyx":24
 * 	cdef double [:] randbuf
 * 
 * 	def __init__(self, seed=1000):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		rnd.seed(seed)
 * 		self.inow = 0
 */

static int __pyx_pf_14stringchemical_7GENRAND___init__(struct __pyx_obj_14stringchemical_GENRAND *__pyx_v_self, PyObject *__pyx_v_seed) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line25")'> 25: 		rnd.seed(seed)</pre>
<pre id='line25' class='code' style='background-color: #FFFF4d'>
  /* "libchemicalstring_2.pyx":25
 * 
 * 	def __init__(self, seed=1000):
 * 		rnd.seed(seed)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		self.inow = 0
 * 		self.SIZE = 100000
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__rnd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__seed);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_seed);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_seed);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_seed);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line26")'> 26: 		self.inow = 0</pre>
<pre id='line26' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":26
 * 	def __init__(self, seed=1000):
 * 		rnd.seed(seed)
 * 		self.inow = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		self.SIZE = 100000
 * 		self.randbuf = rnd.random(size = self.SIZE)
 */
  __pyx_v_self->inow = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line27")'> 27: 		self.SIZE = 100000</pre>
<pre id='line27' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":27
 * 		rnd.seed(seed)
 * 		self.inow = 0
 * 		self.SIZE = 100000             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		self.randbuf = rnd.random(size = self.SIZE)
 * 
 */
  __pyx_v_self->SIZE = 100000;
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line28")'> 28: 		self.randbuf = rnd.random(size = self.SIZE)</pre>
<pre id='line28' class='code' style='background-color: #FFFF33'>
  /* "libchemicalstring_2.pyx":28
 * 		self.inow = 0
 * 		self.SIZE = 100000
 * 		self.randbuf = rnd.random(size = self.SIZE)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	cdef double gen(self):
 */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__rnd);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->SIZE);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, ((PyObject *)__pyx_n_s__size), __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_2);
  if (unlikely(!__pyx_t_4.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&__pyx_v_self->randbuf, 0);
  __pyx_v_self->randbuf = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  __PYX_XDEC_MEMVIEW(&__pyx_t_4, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.GENRAND.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line29")'> 29: </pre>
<pre id='line29' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line30")'> 30: 	cdef double gen(self):</pre>
<pre id='line30' class='code' style='background-color: #FFFFff'>
/* "libchemicalstring_2.pyx":30
 * 		self.randbuf = rnd.random(size = self.SIZE)
 * 
 * 	cdef double gen(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if (self.inow<code><</code>self.SIZE):
 * 			self.inow = self.inow+1
 */

static double __pyx_f_14stringchemical_7GENRAND_gen(struct __pyx_obj_14stringchemical_GENRAND *__pyx_v_self) {
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("gen", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line31")'> 31: 		if (self.inow&lt;self.SIZE):</pre>
<pre id='line31' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":31
 * 
 * 	cdef double gen(self):
 * 		if (self.inow<code><</code>self.SIZE):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			self.inow = self.inow+1
 * 			#print self.randbuf[self.inow-1]
 */
  __pyx_t_1 = ((__pyx_v_self->inow <code><</code> __pyx_v_self->SIZE) != 0);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line32")'> 32: 			self.inow = self.inow+1</pre>
<pre id='line32' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":32
 * 	cdef double gen(self):
 * 		if (self.inow<code><</code>self.SIZE):
 * 			self.inow = self.inow+1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			#print self.randbuf[self.inow-1]
 * 			return self.randbuf[self.inow-1]
 */
    __pyx_v_self->inow = (__pyx_v_self->inow + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line33")'> 33: 			#print self.randbuf[self.inow-1]</pre>
<pre id='line33' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line34")'> 34: 			return self.randbuf[self.inow-1]</pre>
<pre id='line34' class='code' style='background-color: #FFFF96'>
    /* "libchemicalstring_2.pyx":34
 * 			self.inow = self.inow+1
 * 			#print self.randbuf[self.inow-1]
 * 			return self.randbuf[self.inow-1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		else:
 * 			#print "buffer reset"
 */
    if (unlikely(!__pyx_v_self->randbuf.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}}
    __pyx_t_2 = (__pyx_v_self->inow - 1);
    __pyx_t_3 = -1;
    if (__pyx_t_2 <code><</code> 0) {
      __pyx_t_2 += __pyx_v_self->randbuf.shape[0];
      if (unlikely(__pyx_t_2 <code><</code> 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 >= __pyx_v_self->randbuf.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_r = (*((double *) ( /* dim=0 */ (__pyx_v_self->randbuf.data + __pyx_t_2 * __pyx_v_self->randbuf.strides[0]) )));
    goto __pyx_L0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line35")'> 35: 		else:</pre>
<pre id='line35' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line36")'> 36: 			#print "buffer reset"</pre>
<pre id='line36' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line37")'> 37: 			self.inow = 0</pre>
<pre id='line37' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":37
 * 		else:
 * 			#print "buffer reset"
 * 			self.inow = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			self.randbuf = rnd.random(size = self.SIZE)
 * 			#print self.randbuf[self.inow]
 */
    __pyx_v_self->inow = 0;
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line38")'> 38: 			self.randbuf = rnd.random(size = self.SIZE)</pre>
<pre id='line38' class='code' style='background-color: #FFFF39'>
    /* "libchemicalstring_2.pyx":38
 * 			#print "buffer reset"
 * 			self.inow = 0
 * 			self.randbuf = rnd.random(size = self.SIZE)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			#print self.randbuf[self.inow]
 * 			return self.randbuf[self.inow]
 */
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__rnd);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s__random);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
    __pyx_t_6 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->SIZE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, ((PyObject *)__pyx_n_s__size), __pyx_t_6) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_empty_tuple), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_6);
    if (unlikely(!__pyx_t_7.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __PYX_XDEC_MEMVIEW(&__pyx_v_self->randbuf, 0);
    __pyx_v_self->randbuf = __pyx_t_7;
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line39")'> 39: 			#print self.randbuf[self.inow]</pre>
<pre id='line39' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line40")'> 40: 			return self.randbuf[self.inow]</pre>
<pre id='line40' class='code' style='background-color: #FFFF41'>
    /* "libchemicalstring_2.pyx":40
 * 			self.randbuf = rnd.random(size = self.SIZE)
 * 			#print self.randbuf[self.inow]
 * 			return self.randbuf[self.inow]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class pwm_sq:
 */
    if (unlikely(!__pyx_v_self->randbuf.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}}
    __pyx_t_8 = __pyx_v_self->inow;
    __pyx_t_3 = -1;
    if (__pyx_t_8 <code><</code> 0) {
      __pyx_t_8 += __pyx_v_self->randbuf.shape[0];
      if (unlikely(__pyx_t_8 <code><</code> 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_8 >= __pyx_v_self->randbuf.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_r = (*((double *) ( /* dim=0 */ (__pyx_v_self->randbuf.data + __pyx_t_8 * __pyx_v_self->randbuf.strides[0]) )));
    goto __pyx_L0;
  }
  __pyx_L3:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&__pyx_t_7, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("stringchemical.GENRAND.gen", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_14stringchemical_6pwm_sq_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_14stringchemical_6pwm_sq_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  if (unlikely(__pyx_kwds) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 1))) return -1;
  __pyx_v_kwargs = (__pyx_kwds) ? <span class='py_c_api'>PyDict_Copy</span>(__pyx_kwds) : <span class='py_c_api'>PyDict_New</span>();
  if (unlikely(!__pyx_v_kwargs)) return -1;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_kwargs);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_14stringchemical_6pwm_sq___init__(((struct __pyx_obj_14stringchemical_pwm_sq *)__pyx_v_self), __pyx_v_args, __pyx_v_kwargs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line41")'> 41: </pre>
<pre id='line41' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line42")'> 42: cdef class pwm_sq:</pre>
<pre id='line42' class='code' style='background-color: #FFFFff'>
/* "libchemicalstring_2.pyx":42
 * 			return self.randbuf[self.inow]
 * 
 * cdef class pwm_sq:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	cdef double period
 */
struct __pyx_obj_14stringchemical_pwm_sq {
  PyObject_HEAD
  double period;
  double phase;
  double pwm_time_up;
  PyObject *domain;
  int dex0;
  int dex1;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line43")'> 43: </pre>
<pre id='line43' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line44")'> 44: 	cdef double period</pre>
<pre id='line44' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line45")'> 45: 	cdef double phase</pre>
<pre id='line45' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line46")'> 46: 	cdef double pwm_time_up</pre>
<pre id='line46' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line47")'> 47: 	cdef str domain</pre>
<pre id='line47' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line48")'> 48: 	cdef int dex0</pre>
<pre id='line48' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line49")'> 49: 	cdef int dex1</pre>
<pre id='line49' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line50")'> 50: </pre>
<pre id='line50' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line51")'> 51: 	#only gets initialized once, using paramters of first pwm_square found</pre>
<pre id='line51' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line52")'> 52: 	def __init__(self, *args, **kwargs):</pre>
<pre id='line52' class='code' style='background-color: #FFFFff'>
/* "libchemicalstring_2.pyx":52
 * 
 * 	#only gets initialized once, using paramters of first pwm_square found
 * 	def __init__(self, *args, **kwargs):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		global pwm_square
 * 
 */

static int __pyx_pf_14stringchemical_6pwm_sq___init__(struct __pyx_obj_14stringchemical_pwm_sq *__pyx_v_self, PyObject *__pyx_v_args, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_encoded = NULL;
  PyObject *__pyx_v_cnts = NULL;
  PyObject *__pyx_v_targs = NULL;
  PyObject *__pyx_v_dex0 = NULL;
  PyObject *__pyx_v_dex1 = NULL;
  PyObject *__pyx_v_params_str = NULL;
  PyObject *__pyx_v_params_val = NULL;
  PyObject *__pyx_v_par = NULL;
  PyObject *__pyx_v_dex = NULL;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line53")'> 53: 		global pwm_square</pre>
<pre id='line53' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line54")'> 54: </pre>
<pre id='line54' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line55")'> 55: 		encoded = args[0]</pre>
<pre id='line55' class='code' style='background-color: #FFFFd4'>
  /* "libchemicalstring_2.pyx":55
 * 		global pwm_square
 * 
 * 		encoded = args[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cnts = args[1]
 * 		targs = args[2]
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(((PyObject *)__pyx_v_args), 0, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_encoded = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line56")'> 56: 		cnts = args[1]</pre>
<pre id='line56' class='code' style='background-color: #FFFFd4'>
  /* "libchemicalstring_2.pyx":56
 * 
 * 		encoded = args[0]
 * 		cnts = args[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		targs = args[2]
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(((PyObject *)__pyx_v_args), 1, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_cnts = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line57")'> 57: 		targs = args[2]</pre>
<pre id='line57' class='code' style='background-color: #FFFFd4'>
  /* "libchemicalstring_2.pyx":57
 * 		encoded = args[0]
 * 		cnts = args[1]
 * 		targs = args[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(((PyObject *)__pyx_v_args), 2, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_targs = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line58")'> 58: </pre>
<pre id='line58' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line59")'> 59: 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')</pre>
<pre id='line59' class='code' style='background-color: #FFFF3b'>
  /* "libchemicalstring_2.pyx":59
 * 		targs = args[2]
 * 
 * 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		dex1 = encoded[dex0:].find(')') + dex0
 * 		params_str = encoded[dex0:dex1].split(':')
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_encoded, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_kp_s_1));<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dex0 = __pyx_t_4;
  __pyx_t_4 = 0;

  /* "libchemicalstring_2.pyx":59
 * 		targs = args[2]
 * 
 * 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		dex1 = encoded[dex0:].find(')') + dex0
 * 		params_str = encoded[dex0:dex1].split(':')
 */
  __pyx_k_tuple_2 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_1));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_2));
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line60")'> 60: 		dex1 = encoded[dex0:].find(')') + dex0</pre>
<pre id='line60' class='code' style='background-color: #FFFF43'>
  /* "libchemicalstring_2.pyx":60
 * 
 * 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')
 * 		dex1 = encoded[dex0:].find(')') + dex0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		params_str = encoded[dex0:dex1].split(':')
 * 		params_val = []
 */
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_encoded, 0, 0, &__pyx_v_dex0, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_v_dex0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_dex1 = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":60
 * 
 * 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')
 * 		dex1 = encoded[dex0:].find(')') + dex0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		params_str = encoded[dex0:dex1].split(':')
 * 		params_val = []
 */
  __pyx_k_tuple_4 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_3));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_4);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_4));
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line61")'> 61: 		params_str = encoded[dex0:dex1].split(':')</pre>
<pre id='line61' class='code' style='background-color: #FFFF4f'>
  /* "libchemicalstring_2.pyx":61
 * 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')
 * 		dex1 = encoded[dex0:].find(')') + dex0
 * 		params_str = encoded[dex0:dex1].split(':')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		params_val = []
 * 		for par in params_str[:-1]:
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_encoded, 0, 0, &__pyx_v_dex0, &__pyx_v_dex1, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_k_tuple_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_params_str = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":61
 * 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')
 * 		dex1 = encoded[dex0:].find(')') + dex0
 * 		params_str = encoded[dex0:dex1].split(':')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		params_val = []
 * 		for par in params_str[:-1]:
 */
  __pyx_k_tuple_6 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_5));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_6);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_6));
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line62")'> 62: 		params_val = []</pre>
<pre id='line62' class='code' style='background-color: #FFFFaa'>
  /* "libchemicalstring_2.pyx":62
 * 		dex1 = encoded[dex0:].find(')') + dex0
 * 		params_str = encoded[dex0:dex1].split(':')
 * 		params_val = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		for par in params_str[:-1]:
 * 			dex = targs.index(par)
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_params_val = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line63")'> 63: 		for par in params_str[:-1]:</pre>
<pre id='line63' class='code' style='background-color: #FFFF23'>
  /* "libchemicalstring_2.pyx":63
 * 		params_str = encoded[dex0:dex1].split(':')
 * 		params_val = []
 * 		for par in params_str[:-1]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			dex = targs.index(par)
 * 			params_val.append(cnts[dex])
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_params_str, 0, -1, NULL, NULL, &__pyx_k_slice_7, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_4 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_3 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = Py_TYPE(__pyx_t_4)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (!__pyx_t_5 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_5 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_1 = __pyx_t_5(__pyx_t_4);
      if (unlikely(!__pyx_t_1)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_par);
    __pyx_v_par = __pyx_t_1;
    __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":63
 * 		params_str = encoded[dex0:dex1].split(':')
 * 		params_val = []
 * 		for par in params_str[:-1]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			dex = targs.index(par)
 * 			params_val.append(cnts[dex])
 */
  __pyx_k_slice_7 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_slice_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_slice_7);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_k_slice_7);
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line64")'> 64: 			dex = targs.index(par)</pre>
<pre id='line64' class='code' style='background-color: #FFFF55'>
    /* "libchemicalstring_2.pyx":64
 * 		params_val = []
 * 		for par in params_str[:-1]:
 * 			dex = targs.index(par)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			params_val.append(cnts[dex])
 * 
 */
    __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_targs, __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_par);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_par);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_par);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex);
    __pyx_v_dex = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line65")'> 65: 			params_val.append(cnts[dex])</pre>
<pre id='line65' class='code' style='background-color: #FFFF73'>
    /* "libchemicalstring_2.pyx":65
 * 		for par in params_str[:-1]:
 * 			dex = targs.index(par)
 * 			params_val.append(cnts[dex])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		self.period = params_val[0]
 */
    __pyx_t_6 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_cnts, __pyx_v_dex);<span class='error_goto'> if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_params_val, __pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line66")'> 66: </pre>
<pre id='line66' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line67")'> 67: 		self.period = params_val[0]</pre>
<pre id='line67' class='code' style='background-color: #FFFF6e'>
  /* "libchemicalstring_2.pyx":67
 * 			params_val.append(cnts[dex])
 * 
 * 		self.period = params_val[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		self.phase = params_val[1]
 * 		self.pwm_time_up = params_val[2]
 */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(((PyObject *)__pyx_v_params_val), 0, sizeof(long), PyInt_FromLong, 1, 0, 1);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_8 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_self->period = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line68")'> 68: 		self.phase = params_val[1]</pre>
<pre id='line68' class='code' style='background-color: #FFFF6e'>
  /* "libchemicalstring_2.pyx":68
 * 
 * 		self.period = params_val[0]
 * 		self.phase = params_val[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		self.pwm_time_up = params_val[2]
 * 		self.domain = str(params_str[-1])
 */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(((PyObject *)__pyx_v_params_val), 1, sizeof(long), PyInt_FromLong, 1, 0, 1);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_8 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_self->phase = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line69")'> 69: 		self.pwm_time_up = params_val[2]</pre>
<pre id='line69' class='code' style='background-color: #FFFF6e'>
  /* "libchemicalstring_2.pyx":69
 * 		self.period = params_val[0]
 * 		self.phase = params_val[1]
 * 		self.pwm_time_up = params_val[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		self.domain = str(params_str[-1])
 * 
 */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(((PyObject *)__pyx_v_params_val), 2, sizeof(long), PyInt_FromLong, 1, 0, 1);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_8 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_self->pwm_time_up = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line70")'> 70: 		self.domain = str(params_str[-1])</pre>
<pre id='line70' class='code' style='background-color: #FFFF48'>
  /* "libchemicalstring_2.pyx":70
 * 		self.phase = params_val[1]
 * 		self.pwm_time_up = params_val[2]
 * 		self.domain = str(params_str[-1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		pwm_square = self.__call__
 */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_params_str, -1, sizeof(long), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_t_4))||((__pyx_t_4) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected str, got %.200s", Py_TYPE(__pyx_t_4)->tp_name), 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->domain);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->domain));
  __pyx_v_self->domain = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line71")'> 71: </pre>
<pre id='line71' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line72")'> 72: 		pwm_square = self.__call__</pre>
<pre id='line72' class='code' style='background-color: #FFFF43'>
  /* "libchemicalstring_2.pyx":72
 * 		self.domain = str(params_str[-1])
 * 
 * 		pwm_square = self.__call__             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#all calls will look the same
 */
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s____call__);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__pwm_square, __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.pwm_sq.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_encoded);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cnts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_targs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_params_str);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_params_val);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_par);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_6pwm_sq_3get_encoded(PyObject *__pyx_v_self, PyObject *__pyx_v_encoded); /*proto*/
static PyObject *__pyx_pw_14stringchemical_6pwm_sq_3get_encoded(PyObject *__pyx_v_self, PyObject *__pyx_v_encoded) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_encoded (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_6pwm_sq_2get_encoded(((struct __pyx_obj_14stringchemical_pwm_sq *)__pyx_v_self), ((PyObject *)__pyx_v_encoded));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line73")'> 73: </pre>
<pre id='line73' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line74")'> 74: 	#all calls will look the same</pre>
<pre id='line74' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line75")'> 75: 	def get_encoded(self, encoded):</pre>
<pre id='line75' class='code' style='background-color: #FFFFff'>
/* "libchemicalstring_2.pyx":75
 * 
 * 	#all calls will look the same
 * 	def get_encoded(self, encoded):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')
 * 		dex1 = encoded[dex0:].find(')') + dex0
 */

static PyObject *__pyx_pf_14stringchemical_6pwm_sq_2get_encoded(struct __pyx_obj_14stringchemical_pwm_sq *__pyx_v_self, PyObject *__pyx_v_encoded) {
  PyObject *__pyx_v_dex0 = NULL;
  PyObject *__pyx_v_dex1 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_encoded", 0);
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line76")'> 76: 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')</pre>
<pre id='line76' class='code' style='background-color: #FFFF3b'>
  /* "libchemicalstring_2.pyx":76
 * 	#all calls will look the same
 * 	def get_encoded(self, encoded):
 * 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		dex1 = encoded[dex0:].find(')') + dex0
 * 		return encoded.replace(encoded[dex0:dex1], self.domain)
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_encoded, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_kp_s_1));<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dex0 = __pyx_t_4;
  __pyx_t_4 = 0;

  /* "libchemicalstring_2.pyx":76
 * 	#all calls will look the same
 * 	def get_encoded(self, encoded):
 * 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		dex1 = encoded[dex0:].find(')') + dex0
 * 		return encoded.replace(encoded[dex0:dex1], self.domain)
 */
  __pyx_k_tuple_8 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_1));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_8);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_8));
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line77")'> 77: 		dex1 = encoded[dex0:].find(')') + dex0</pre>
<pre id='line77' class='code' style='background-color: #FFFF43'>
  /* "libchemicalstring_2.pyx":77
 * 	def get_encoded(self, encoded):
 * 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')
 * 		dex1 = encoded[dex0:].find(')') + dex0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return encoded.replace(encoded[dex0:dex1], self.domain)
 * 
 */
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_encoded, 0, 0, &__pyx_v_dex0, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_9), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_v_dex0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_dex1 = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":77
 * 	def get_encoded(self, encoded):
 * 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')
 * 		dex1 = encoded[dex0:].find(')') + dex0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return encoded.replace(encoded[dex0:dex1], self.domain)
 * 
 */
  __pyx_k_tuple_9 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_3));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_9);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_9));
</pre><pre class='line' style='background-color: #FFFF25' onclick='toggleDiv("line78")'> 78: 		return encoded.replace(encoded[dex0:dex1], self.domain)</pre>
<pre id='line78' class='code' style='background-color: #FFFF25'>
  /* "libchemicalstring_2.pyx":78
 * 		dex0 = encoded.find('pwm_square(') + len('pwm_square(')
 * 		dex1 = encoded[dex0:].find(')') + dex0
 * 		return encoded.replace(encoded[dex0:dex1], self.domain)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def __call__(self, t):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_encoded, __pyx_n_s__replace);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_encoded, 0, 0, &__pyx_v_dex0, &__pyx_v_dex1, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self->domain));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_self->domain));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self->domain));
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.pwm_sq.get_encoded", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_6pwm_sq_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_14stringchemical_6pwm_sq_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_t = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__t,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__t)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_t = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.pwm_sq.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_6pwm_sq_4__call__(((struct __pyx_obj_14stringchemical_pwm_sq *)__pyx_v_self), __pyx_v_t);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line79")'> 79: </pre>
<pre id='line79' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line80")'> 80: 	def __call__(self, t):</pre>
<pre id='line80' class='code' style='background-color: #FFFFff'>
/* "libchemicalstring_2.pyx":80
 * 		return encoded.replace(encoded[dex0:dex1], self.domain)
 * 
 * 	def __call__(self, t):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		t_w = (t + self.phase) % self.period
 * 		#print t, t_w, self.period, t_w/self.period, self.pwm_time_up, t_w/self.period > self.pwm_time_up
 */

static PyObject *__pyx_pf_14stringchemical_6pwm_sq_4__call__(struct __pyx_obj_14stringchemical_pwm_sq *__pyx_v_self, PyObject *__pyx_v_t) {
  PyObject *__pyx_v_t_w = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__", 0);
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line81")'> 81: 		t_w = (t + self.phase) % self.period</pre>
<pre id='line81' class='code' style='background-color: #FFFF4d'>
  /* "libchemicalstring_2.pyx":81
 * 
 * 	def __call__(self, t):
 * 		t_w = (t + self.phase) % self.period             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		#print t, t_w, self.period, t_w/self.period, self.pwm_time_up, t_w/self.period > self.pwm_time_up
 * 		if t_w/self.period > self.pwm_time_up: return 0.0
 */
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self->phase);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_t, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self->period);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_t_w = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line82")'> 82: 		#print t, t_w, self.period, t_w/self.period, self.pwm_time_up, t_w/self.period &gt; self.pwm_time_up</pre>
<pre id='line82' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line83")'> 83: 		if t_w/self.period &gt; self.pwm_time_up: return 0.0</pre>
<pre id='line83' class='code' style='background-color: #FFFF38'>
  /* "libchemicalstring_2.pyx":83
 * 		t_w = (t + self.phase) % self.period
 * 		#print t, t_w, self.period, t_w/self.period, self.pwm_time_up, t_w/self.period > self.pwm_time_up
 * 		if t_w/self.period > self.pwm_time_up: return 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return 1.0
 * 
 */
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self->period);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_v_t_w, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self->pwm_time_up);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_3, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_4) {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFF16' onclick='toggleDiv("line84")'> 84: 		return 1.0</pre>
<pre id='line84' class='code' style='background-color: #FFFF16'>
  /* "libchemicalstring_2.pyx":84
 * 		#print t, t_w, self.period, t_w/self.period, self.pwm_time_up, t_w/self.period > self.pwm_time_up
 * 		if t_w/self.period > self.pwm_time_up: return 0.0
 * 		return 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.pwm_sq.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_w);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_1generate_reaction(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_1generate_reaction = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("generate_reaction"), (PyCFunction)__pyx_pw_14stringchemical_1generate_reaction, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_1generate_reaction(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_count_targets = 0;
  PyObject *__pyx_v_counts = 0;
  PyObject *__pyx_v_functions = 0;
  PyObject *__pyx_v_func_names = 0;
  PyObject *__pyx_v_var_vals = 0;
  PyObject *__pyx_v_variables = 0;
  PyObject *__pyx_v_rxn_string = 0;
  PyObject *__pyx_v_rate_call_group = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_reaction (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__count_targets,&__pyx_n_s__counts,&__pyx_n_s__functions,&__pyx_n_s__func_names,&__pyx_n_s__var_vals,&__pyx_n_s__variables,&__pyx_n_s__rxn_string,&__pyx_n_s__rate_call_group,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__count_targets)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__counts)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_reaction", 1, 8, 8, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__functions)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_reaction", 1, 8, 8, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__func_names)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_reaction", 1, 8, 8, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__var_vals)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_reaction", 1, 8, 8, 4);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__variables)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_reaction", 1, 8, 8, 5);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__rxn_string)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_reaction", 1, 8, 8, 6);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  7:
        if (likely((values[7] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__rate_call_group)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_reaction", 1, 8, 8, 7);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "generate_reaction") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 8) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
    }
    __pyx_v_count_targets = values[0];
    __pyx_v_counts = values[1];
    __pyx_v_functions = values[2];
    __pyx_v_func_names = values[3];
    __pyx_v_var_vals = values[4];
    __pyx_v_variables = values[5];
    __pyx_v_rxn_string = values[6];
    __pyx_v_rate_call_group = values[7];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_reaction", 1, 8, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_generate_reaction(__pyx_self, __pyx_v_count_targets, __pyx_v_counts, __pyx_v_functions, __pyx_v_func_names, __pyx_v_var_vals, __pyx_v_variables, __pyx_v_rxn_string, __pyx_v_rate_call_group);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_1propensity_with_rate_call(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17generate_reaction_1propensity_with_rate_call = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("propensity_with_rate_call"), (PyCFunction)__pyx_pw_14stringchemical_17generate_reaction_1propensity_with_rate_call, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_1propensity_with_rate_call(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_with_rate_call (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_17generate_reaction_propensity_with_rate_call(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line85")'> 85: </pre>
<pre id='line85' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line86")'> 86: </pre>
<pre id='line86' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line87")'> 87: #bulk of preprocessing is here</pre>
<pre id='line87' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line88")'> 88: #propensities which depend on a function should appear on</pre>
<pre id='line88' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line89")'> 89: # every reactions' affected list?</pre>
<pre id='line89' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line90")'> 90: @cython.boundscheck(False) # turn of bounds-checking for entire function</pre>
<pre id='line90' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line91")'> 91: @cython.cdivision(False)</pre>
<pre id='line91' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line92")'> 92: def generate_reaction(count_targets, counts, functions, func_names,</pre>
<pre id='line92' class='code' style='background-color: #FFFF57'>
/* "libchemicalstring_2.pyx":92
 * @cython.boundscheck(False) # turn of bounds-checking for entire function
 * @cython.cdivision(False)
 * def generate_reaction(count_targets, counts, functions, func_names,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				var_vals, variables, rxn_string, rate_call_group):
 * 
 */

static PyObject *__pyx_pf_14stringchemical_generate_reaction(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_count_targets, PyObject *__pyx_v_counts, PyObject *__pyx_v_functions, PyObject *__pyx_v_func_names, PyObject *__pyx_v_var_vals, PyObject *__pyx_v_variables, PyObject *__pyx_v_rxn_string, PyObject *__pyx_v_rate_call_group) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_cur_scope;
  PyObject *__pyx_v_propensity_with_rate_call = 0;
  PyObject *__pyx_v_propensity_simple_with_rate_call = 0;
  PyObject *__pyx_v_propensity_very_simple_with_rate_call = 0;
  PyObject *__pyx_v_propensity_simplest_with_rate_call = 0;
  PyObject *__pyx_v_propensity = 0;
  PyObject *__pyx_v_propensity_simple = 0;
  PyObject *__pyx_v_propensity_very_simple = 0;
  PyObject *__pyx_v_validator_constant = 0;
  PyObject *__pyx_v_validator = 0;
  PyObject *__pyx_v_reaction = 0;
  PyObject *__pyx_v_measure_agent = 0;
  PyObject *__pyx_v_split = NULL;
  int __pyx_v_rate_flag;
  PyObject *__pyx_v_func_dex = NULL;
  PyObject *__pyx_v_var_dex = NULL;
  double __pyx_v_propensity_minimum;
  int __pyx_v_has_reagents;
  int __pyx_v_only_one_reagent;
  int __pyx_v_single_stochios;
  PyObject *__pyx_v_valid = NULL;
  PyObject *__pyx_v_correct_propensity = NULL;
  PyObject *__pyx_v_agent = NULL;
  PyObject *__pyx_v_cnt = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_reaction", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *)__pyx_tp_new_14stringchemical___pyx_scope_struct__generate_reaction(__pyx_ptype_14stringchemical___pyx_scope_struct__generate_reaction, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_count_targets = __pyx_v_count_targets;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_count_targets);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_count_targets);
  __pyx_cur_scope->__pyx_v_counts = __pyx_v_counts;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);

  /* "libchemicalstring_2.pyx":92
 * @cython.boundscheck(False) # turn of bounds-checking for entire function
 * @cython.cdivision(False)
 * def generate_reaction(count_targets, counts, functions, func_names,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				var_vals, variables, rxn_string, rate_call_group):
 * 
 */
  __pyx_k_tuple_189 = <span class='py_c_api'>PyTuple_Pack</span>(47, ((PyObject *)__pyx_n_s__count_targets), ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_n_s__functions), ((PyObject *)__pyx_n_s__func_names), ((PyObject *)__pyx_n_s__var_vals), ((PyObject *)__pyx_n_s__variables), ((PyObject *)__pyx_n_s__rxn_string), ((PyObject *)__pyx_n_s__rate_call_group), ((PyObject *)__pyx_n_s_17), ((PyObject *)__pyx_n_s_17), ((PyObject *)__pyx_n_s_22), ((PyObject *)__pyx_n_s_22), ((PyObject *)__pyx_n_s_26), ((PyObject *)__pyx_n_s_26), ((PyObject *)__pyx_n_s_30), ((PyObject *)__pyx_n_s_30), ((PyObject *)__pyx_n_s__propensity), ((PyObject *)__pyx_n_s__propensity), ((PyObject *)__pyx_n_s__propensity_simple), ((PyObject *)__pyx_n_s__propensity_simple), ((PyObject *)__pyx_n_s_40), ((PyObject *)__pyx_n_s_40), ((PyObject *)__pyx_n_s__validator_constant), ((PyObject *)__pyx_n_s__validator_constant), ((PyObject *)__pyx_n_s__validator), ((PyObject *)__pyx_n_s__validator), ((PyObject *)__pyx_n_s__reaction), ((PyObject *)__pyx_n_s__reaction), ((PyObject *)__pyx_n_s__measure_agent), ((PyObject *)__pyx_n_s__measure_agent), ((PyObject *)__pyx_n_s__split), ((PyObject *)__pyx_n_s__rate), ((PyObject *)__pyx_n_s__rate_flag), ((PyObject *)__pyx_n_s__func_dex), ((PyObject *)__pyx_n_s__var_dex), ((PyObject *)__pyx_n_s__propensity_minimum), ((PyObject *)__pyx_n_s__reagents), ((PyObject *)__pyx_n_s__products), ((PyObject *)__pyx_n_s__cnt_dexes), ((PyObject *)__pyx_n_s__stochios), ((PyObject *)__pyx_n_s__has_reagents), ((PyObject *)__pyx_n_s__only_one_reagent), ((PyObject *)__pyx_n_s__single_stochios), ((PyObject *)__pyx_n_s__valid), ((PyObject *)__pyx_n_s__correct_propensity), ((PyObject *)__pyx_n_s__agent), ((PyObject *)__pyx_n_s__cnt));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_189)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_189);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_189));

  /* "libchemicalstring_2.pyx":92
 * @cython.boundscheck(False) # turn of bounds-checking for entire function
 * @cython.cdivision(False)
 * def generate_reaction(count_targets, counts, functions, func_names,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				var_vals, variables, rxn_string, rate_call_group):
 * 
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_1generate_reaction, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__generate_reaction, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_190 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(8, 0, 47, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_189, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__generate_reaction, 92, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_190)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":92
 * @cython.boundscheck(False) # turn of bounds-checking for entire function
 * @cython.cdivision(False)
 * def generate_reaction(count_targets, counts, functions, func_names,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				var_vals, variables, rxn_string, rate_call_group):
 * 
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction {
  PyObject_HEAD
  PyObject *__pyx_v_cnt_dexes;
  PyObject *__pyx_v_count_targets;
  PyObject *__pyx_v_counts;
  PyObject *__pyx_v_products;
  PyObject *__pyx_v_rate;
  PyObject *__pyx_v_reagents;
  PyObject *__pyx_v_stochios;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line93")'> 93: 				var_vals, variables, rxn_string, rate_call_group):</pre>
<pre id='line93' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line94")'> 94: </pre>
<pre id='line94' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line95")'> 95: 	#rate was not a float and some stochiometric coefficient &gt; 1; slowest</pre>
<pre id='line95' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line96")'> 96: 	def propensity_with_rate_call():</pre>
<pre id='line96' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":96
 * 
 * 	#rate was not a float and some stochiometric coefficient > 1; slowest
 * 	def propensity_with_rate_call():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */

static PyObject *__pyx_pf_14stringchemical_17generate_reaction_propensity_with_rate_call(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_outer_scope;
  double __pyx_v_population;
  double __pyx_v_propensity;
  double __pyx_v_propensity_minimum;
  int __pyx_v_cnt_dex;
  int __pyx_v_act_dex;
  int __pyx_v_cnt;
  int __pyx_v_k;
  PyObject *__pyx_v_agent = NULL;
  PyObject *__pyx_v_act = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_with_rate_call", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":96
 * 
 * 	#rate was not a float and some stochiometric coefficient > 1; slowest
 * 	def propensity_with_rate_call():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */
  __pyx_k_tuple_15 = <span class='py_c_api'>PyTuple_Pack</span>(9, ((PyObject *)__pyx_n_s__population), ((PyObject *)__pyx_n_s__propensity), ((PyObject *)__pyx_n_s__propensity_minimum), ((PyObject *)__pyx_n_s__cnt_dex), ((PyObject *)__pyx_n_s__act_dex), ((PyObject *)__pyx_n_s__cnt), ((PyObject *)__pyx_n_s__k), ((PyObject *)__pyx_n_s__agent), ((PyObject *)__pyx_n_s__act));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_15);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_15));

  /* "libchemicalstring_2.pyx":96
 * 
 * 	#rate was not a float and some stochiometric coefficient > 1; slowest
 * 	def propensity_with_rate_call():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17generate_reaction_1propensity_with_rate_call, 0, __pyx_n_s_19, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_16));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_propensity_with_rate_call = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_16 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_15, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s_17, 96, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line97")'> 97: 		cdef double population = 1.0</pre>
<pre id='line97' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":97
 * 	#rate was not a float and some stochiometric coefficient > 1; slowest
 * 	def propensity_with_rate_call():
 * 		cdef double population = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 */
  __pyx_v_population = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line98")'> 98: 		cdef double propensity = 1.0</pre>
<pre id='line98' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":98
 * 	def propensity_with_rate_call():
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity_minimum = 1e-30
 * 		cdef int cnt_dex = 1
 */
  __pyx_v_propensity = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line99")'> 99: 		cdef double propensity_minimum = 1e-30</pre>
<pre id='line99' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":99
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef int cnt_dex = 1
 * 		cdef int act_dex = 0
 */
  __pyx_v_propensity_minimum = 1e-30;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line100")'> 100: 		cdef int cnt_dex = 1</pre>
<pre id='line100' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":100
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 * 		cdef int cnt_dex = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef int act_dex = 0
 * 		cdef int cnt
 */
  __pyx_v_cnt_dex = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line101")'> 101: 		cdef int act_dex = 0</pre>
<pre id='line101' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":101
 * 		cdef double propensity_minimum = 1e-30
 * 		cdef int cnt_dex = 1
 * 		cdef int act_dex = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef int cnt
 * 		cdef int k
 */
  __pyx_v_act_dex = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line102")'> 102: 		cdef int cnt</pre>
<pre id='line102' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line103")'> 103: 		cdef int k</pre>
<pre id='line103' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line104")'> 104: 		for agent in reagents:</pre>
<pre id='line104' class='code' style='background-color: #FFFF6e'>
  /* "libchemicalstring_2.pyx":104
 * 		cdef int cnt
 * 		cdef int k
 * 		for agent in reagents:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			cnt = counts[agent[cnt_dex]]
 * 			act = agent[act_dex]
 */
  if (unlikely(!__pyx_cur_scope->__pyx_v_reagents)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("reagents");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (unlikely(((PyObject *)__pyx_cur_scope->__pyx_v_reagents) == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = ((PyObject *)__pyx_cur_scope->__pyx_v_reagents); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
    __pyx_v_agent = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line105")'> 105: 			cnt = counts[agent[cnt_dex]]</pre>
<pre id='line105' class='code' style='background-color: #FFFF52'>
    /* "libchemicalstring_2.pyx":105
 * 		cdef int k
 * 		for agent in reagents:
 * 			cnt = counts[agent[cnt_dex]]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			act = agent[act_dex]
 * 			for k in range(act): population *= cnt - k
 */
    if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_agent, __pyx_v_cnt_dex, sizeof(int), PyInt_FromLong, 0, 1, 0);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_t_3);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_cnt = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line106")'> 106: 			act = agent[act_dex]</pre>
<pre id='line106' class='code' style='background-color: #FFFFc4'>
    /* "libchemicalstring_2.pyx":106
 * 		for agent in reagents:
 * 			cnt = counts[agent[cnt_dex]]
 * 			act = agent[act_dex]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			for k in range(act): population *= cnt - k
 * 			population /= act
 */
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_agent, __pyx_v_act_dex, sizeof(int), PyInt_FromLong, 0, 1, 0);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_act);
    __pyx_v_act = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line107")'> 107: 			for k in range(act): population *= cnt - k</pre>
<pre id='line107' class='code' style='background-color: #FFFF7f'>
    /* "libchemicalstring_2.pyx":107
 * 			cnt = counts[agent[cnt_dex]]
 * 			act = agent[act_dex]
 * 			for k in range(act): population *= cnt - k             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			population /= act
 * 
 */
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_v_act);<span class='error_goto'> if (unlikely((__pyx_t_6 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_6; __pyx_t_5+=1) {
      __pyx_v_k = __pyx_t_5;
      __pyx_v_population = (__pyx_v_population * (__pyx_v_cnt - __pyx_v_k));
    }
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line108")'> 108: 			population /= act</pre>
<pre id='line108' class='code' style='background-color: #FFFF4d'>
    /* "libchemicalstring_2.pyx":108
 * 			act = agent[act_dex]
 * 			for k in range(act): population *= cnt - k
 * 			population /= act             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		propensity = population * rate(counts)
 */
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_population);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyNumber_InPlaceDivide</span>(__pyx_t_4, __pyx_v_act);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_7 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_7 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_population = __pyx_t_7;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line109")'> 109: </pre>
<pre id='line109' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line110")'> 110: 		propensity = population * rate(counts)</pre>
<pre id='line110' class='code' style='background-color: #FFFF33'>
  /* "libchemicalstring_2.pyx":110
 * 			population /= act
 * 
 * 		propensity = population * rate(counts)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return 0.0
 */
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_population);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (unlikely(!__pyx_cur_scope->__pyx_v_rate)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("rate");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_cur_scope->__pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_cur_scope->__pyx_v_rate, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_7 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_propensity = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line111")'> 111: 		if propensity &gt; propensity_minimum: return propensity</pre>
<pre id='line111' class='code' style='background-color: #FFFF9f'>
  /* "libchemicalstring_2.pyx":111
 * 
 * 		propensity = population * rate(counts)
 * 		if propensity > propensity_minimum: return propensity             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		else: return 0.0
 * 
 */
  __pyx_t_8 = ((__pyx_v_propensity > __pyx_v_propensity_minimum) != 0);
  if (__pyx_t_8) {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_propensity);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
    goto __pyx_L7;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line112")'> 112: 		else: return 0.0</pre>
<pre id='line112' class='code' style='background-color: #FFFF5b'>
    /* "libchemicalstring_2.pyx":112
 * 		propensity = population * rate(counts)
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#rate was not a float and all stochiometric coefficients = 1
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
  __pyx_L7:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction.propensity_with_rate_call", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_act);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_3propensity_simple_with_rate_call(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17generate_reaction_3propensity_simple_with_rate_call = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("propensity_simple_with_rate_call"), (PyCFunction)__pyx_pw_14stringchemical_17generate_reaction_3propensity_simple_with_rate_call, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_3propensity_simple_with_rate_call(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_simple_with_rate_call (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_17generate_reaction_2propensity_simple_with_rate_call(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line113")'> 113: </pre>
<pre id='line113' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line114")'> 114: 	#rate was not a float and all stochiometric coefficients = 1</pre>
<pre id='line114' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line115")'> 115: 	def propensity_simple_with_rate_call():</pre>
<pre id='line115' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":115
 * 
 * 	#rate was not a float and all stochiometric coefficients = 1
 * 	def propensity_simple_with_rate_call():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */

static PyObject *__pyx_pf_14stringchemical_17generate_reaction_2propensity_simple_with_rate_call(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_outer_scope;
  double __pyx_v_population;
  double __pyx_v_propensity;
  double __pyx_v_propensity_minimum;
  int __pyx_v_cnt_dex;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_simple_with_rate_call", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":115
 * 
 * 	#rate was not a float and all stochiometric coefficients = 1
 * 	def propensity_simple_with_rate_call():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */
  __pyx_k_tuple_20 = <span class='py_c_api'>PyTuple_Pack</span>(5, ((PyObject *)__pyx_n_s__population), ((PyObject *)__pyx_n_s__propensity), ((PyObject *)__pyx_n_s__propensity_minimum), ((PyObject *)__pyx_n_s__cnt_dex), ((PyObject *)__pyx_n_s__cnt));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_20);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_20));

  /* "libchemicalstring_2.pyx":115
 * 
 * 	#rate was not a float and all stochiometric coefficients = 1
 * 	def propensity_simple_with_rate_call():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17generate_reaction_3propensity_simple_with_rate_call, 0, __pyx_n_s_23, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_21));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_propensity_simple_with_rate_call = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_21 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_20, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s_22, 115, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line116")'> 116: 		cdef double population = 1.0</pre>
<pre id='line116' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":116
 * 	#rate was not a float and all stochiometric coefficients = 1
 * 	def propensity_simple_with_rate_call():
 * 		cdef double population = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 */
  __pyx_v_population = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line117")'> 117: 		cdef double propensity = 1.0</pre>
<pre id='line117' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":117
 * 	def propensity_simple_with_rate_call():
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity_minimum = 1e-30
 * 		propensity_minimum = 1e-30
 */
  __pyx_v_propensity = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line118")'> 118: 		cdef double propensity_minimum = 1e-30</pre>
<pre id='line118' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":118
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		propensity_minimum = 1e-30
 * 		cdef int cnt_dex
 */
  __pyx_v_propensity_minimum = 1e-30;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line119")'> 119: 		propensity_minimum = 1e-30</pre>
<pre id='line119' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":119
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 * 		propensity_minimum = 1e-30             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef int cnt_dex
 * 		cdef int cnt
 */
  __pyx_v_propensity_minimum = 1e-30;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line120")'> 120: 		cdef int cnt_dex</pre>
<pre id='line120' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line121")'> 121: 		cdef int cnt</pre>
<pre id='line121' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line122")'> 122: 		for cnt_dex in cnt_dexes: population *= counts[cnt_dex]</pre>
<pre id='line122' class='code' style='background-color: #FFFF19'>
  /* "libchemicalstring_2.pyx":122
 * 		cdef int cnt_dex
 * 		cdef int cnt
 * 		for cnt_dex in cnt_dexes: population *= counts[cnt_dex]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		propensity = population * rate(counts)
 * 		if propensity > propensity_minimum: return propensity
 */
  if (unlikely(!__pyx_cur_scope->__pyx_v_cnt_dexes)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cnt_dexes");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_cur_scope->__pyx_v_cnt_dexes) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_cur_scope->__pyx_v_cnt_dexes)) {
    __pyx_t_1 = __pyx_cur_scope->__pyx_v_cnt_dexes; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_cur_scope->__pyx_v_cnt_dexes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_3 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_3 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    }
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_cnt_dex = __pyx_t_5;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_population);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_v_cnt_dex, sizeof(int), PyInt_FromLong, 0, 1, 0);<span class='error_goto'> if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_7 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7);<span class='error_goto'> if (unlikely((__pyx_t_8 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_population = __pyx_t_8;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line123")'> 123: 		propensity = population * rate(counts)</pre>
<pre id='line123' class='code' style='background-color: #FFFF33'>
  /* "libchemicalstring_2.pyx":123
 * 		cdef int cnt
 * 		for cnt_dex in cnt_dexes: population *= counts[cnt_dex]
 * 		propensity = population * rate(counts)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return 0.0
 */
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_population);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (unlikely(!__pyx_cur_scope->__pyx_v_rate)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("rate");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_cur_scope->__pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);
  __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_cur_scope->__pyx_v_rate, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7);<span class='error_goto'> if (unlikely((__pyx_t_8 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_propensity = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line124")'> 124: 		if propensity &gt; propensity_minimum: return propensity</pre>
<pre id='line124' class='code' style='background-color: #FFFF9f'>
  /* "libchemicalstring_2.pyx":124
 * 		for cnt_dex in cnt_dexes: population *= counts[cnt_dex]
 * 		propensity = population * rate(counts)
 * 		if propensity > propensity_minimum: return propensity             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		else: return 0.0
 * 
 */
  __pyx_t_9 = ((__pyx_v_propensity > __pyx_v_propensity_minimum) != 0);
  if (__pyx_t_9) {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_propensity);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
    goto __pyx_L5;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line125")'> 125: 		else: return 0.0</pre>
<pre id='line125' class='code' style='background-color: #FFFF5e'>
    /* "libchemicalstring_2.pyx":125
 * 		propensity = population * rate(counts)
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#rate was not a float, there is but one stochiometric
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
  }
  __pyx_L5:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction.propensity_simple_with_rate_call", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_5propensity_very_simple_with_rate_call(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17generate_reaction_5propensity_very_simple_with_rate_call = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("propensity_very_simple_with_rate_call"), (PyCFunction)__pyx_pw_14stringchemical_17generate_reaction_5propensity_very_simple_with_rate_call, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_5propensity_very_simple_with_rate_call(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_very_simple_with_rate_call (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_17generate_reaction_4propensity_very_simple_with_rate_call(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line126")'> 126: </pre>
<pre id='line126' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line127")'> 127: 	#rate was not a float, there is but one stochiometric</pre>
<pre id='line127' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line128")'> 128: 	# coefficient and it is equal to 1</pre>
<pre id='line128' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line129")'> 129: 	def propensity_very_simple_with_rate_call():</pre>
<pre id='line129' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":129
 * 	#rate was not a float, there is but one stochiometric
 * 	# coefficient and it is equal to 1
 * 	def propensity_very_simple_with_rate_call():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */

static PyObject *__pyx_pf_14stringchemical_17generate_reaction_4propensity_very_simple_with_rate_call(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_outer_scope;
  CYTHON_UNUSED double __pyx_v_population;
  double __pyx_v_propensity;
  double __pyx_v_propensity_minimum;
  double __pyx_v_zero;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_very_simple_with_rate_call", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":129
 * 	#rate was not a float, there is but one stochiometric
 * 	# coefficient and it is equal to 1
 * 	def propensity_very_simple_with_rate_call():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */
  __pyx_k_tuple_24 = <span class='py_c_api'>PyTuple_Pack</span>(4, ((PyObject *)__pyx_n_s__population), ((PyObject *)__pyx_n_s__propensity), ((PyObject *)__pyx_n_s__propensity_minimum), ((PyObject *)__pyx_n_s__zero));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_24);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_24));

  /* "libchemicalstring_2.pyx":129
 * 	#rate was not a float, there is but one stochiometric
 * 	# coefficient and it is equal to 1
 * 	def propensity_very_simple_with_rate_call():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17generate_reaction_5propensity_very_simple_with_rate_call, 0, __pyx_n_s_27, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_25));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_propensity_very_simple_with_rate_call = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_25 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s_26, 129, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line130")'> 130: 		cdef double population = 1.0</pre>
<pre id='line130' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":130
 * 	# coefficient and it is equal to 1
 * 	def propensity_very_simple_with_rate_call():
 * 		cdef double population = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 */
  __pyx_v_population = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line131")'> 131: 		cdef double propensity = 1.0</pre>
<pre id='line131' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":131
 * 	def propensity_very_simple_with_rate_call():
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity_minimum = 1e-30
 * 		cdef double zero = 0.0
 */
  __pyx_v_propensity = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line132")'> 132: 		cdef double propensity_minimum = 1e-30</pre>
<pre id='line132' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":132
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double zero = 0.0
 * 		propensity = counts[cnt_dexes[0]] * rate(counts)
 */
  __pyx_v_propensity_minimum = 1e-30;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line133")'> 133: 		cdef double zero = 0.0</pre>
<pre id='line133' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":133
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 * 		cdef double zero = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		propensity = counts[cnt_dexes[0]] * rate(counts)
 * 		if propensity > propensity_minimum: return propensity
 */
  __pyx_v_zero = 0.0;
</pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line134")'> 134: 		propensity = counts[cnt_dexes[0]] * rate(counts)</pre>
<pre id='line134' class='code' style='background-color: #FFFF2e'>
  /* "libchemicalstring_2.pyx":134
 * 		cdef double propensity_minimum = 1e-30
 * 		cdef double zero = 0.0
 * 		propensity = counts[cnt_dexes[0]] * rate(counts)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return zero	#is this faster?
 */
  if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (unlikely(!__pyx_cur_scope->__pyx_v_cnt_dexes)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cnt_dexes");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_cnt_dexes, 0, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_t_1);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_cur_scope->__pyx_v_rate)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("rate");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_cur_scope->__pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_cur_scope->__pyx_v_rate, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_4 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_propensity = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line135")'> 135: 		if propensity &gt; propensity_minimum: return propensity</pre>
<pre id='line135' class='code' style='background-color: #FFFF9f'>
  /* "libchemicalstring_2.pyx":135
 * 		cdef double zero = 0.0
 * 		propensity = counts[cnt_dexes[0]] * rate(counts)
 * 		if propensity > propensity_minimum: return propensity             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		else: return zero	#is this faster?
 * 
 */
  __pyx_t_5 = ((__pyx_v_propensity > __pyx_v_propensity_minimum) != 0);
  if (__pyx_t_5) {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_propensity);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line136")'> 136: 		else: return zero	#is this faster?</pre>
<pre id='line136' class='code' style='background-color: #FFFF62'>
    /* "libchemicalstring_2.pyx":136
 * 		propensity = counts[cnt_dexes[0]] * rate(counts)
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return zero	#is this faster?             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#rate was not a float and there are no reagents
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_zero);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }
  __pyx_L3:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction.propensity_very_simple_with_rate_call", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_7propensity_simplest_with_rate_call(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17generate_reaction_7propensity_simplest_with_rate_call = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("propensity_simplest_with_rate_call"), (PyCFunction)__pyx_pw_14stringchemical_17generate_reaction_7propensity_simplest_with_rate_call, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_7propensity_simplest_with_rate_call(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_simplest_with_rate_call (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_17generate_reaction_6propensity_simplest_with_rate_call(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line137")'> 137: </pre>
<pre id='line137' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line138")'> 138: 	#rate was not a float and there are no reagents</pre>
<pre id='line138' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line139")'> 139: 	def propensity_simplest_with_rate_call():</pre>
<pre id='line139' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":139
 * 
 * 	#rate was not a float and there are no reagents
 * 	def propensity_simplest_with_rate_call():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 */

static PyObject *__pyx_pf_14stringchemical_17generate_reaction_6propensity_simplest_with_rate_call(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_outer_scope;
  double __pyx_v_propensity;
  double __pyx_v_propensity_minimum;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_simplest_with_rate_call", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":139
 * 
 * 	#rate was not a float and there are no reagents
 * 	def propensity_simplest_with_rate_call():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 */
  __pyx_k_tuple_28 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject *)__pyx_n_s__propensity), ((PyObject *)__pyx_n_s__propensity_minimum));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_28);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_28));

  /* "libchemicalstring_2.pyx":139
 * 
 * 	#rate was not a float and there are no reagents
 * 	def propensity_simplest_with_rate_call():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17generate_reaction_7propensity_simplest_with_rate_call, 0, __pyx_n_s_31, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_29));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_propensity_simplest_with_rate_call = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_29 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_28, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s_30, 139, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line140")'> 140: 		cdef double propensity = 1.0</pre>
<pre id='line140' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":140
 * 	#rate was not a float and there are no reagents
 * 	def propensity_simplest_with_rate_call():
 * 		cdef double propensity = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity_minimum = 1e-30
 * 		propensity_minimum = 1e-30
 */
  __pyx_v_propensity = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line141")'> 141: 		cdef double propensity_minimum = 1e-30</pre>
<pre id='line141' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":141
 * 	def propensity_simplest_with_rate_call():
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		propensity_minimum = 1e-30
 * 		propensity = rate(counts)
 */
  __pyx_v_propensity_minimum = 1e-30;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line142")'> 142: 		propensity_minimum = 1e-30</pre>
<pre id='line142' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":142
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 * 		propensity_minimum = 1e-30             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		propensity = rate(counts)
 * 		if propensity > propensity_minimum: return propensity
 */
  __pyx_v_propensity_minimum = 1e-30;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line143")'> 143: 		propensity = rate(counts)</pre>
<pre id='line143' class='code' style='background-color: #FFFF43'>
  /* "libchemicalstring_2.pyx":143
 * 		cdef double propensity_minimum = 1e-30
 * 		propensity_minimum = 1e-30
 * 		propensity = rate(counts)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return 0.0
 */
  if (unlikely(!__pyx_cur_scope->__pyx_v_rate)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("rate");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_cur_scope->__pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_cur_scope->__pyx_v_rate, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_propensity = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line144")'> 144: 		if propensity &gt; propensity_minimum: return propensity</pre>
<pre id='line144' class='code' style='background-color: #FFFF9f'>
  /* "libchemicalstring_2.pyx":144
 * 		propensity_minimum = 1e-30
 * 		propensity = rate(counts)
 * 		if propensity > propensity_minimum: return propensity             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		else: return 0.0
 * 
 */
  __pyx_t_4 = ((__pyx_v_propensity > __pyx_v_propensity_minimum) != 0);
  if (__pyx_t_4) {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_propensity);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line145")'> 145: 		else: return 0.0</pre>
<pre id='line145' class='code' style='background-color: #FFFF66'>
    /* "libchemicalstring_2.pyx":145
 * 		propensity = rate(counts)
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#rate was a float and some stochiometric coefficient > 1
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }
  __pyx_L3:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction.propensity_simplest_with_rate_call", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_9propensity(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17generate_reaction_9propensity = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("propensity"), (PyCFunction)__pyx_pw_14stringchemical_17generate_reaction_9propensity, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_9propensity(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_17generate_reaction_8propensity(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line146")'> 146: </pre>
<pre id='line146' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line147")'> 147: 	#rate was a float and some stochiometric coefficient &gt; 1</pre>
<pre id='line147' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line148")'> 148: 	def propensity():</pre>
<pre id='line148' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":148
 * 
 * 	#rate was a float and some stochiometric coefficient > 1
 * 	def propensity():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */

static PyObject *__pyx_pf_14stringchemical_17generate_reaction_8propensity(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_outer_scope;
  double __pyx_v_population;
  double __pyx_v_propensity;
  double __pyx_v_propensity_minimum;
  int __pyx_v_cnt_dex;
  int __pyx_v_act_dex;
  int __pyx_v_cnt;
  int __pyx_v_act;
  int __pyx_v_k;
  PyObject *__pyx_v_agent = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":148
 * 
 * 	#rate was a float and some stochiometric coefficient > 1
 * 	def propensity():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */
  __pyx_k_tuple_32 = <span class='py_c_api'>PyTuple_Pack</span>(9, ((PyObject *)__pyx_n_s__population), ((PyObject *)__pyx_n_s__propensity), ((PyObject *)__pyx_n_s__propensity_minimum), ((PyObject *)__pyx_n_s__cnt_dex), ((PyObject *)__pyx_n_s__act_dex), ((PyObject *)__pyx_n_s__cnt), ((PyObject *)__pyx_n_s__act), ((PyObject *)__pyx_n_s__k), ((PyObject *)__pyx_n_s__agent));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_32)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_32);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_32));

  /* "libchemicalstring_2.pyx":148
 * 
 * 	#rate was a float and some stochiometric coefficient > 1
 * 	def propensity():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17generate_reaction_9propensity, 0, __pyx_n_s_34, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_33));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_propensity = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_33 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_32, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__propensity, 148, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line149")'> 149: 		cdef double population = 1.0</pre>
<pre id='line149' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":149
 * 	#rate was a float and some stochiometric coefficient > 1
 * 	def propensity():
 * 		cdef double population = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 */
  __pyx_v_population = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line150")'> 150: 		cdef double propensity = 1.0</pre>
<pre id='line150' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":150
 * 	def propensity():
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity_minimum = 1e-30
 * 		cdef int cnt_dex = 1
 */
  __pyx_v_propensity = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line151")'> 151: 		cdef double propensity_minimum = 1e-30</pre>
<pre id='line151' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":151
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef int cnt_dex = 1
 * 		cdef int act_dex = 0
 */
  __pyx_v_propensity_minimum = 1e-30;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line152")'> 152: 		cdef int cnt_dex = 1</pre>
<pre id='line152' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":152
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 * 		cdef int cnt_dex = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef int act_dex = 0
 * 		cdef int cnt
 */
  __pyx_v_cnt_dex = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line153")'> 153: 		cdef int act_dex = 0</pre>
<pre id='line153' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":153
 * 		cdef double propensity_minimum = 1e-30
 * 		cdef int cnt_dex = 1
 * 		cdef int act_dex = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef int cnt
 * 		cdef int act
 */
  __pyx_v_act_dex = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line154")'> 154: 		cdef int cnt</pre>
<pre id='line154' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line155")'> 155: 		cdef int act</pre>
<pre id='line155' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line156")'> 156: 		cdef int k</pre>
<pre id='line156' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line157")'> 157: 		for agent in reagents:</pre>
<pre id='line157' class='code' style='background-color: #FFFF6e'>
  /* "libchemicalstring_2.pyx":157
 * 		cdef int act
 * 		cdef int k
 * 		for agent in reagents:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			cnt = counts[agent[cnt_dex]]
 * 			act = agent[act_dex]
 */
  if (unlikely(!__pyx_cur_scope->__pyx_v_reagents)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("reagents");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (unlikely(((PyObject *)__pyx_cur_scope->__pyx_v_reagents) == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = ((PyObject *)__pyx_cur_scope->__pyx_v_reagents); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
    __pyx_v_agent = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line158")'> 158: 			cnt = counts[agent[cnt_dex]]</pre>
<pre id='line158' class='code' style='background-color: #FFFF52'>
    /* "libchemicalstring_2.pyx":158
 * 		cdef int k
 * 		for agent in reagents:
 * 			cnt = counts[agent[cnt_dex]]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			act = agent[act_dex]
 * 			for k in range(act): population *= cnt - k
 */
    if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_agent, __pyx_v_cnt_dex, sizeof(int), PyInt_FromLong, 0, 1, 0);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_t_3);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_cnt = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line159")'> 159: 			act = agent[act_dex]</pre>
<pre id='line159' class='code' style='background-color: #FFFF6e'>
    /* "libchemicalstring_2.pyx":159
 * 		for agent in reagents:
 * 			cnt = counts[agent[cnt_dex]]
 * 			act = agent[act_dex]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			for k in range(act): population *= cnt - k
 * 			population /= act
 */
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_agent, __pyx_v_act_dex, sizeof(int), PyInt_FromLong, 0, 1, 0);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_act = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line160")'> 160: 			for k in range(act): population *= cnt - k</pre>
<pre id='line160' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":160
 * 			cnt = counts[agent[cnt_dex]]
 * 			act = agent[act_dex]
 * 			for k in range(act): population *= cnt - k             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			population /= act
 * 
 */
    __pyx_t_5 = __pyx_v_act;
    for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_k = __pyx_t_6;
      __pyx_v_population = (__pyx_v_population * (__pyx_v_cnt - __pyx_v_k));
    }
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line161")'> 161: 			population /= act</pre>
<pre id='line161' class='code' style='background-color: #FFFF9f'>
    /* "libchemicalstring_2.pyx":161
 * 			act = agent[act_dex]
 * 			for k in range(act): population *= cnt - k
 * 			population /= act             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		propensity = population * rate
 */
    if (unlikely(__pyx_v_act == 0)) {
      #ifdef WITH_THREAD
      PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
      #endif
      <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
      #ifdef WITH_THREAD
      PyGILState_Release(__pyx_gilstate_save);
      #endif
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_v_population = (__pyx_v_population / __pyx_v_act);
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line162")'> 162: </pre>
<pre id='line162' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line163")'> 163: 		propensity = population * rate</pre>
<pre id='line163' class='code' style='background-color: #FFFF4b'>
  /* "libchemicalstring_2.pyx":163
 * 			population /= act
 * 
 * 		propensity = population * rate             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return 0.0
 */
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_population);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (unlikely(!__pyx_cur_scope->__pyx_v_rate)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("rate");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_cur_scope->__pyx_v_rate);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_7 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_7 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_propensity = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line164")'> 164: 		if propensity &gt; propensity_minimum: return propensity</pre>
<pre id='line164' class='code' style='background-color: #FFFF9f'>
  /* "libchemicalstring_2.pyx":164
 * 
 * 		propensity = population * rate
 * 		if propensity > propensity_minimum: return propensity             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		else: return 0.0
 * 
 */
  __pyx_t_8 = ((__pyx_v_propensity > __pyx_v_propensity_minimum) != 0);
  if (__pyx_t_8) {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_propensity);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
    goto __pyx_L7;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line165")'> 165: 		else: return 0.0</pre>
<pre id='line165' class='code' style='background-color: #FFFF5e'>
    /* "libchemicalstring_2.pyx":165
 * 		propensity = population * rate
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#rate was a float and all stochiometric coefficients = 1
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }
  __pyx_L7:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction.propensity", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_11propensity_simple(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17generate_reaction_11propensity_simple = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("propensity_simple"), (PyCFunction)__pyx_pw_14stringchemical_17generate_reaction_11propensity_simple, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_11propensity_simple(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_simple (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_17generate_reaction_10propensity_simple(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line166")'> 166: </pre>
<pre id='line166' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line167")'> 167: 	#rate was a float and all stochiometric coefficients = 1</pre>
<pre id='line167' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line168")'> 168: 	def propensity_simple():</pre>
<pre id='line168' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":168
 * 
 * 	#rate was a float and all stochiometric coefficients = 1
 * 	def propensity_simple():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */

static PyObject *__pyx_pf_14stringchemical_17generate_reaction_10propensity_simple(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_outer_scope;
  double __pyx_v_population;
  double __pyx_v_propensity;
  double __pyx_v_propensity_minimum;
  int __pyx_v_cnt_dex;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_simple", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":168
 * 
 * 	#rate was a float and all stochiometric coefficients = 1
 * 	def propensity_simple():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */
  __pyx_k_tuple_35 = <span class='py_c_api'>PyTuple_Pack</span>(5, ((PyObject *)__pyx_n_s__population), ((PyObject *)__pyx_n_s__propensity), ((PyObject *)__pyx_n_s__propensity_minimum), ((PyObject *)__pyx_n_s__cnt_dex), ((PyObject *)__pyx_n_s__cnt));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_35);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_35));

  /* "libchemicalstring_2.pyx":168
 * 
 * 	#rate was a float and all stochiometric coefficients = 1
 * 	def propensity_simple():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17generate_reaction_11propensity_simple, 0, __pyx_n_s_37, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_36));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_propensity_simple = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_36 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__propensity_simple, 168, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_36)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line169")'> 169: 		cdef double population = 1.0</pre>
<pre id='line169' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":169
 * 	#rate was a float and all stochiometric coefficients = 1
 * 	def propensity_simple():
 * 		cdef double population = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 */
  __pyx_v_population = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line170")'> 170: 		cdef double propensity = 1.0</pre>
<pre id='line170' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":170
 * 	def propensity_simple():
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity_minimum = 1e-30
 * 		cdef int cnt_dex
 */
  __pyx_v_propensity = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line171")'> 171: 		cdef double propensity_minimum = 1e-30</pre>
<pre id='line171' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":171
 * 		cdef double population = 1.0
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef int cnt_dex
 * 		cdef int cnt
 */
  __pyx_v_propensity_minimum = 1e-30;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line172")'> 172: 		cdef int cnt_dex</pre>
<pre id='line172' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line173")'> 173: 		cdef int cnt</pre>
<pre id='line173' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line174")'> 174: 		#list comprehension? probably slower; need to test!</pre>
<pre id='line174' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line175")'> 175: 		for cnt_dex in cnt_dexes: population *= counts[cnt_dex]</pre>
<pre id='line175' class='code' style='background-color: #FFFF19'>
  /* "libchemicalstring_2.pyx":175
 * 		cdef int cnt
 * 		#list comprehension? probably slower; need to test!
 * 		for cnt_dex in cnt_dexes: population *= counts[cnt_dex]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		propensity = population * rate
 * 		if propensity > propensity_minimum: return propensity
 */
  if (unlikely(!__pyx_cur_scope->__pyx_v_cnt_dexes)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cnt_dexes");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_cur_scope->__pyx_v_cnt_dexes) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_cur_scope->__pyx_v_cnt_dexes)) {
    __pyx_t_1 = __pyx_cur_scope->__pyx_v_cnt_dexes; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_cur_scope->__pyx_v_cnt_dexes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_3 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_3 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    }
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_cnt_dex = __pyx_t_5;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_population);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_v_cnt_dex, sizeof(int), PyInt_FromLong, 0, 1, 0);<span class='error_goto'> if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_7 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7);<span class='error_goto'> if (unlikely((__pyx_t_8 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_population = __pyx_t_8;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line176")'> 176: 		propensity = population * rate</pre>
<pre id='line176' class='code' style='background-color: #FFFF4b'>
  /* "libchemicalstring_2.pyx":176
 * 		#list comprehension? probably slower; need to test!
 * 		for cnt_dex in cnt_dexes: population *= counts[cnt_dex]
 * 		propensity = population * rate             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return 0.0
 */
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_population);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (unlikely(!__pyx_cur_scope->__pyx_v_rate)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("rate");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_cur_scope->__pyx_v_rate);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7);<span class='error_goto'> if (unlikely((__pyx_t_8 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_propensity = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line177")'> 177: 		if propensity &gt; propensity_minimum: return propensity</pre>
<pre id='line177' class='code' style='background-color: #FFFF9f'>
  /* "libchemicalstring_2.pyx":177
 * 		for cnt_dex in cnt_dexes: population *= counts[cnt_dex]
 * 		propensity = population * rate
 * 		if propensity > propensity_minimum: return propensity             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		else: return 0.0
 * 
 */
  __pyx_t_9 = ((__pyx_v_propensity > __pyx_v_propensity_minimum) != 0);
  if (__pyx_t_9) {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_propensity);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
    goto __pyx_L5;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line178")'> 178: 		else: return 0.0</pre>
<pre id='line178' class='code' style='background-color: #FFFF5e'>
    /* "libchemicalstring_2.pyx":178
 * 		propensity = population * rate
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#rate was a float, there is but one stochiometric
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
  }
  __pyx_L5:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction.propensity_simple", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_13propensity_very_simple(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17generate_reaction_13propensity_very_simple = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("propensity_very_simple"), (PyCFunction)__pyx_pw_14stringchemical_17generate_reaction_13propensity_very_simple, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_13propensity_very_simple(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_very_simple (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_17generate_reaction_12propensity_very_simple(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line179")'> 179: </pre>
<pre id='line179' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line180")'> 180: 	#rate was a float, there is but one stochiometric</pre>
<pre id='line180' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line181")'> 181: 	# coefficient and it is equal to 1</pre>
<pre id='line181' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line182")'> 182: 	def propensity_very_simple():</pre>
<pre id='line182' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":182
 * 	#rate was a float, there is but one stochiometric
 * 	# coefficient and it is equal to 1
 * 	def propensity_very_simple():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 */

static PyObject *__pyx_pf_14stringchemical_17generate_reaction_12propensity_very_simple(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_outer_scope;
  double __pyx_v_propensity;
  double __pyx_v_propensity_minimum;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_very_simple", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":182
 * 	#rate was a float, there is but one stochiometric
 * 	# coefficient and it is equal to 1
 * 	def propensity_very_simple():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 */
  __pyx_k_tuple_38 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject *)__pyx_n_s__propensity), ((PyObject *)__pyx_n_s__propensity_minimum));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_38)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_38);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_38));

  /* "libchemicalstring_2.pyx":182
 * 	#rate was a float, there is but one stochiometric
 * 	# coefficient and it is equal to 1
 * 	def propensity_very_simple():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17generate_reaction_13propensity_very_simple, 0, __pyx_n_s_41, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_39));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_propensity_very_simple = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_39 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_38, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s_40, 182, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_39)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line183")'> 183: 		cdef double propensity = 1.0</pre>
<pre id='line183' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":183
 * 	# coefficient and it is equal to 1
 * 	def propensity_very_simple():
 * 		cdef double propensity = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef double propensity_minimum = 1e-30
 * 		propensity = counts[cnt_dexes[0]] * rate
 */
  __pyx_v_propensity = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line184")'> 184: 		cdef double propensity_minimum = 1e-30</pre>
<pre id='line184' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":184
 * 	def propensity_very_simple():
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		propensity = counts[cnt_dexes[0]] * rate
 * 		if propensity > propensity_minimum: return propensity
 */
  __pyx_v_propensity_minimum = 1e-30;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line185")'> 185: 		propensity = counts[cnt_dexes[0]] * rate</pre>
<pre id='line185' class='code' style='background-color: #FFFF3e'>
  /* "libchemicalstring_2.pyx":185
 * 		cdef double propensity = 1.0
 * 		cdef double propensity_minimum = 1e-30
 * 		propensity = counts[cnt_dexes[0]] * rate             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return 0.0
 */
  if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (unlikely(!__pyx_cur_scope->__pyx_v_cnt_dexes)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cnt_dexes");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_cnt_dexes, 0, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_t_1);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_cur_scope->__pyx_v_rate)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("rate");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_cur_scope->__pyx_v_rate);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_propensity = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line186")'> 186: 		if propensity &gt; propensity_minimum: return propensity</pre>
<pre id='line186' class='code' style='background-color: #FFFF9f'>
  /* "libchemicalstring_2.pyx":186
 * 		cdef double propensity_minimum = 1e-30
 * 		propensity = counts[cnt_dexes[0]] * rate
 * 		if propensity > propensity_minimum: return propensity             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		else: return 0.0
 * 
 */
  __pyx_t_4 = ((__pyx_v_propensity > __pyx_v_propensity_minimum) != 0);
  if (__pyx_t_4) {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_propensity);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line187")'> 187: 		else: return 0.0</pre>
<pre id='line187' class='code' style='background-color: #FFFF66'>
    /* "libchemicalstring_2.pyx":187
 * 		propensity = counts[cnt_dexes[0]] * rate
 * 		if propensity > propensity_minimum: return propensity
 * 		else: return 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#rate was a float and there are no reagents
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }
  __pyx_L3:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction.propensity_very_simple", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_15validator_constant(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17generate_reaction_15validator_constant = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("validator_constant"), (PyCFunction)__pyx_pw_14stringchemical_17generate_reaction_15validator_constant, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_15validator_constant(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("validator_constant (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_17generate_reaction_14validator_constant(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line188")'> 188: </pre>
<pre id='line188' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line189")'> 189: 	#rate was a float and there are no reagents</pre>
<pre id='line189' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line190")'> 190: 	# this if statement can be preprocessed/configured via lambda function!</pre>
<pre id='line190' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line191")'> 191: 	#def propensity_simplest():</pre>
<pre id='line191' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line192")'> 192: 	#	cdef double propensity_minimum = 1e-30</pre>
<pre id='line192' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line193")'> 193: 	#	cdef double rate</pre>
<pre id='line193' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line194")'> 194: 	#	if rate &gt; propensity_minimum: return rate</pre>
<pre id='line194' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line195")'> 195: 	#	else: return 0.0</pre>
<pre id='line195' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line196")'> 196: </pre>
<pre id='line196' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line197")'> 197: 	#if reagents is empty, the reaction is ALWAYS valid</pre>
<pre id='line197' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line198")'> 198: 	def validator_constant(): return True</pre>
<pre id='line198' class='code' style='background-color: #FFFF52'>
/* "libchemicalstring_2.pyx":198
 * 
 * 	#if reagents is empty, the reaction is ALWAYS valid
 * 	def validator_constant(): return True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#if reagents is nonempty, they MUST be checked before reacting
 */

static PyObject *__pyx_pf_14stringchemical_17generate_reaction_14validator_constant(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("validator_constant", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction.validator_constant", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_17validator(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17generate_reaction_17validator = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("validator"), (PyCFunction)__pyx_pw_14stringchemical_17generate_reaction_17validator, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_17validator(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("validator (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_17generate_reaction_16validator(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "libchemicalstring_2.pyx":198
 * 
 * 	#if reagents is empty, the reaction is ALWAYS valid
 * 	def validator_constant(): return True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#if reagents is nonempty, they MUST be checked before reacting
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17generate_reaction_15validator_constant, 0, __pyx_n_s_43, NULL, __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_42));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_validator_constant = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":198
 * 
 * 	#if reagents is empty, the reaction is ALWAYS valid
 * 	def validator_constant(): return True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#if reagents is nonempty, they MUST be checked before reacting
 */
  __pyx_k_codeobj_42 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 0, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__validator_constant, 198, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line199")'> 199: </pre>
<pre id='line199' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line200")'> 200: 	#if reagents is nonempty, they MUST be checked before reacting</pre>
<pre id='line200' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line201")'> 201: 	def validator():</pre>
<pre id='line201' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":201
 * 
 * 	#if reagents is nonempty, they MUST be checked before reacting
 * 	def validator():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef int dex
 * 		cdef int leng = len(cnt_dexes)
 */

static PyObject *__pyx_pf_14stringchemical_17generate_reaction_16validator(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_outer_scope;
  int __pyx_v_dex;
  int __pyx_v_leng;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("validator", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":201
 * 
 * 	#if reagents is nonempty, they MUST be checked before reacting
 * 	def validator():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef int dex
 * 		cdef int leng = len(cnt_dexes)
 */
  __pyx_k_tuple_44 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject *)__pyx_n_s__dex), ((PyObject *)__pyx_n_s__leng));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_44)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_44);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_44));

  /* "libchemicalstring_2.pyx":201
 * 
 * 	#if reagents is nonempty, they MUST be checked before reacting
 * 	def validator():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		cdef int dex
 * 		cdef int leng = len(cnt_dexes)
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17generate_reaction_17validator, 0, __pyx_n_s_46, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_45));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_validator = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_45 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_44, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__validator, 201, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_45)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line202")'> 202: 		cdef int dex</pre>
<pre id='line202' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line203")'> 203: 		cdef int leng = len(cnt_dexes)</pre>
<pre id='line203' class='code' style='background-color: #FFFF86'>
  /* "libchemicalstring_2.pyx":203
 * 	def validator():
 * 		cdef int dex
 * 		cdef int leng = len(cnt_dexes)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		#can this be a list comprehension / does that help?
 * 		for dex in range(leng):
 */
  if (unlikely(!__pyx_cur_scope->__pyx_v_cnt_dexes)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cnt_dexes");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = __pyx_cur_scope->__pyx_v_cnt_dexes;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_leng = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line204")'> 204: 		#can this be a list comprehension / does that help?</pre>
<pre id='line204' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line205")'> 205: 		for dex in range(leng):</pre>
<pre id='line205' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":205
 * 		cdef int leng = len(cnt_dexes)
 * 		#can this be a list comprehension / does that help?
 * 		for dex in range(leng):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			if counts[cnt_dexes[dex]] <code><</code> stochios[dex]: return False
 * 
 */
  __pyx_t_3 = __pyx_v_leng;
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_dex = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line206")'> 206: 			if counts[cnt_dexes[dex]] &lt; stochios[dex]: return False</pre>
<pre id='line206' class='code' style='background-color: #FFFF3b'>
    /* "libchemicalstring_2.pyx":206
 * 		#can this be a list comprehension / does that help?
 * 		for dex in range(leng):
 * 			if counts[cnt_dexes[dex]] <code><</code> stochios[dex]: return False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		return True
 */
    if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_cnt_dexes, __pyx_v_dex, sizeof(int), PyInt_FromLong, 0, 1, 0);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_t_1);<span class='error_goto'> if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_cur_scope->__pyx_v_stochios)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("stochios");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_stochios, __pyx_v_dex, sizeof(int), PyInt_FromLong, 0, 1, 0);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_1, Py_LT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_7 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_7) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_6 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      __pyx_r = __pyx_t_6;
      __pyx_t_6 = 0;
      goto __pyx_L0;
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line207")'> 207: </pre>
<pre id='line207' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line208")'> 208: 		return True</pre>
<pre id='line208' class='code' style='background-color: #FFFF62'>
  /* "libchemicalstring_2.pyx":208
 * 			if counts[cnt_dexes[dex]] <code><</code> stochios[dex]: return False
 * 
 * 		return True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def reaction():
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction.validator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_19reaction(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17generate_reaction_19reaction = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("reaction"), (PyCFunction)__pyx_pw_14stringchemical_17generate_reaction_19reaction, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_19reaction(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("reaction (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_17generate_reaction_18reaction(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line209")'> 209: </pre>
<pre id='line209' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line210")'> 210: 	def reaction():</pre>
<pre id='line210' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":210
 * 		return True
 * 
 * 	def reaction():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		for agent in reagents: counts[agent[1]] -= agent[0]
 * 		for agent in products: counts[agent[1]] += agent[0]
 */

static PyObject *__pyx_pf_14stringchemical_17generate_reaction_18reaction(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_outer_scope;
  PyObject *__pyx_v_agent = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("reaction", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":210
 * 		return True
 * 
 * 	def reaction():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		for agent in reagents: counts[agent[1]] -= agent[0]
 * 		for agent in products: counts[agent[1]] += agent[0]
 */
  __pyx_k_tuple_47 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_n_s__agent));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_47)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_47);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_47));

  /* "libchemicalstring_2.pyx":210
 * 		return True
 * 
 * 	def reaction():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		for agent in reagents: counts[agent[1]] -= agent[0]
 * 		for agent in products: counts[agent[1]] += agent[0]
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17generate_reaction_19reaction, 0, __pyx_n_s_49, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_48));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_reaction = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_48 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__reaction, 210, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_48)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line211")'> 211: 		for agent in reagents: counts[agent[1]] -= agent[0]</pre>
<pre id='line211' class='code' style='background-color: #FFFF32'>
  /* "libchemicalstring_2.pyx":211
 * 
 * 	def reaction():
 * 		for agent in reagents: counts[agent[1]] -= agent[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		for agent in products: counts[agent[1]] += agent[0]
 * 
 */
  if (unlikely(!__pyx_cur_scope->__pyx_v_reagents)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("reagents");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (unlikely(((PyObject *)__pyx_cur_scope->__pyx_v_reagents) == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = ((PyObject *)__pyx_cur_scope->__pyx_v_reagents); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
    __pyx_v_agent = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_agent, 1, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_t_3);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_agent, 0, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyNumber_InPlaceSubtract</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_t_3, __pyx_t_6) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line212")'> 212: 		for agent in products: counts[agent[1]] += agent[0]</pre>
<pre id='line212' class='code' style='background-color: #FFFF27'>
  /* "libchemicalstring_2.pyx":212
 * 	def reaction():
 * 		for agent in reagents: counts[agent[1]] -= agent[0]
 * 		for agent in products: counts[agent[1]] += agent[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#this should not be used anymore!
 */
  if (unlikely(!__pyx_cur_scope->__pyx_v_products)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("products");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (unlikely(((PyObject *)__pyx_cur_scope->__pyx_v_products) == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = ((PyObject *)__pyx_cur_scope->__pyx_v_products); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
    __pyx_v_agent = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_agent, 1, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_6 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_t_3);<span class='error_goto'> if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_agent, 0, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_t_3, __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction.reaction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_21measure_agent(PyObject *__pyx_self, PyObject *__pyx_v_agent); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17generate_reaction_21measure_agent = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("measure_agent"), (PyCFunction)__pyx_pw_14stringchemical_17generate_reaction_21measure_agent, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_21measure_agent(PyObject *__pyx_self, PyObject *__pyx_v_agent) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("measure_agent (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_17generate_reaction_20measure_agent(__pyx_self, ((PyObject *)__pyx_v_agent));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line213")'> 213: </pre>
<pre id='line213' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line214")'> 214: 	#this should not be used anymore!</pre>
<pre id='line214' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line215")'> 215: 	#def use_rate(double rate):</pre>
<pre id='line215' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line216")'> 216: 	#	def rate_(cnts, varis): return rate</pre>
<pre id='line216' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line217")'> 217: 	#	return rate_</pre>
<pre id='line217' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line218")'> 218: </pre>
<pre id='line218' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line219")'> 219: 	def measure_agent(agent):</pre>
<pre id='line219' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":219
 * 	#	return rate_
 * 
 * 	def measure_agent(agent):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		nothings = ['nothing', 'null', '']
 * 		if not agent in nothings:
 */

static PyObject *__pyx_pf_14stringchemical_17generate_reaction_20measure_agent(PyObject *__pyx_self, PyObject *__pyx_v_agent) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_outer_scope;
  PyObject *__pyx_v_nothings = NULL;
  PyObject *__pyx_v_one = NULL;
  PyObject *__pyx_v_two = NULL;
  PyObject *__pyx_v_amt = NULL;
  PyObject *__pyx_v_spec_dex = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("measure_agent", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":219
 * 	#	return rate_
 * 
 * 	def measure_agent(agent):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		nothings = ['nothing', 'null', '']
 * 		if not agent in nothings:
 */
  __pyx_k_tuple_50 = <span class='py_c_api'>PyTuple_Pack</span>(6, ((PyObject *)__pyx_n_s__agent), ((PyObject *)__pyx_n_s__nothings), ((PyObject *)__pyx_n_s__one), ((PyObject *)__pyx_n_s__two), ((PyObject *)__pyx_n_s__amt), ((PyObject *)__pyx_n_s__spec_dex));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_50)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_50);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_50));

  /* "libchemicalstring_2.pyx":219
 * 	#	return rate_
 * 
 * 	def measure_agent(agent):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		nothings = ['nothing', 'null', '']
 * 		if not agent in nothings:
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17generate_reaction_21measure_agent, 0, __pyx_n_s_52, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_51));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_measure_agent = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_51 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(1, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_50, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__measure_agent, 219, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_51)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line220")'> 220: 		nothings = ['nothing', 'null', '']</pre>
<pre id='line220' class='code' style='background-color: #FFFF79'>
  /* "libchemicalstring_2.pyx":220
 * 
 * 	def measure_agent(agent):
 * 		nothings = ['nothing', 'null', '']             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if not agent in nothings:
 * 			one = agent.find('(')
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__nothing));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__nothing));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__nothing));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__null));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_n_s__null));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__null));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_10));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, ((PyObject *)__pyx_kp_s_10));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_10));
  __pyx_v_nothings = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line221")'> 221: 		if not agent in nothings:</pre>
<pre id='line221' class='code' style='background-color: #FFFFaa'>
  /* "libchemicalstring_2.pyx":221
 * 	def measure_agent(agent):
 * 		nothings = ['nothing', 'null', '']
 * 		if not agent in nothings:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			one = agent.find('(')
 * 			two = agent.find(')')
 */
  __pyx_t_2 = (__Pyx_<span class='py_c_api'>PySequence_Contains</span>(__pyx_v_agent, ((PyObject *)__pyx_v_nothings), Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_2 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = ((!(__pyx_t_2 != 0)) != 0);
  if (__pyx_t_3) {
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line222")'> 222: 			one = agent.find('(')</pre>
<pre id='line222' class='code' style='background-color: #FFFF62'>
    /* "libchemicalstring_2.pyx":222
 * 		nothings = ['nothing', 'null', '']
 * 		if not agent in nothings:
 * 			one = agent.find('(')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			two = agent.find(')')
 * 			amt = int(agent[one + 1:two])
 */
    __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_agent, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_12), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_one = __pyx_t_4;
    __pyx_t_4 = 0;

  /* "libchemicalstring_2.pyx":222
 * 		nothings = ['nothing', 'null', '']
 * 		if not agent in nothings:
 * 			one = agent.find('(')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			two = agent.find(')')
 * 			amt = int(agent[one + 1:two])
 */
  __pyx_k_tuple_12 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_11));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_12);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_12));
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line223")'> 223: 			two = agent.find(')')</pre>
<pre id='line223' class='code' style='background-color: #FFFF62'>
    /* "libchemicalstring_2.pyx":223
 * 		if not agent in nothings:
 * 			one = agent.find('(')
 * 			two = agent.find(')')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			amt = int(agent[one + 1:two])
 * 			spec_dex = count_targets.index(agent[two + 1:])
 */
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_agent, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_k_tuple_13), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_two = __pyx_t_1;
    __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":223
 * 		if not agent in nothings:
 * 			one = agent.find('(')
 * 			two = agent.find(')')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			amt = int(agent[one + 1:two])
 * 			spec_dex = count_targets.index(agent[two + 1:])
 */
  __pyx_k_tuple_13 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_3));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_13);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_13));
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line224")'> 224: 			amt = int(agent[one + 1:two])</pre>
<pre id='line224' class='code' style='background-color: #FFFF4d'>
    /* "libchemicalstring_2.pyx":224
 * 			one = agent.find('(')
 * 			two = agent.find(')')
 * 			amt = int(agent[one + 1:two])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			spec_dex = count_targets.index(agent[two + 1:])
 * 			return (amt, spec_dex)
 */
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_one, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_agent, 0, 0, &__pyx_t_1, &__pyx_v_two, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_v_amt = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line225")'> 225: 			spec_dex = count_targets.index(agent[two + 1:])</pre>
<pre id='line225' class='code' style='background-color: #FFFF3e'>
    /* "libchemicalstring_2.pyx":225
 * 			two = agent.find(')')
 * 			amt = int(agent[one + 1:two])
 * 			spec_dex = count_targets.index(agent[two + 1:])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			return (amt, spec_dex)
 * 
 */
    if (unlikely(!__pyx_cur_scope->__pyx_v_count_targets)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("count_targets");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_cur_scope->__pyx_v_count_targets, __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_two, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_agent, 0, 0, &__pyx_t_1, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_v_spec_dex = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line226")'> 226: 			return (amt, spec_dex)</pre>
<pre id='line226' class='code' style='background-color: #FFFF7f'>
    /* "libchemicalstring_2.pyx":226
 * 			amt = int(agent[one + 1:two])
 * 			spec_dex = count_targets.index(agent[two + 1:])
 * 			return (amt, spec_dex)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		else: return (0, count_targets.index('null'))
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_amt);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_amt);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_amt);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_spec_dex);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_spec_dex);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_spec_dex);
    __pyx_r = ((PyObject *)__pyx_t_5);
    __pyx_t_5 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line227")'> 227: </pre>
<pre id='line227' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line228")'> 228: 		else: return (0, count_targets.index('null'))</pre>
<pre id='line228' class='code' style='background-color: #FFFF31'>
    /* "libchemicalstring_2.pyx":228
 * 			return (amt, spec_dex)
 * 
 * 		else: return (0, count_targets.index('null'))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	split = rxn_string.split('->')
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope->__pyx_v_count_targets)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("count_targets");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_cur_scope->__pyx_v_count_targets, __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_k_tuple_14), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_0);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_r = ((PyObject *)__pyx_t_5);
    __pyx_t_5 = 0;
    goto __pyx_L0;
  }
  __pyx_L3:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction.measure_agent", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nothings);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_one);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_two);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_amt);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_spec_dex);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_22lambda1(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17generate_reaction_22lambda1 = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("lambda1"), (PyCFunction)__pyx_pw_14stringchemical_17generate_reaction_22lambda1, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_22lambda1(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("lambda1 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda1(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "libchemicalstring_2.pyx":228
 * 			return (amt, spec_dex)
 * 
 * 		else: return (0, count_targets.index('null'))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	split = rxn_string.split('->')
 */
  __pyx_k_tuple_14 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_n_s__null));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_14);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_14));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line229")'> 229: </pre>
<pre id='line229' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line230")'> 230: 	split = rxn_string.split('-&gt;')</pre>
<pre id='line230' class='code' style='background-color: #FFFF62'>
  /* "libchemicalstring_2.pyx":230
 * 		else: return (0, count_targets.index('null'))
 * 
 * 	split = rxn_string.split('->')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	try:
 * 		rate = float(split[1])
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_rxn_string, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_54), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_split = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "libchemicalstring_2.pyx":230
 * 		else: return (0, count_targets.index('null'))
 * 
 * 	split = rxn_string.split('->')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	try:
 * 		rate = float(split[1])
 */
  __pyx_k_tuple_54 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_53));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_54)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_54);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_54));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line231")'> 231: 	try:</pre>
<pre id='line231' class='code' style='background-color: #FFFFd4'>
  /* "libchemicalstring_2.pyx":231
 * 
 * 	split = rxn_string.split('->')
 * 	try:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		rate = float(split[1])
 * 		rate_flag = False
 */
  {
    <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_3, &__pyx_t_4, &__pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_5);
    /*try:*/ {
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line232")'> 232: 		rate = float(split[1])</pre>
<pre id='line232' class='code' style='background-color: #FFFF5b'>
      /* "libchemicalstring_2.pyx":232
 * 	split = rxn_string.split('->')
 * 	try:
 * 		rate = float(split[1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		rate_flag = False
 * 
 */
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_split, 1, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      __pyx_cur_scope->__pyx_v_rate = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line233")'> 233: 		rate_flag = False</pre>
<pre id='line233' class='code' style='background-color: #FFFFaa'>
      /* "libchemicalstring_2.pyx":233
 * 	try:
 * 		rate = float(split[1])
 * 		rate_flag = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	except ValueError:
 */
      __pyx_v_rate_flag = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L10_try_end;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line234")'> 234: </pre>
<pre id='line234' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line235")'> 235: 	except ValueError:</pre>
<pre id='line235' class='code' style='background-color: #FFFF86'>
    /* "libchemicalstring_2.pyx":235
 * 		rate_flag = False
 * 
 * 	except ValueError:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		try:
 * 			func_dex = func_names.index(split[1])
 */
    __pyx_t_7 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ValueError);
    if (__pyx_t_7) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_2, &__pyx_t_1, &__pyx_t_8) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line236")'> 236: 		try:</pre>
<pre id='line236' class='code' style='background-color: #FFFFd4'>
      /* "libchemicalstring_2.pyx":236
 * 
 * 	except ValueError:
 * 		try:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			func_dex = func_names.index(split[1])
 * 			rate = functions[func_dex]
 */
      {
        <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_9, &__pyx_t_10, &__pyx_t_11);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_10);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_11);
        /*try:*/ {
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line237")'> 237: 			func_dex = func_names.index(split[1])</pre>
<pre id='line237' class='code' style='background-color: #FFFF55'>
          /* "libchemicalstring_2.pyx":237
 * 	except ValueError:
 * 		try:
 * 			func_dex = func_names.index(split[1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			rate = functions[func_dex]
 * 			rate_flag = True
 */
          __pyx_t_12 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_func_names, __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L13_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_split, 1, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L13_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L13_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_13);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_13);
          __pyx_t_13 = 0;
          __pyx_t_13 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_12, ((PyObject *)__pyx_t_14), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L13_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_14)); __pyx_t_14 = 0;
          __pyx_v_func_dex = __pyx_t_13;
          __pyx_t_13 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line238")'> 238: 			rate = functions[func_dex]</pre>
<pre id='line238' class='code' style='background-color: #FFFF9f'>
          /* "libchemicalstring_2.pyx":238
 * 		try:
 * 			func_dex = func_names.index(split[1])
 * 			rate = functions[func_dex]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			rate_flag = True
 * 
 */
          __pyx_t_13 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_functions, __pyx_v_func_dex);<span class='error_goto'> if (!__pyx_t_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L13_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_cur_scope->__pyx_v_rate);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_cur_scope->__pyx_v_rate);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_13);
          __pyx_cur_scope->__pyx_v_rate = __pyx_t_13;
          __pyx_t_13 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line239")'> 239: 			rate_flag = True</pre>
<pre id='line239' class='code' style='background-color: #FFFF9f'>
          /* "libchemicalstring_2.pyx":239
 * 			func_dex = func_names.index(split[1])
 * 			rate = functions[func_dex]
 * 			rate_flag = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		except ValueError:
 */
          __pyx_v_rate_flag = 1;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        goto __pyx_L20_try_end;
        __pyx_L13_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line240")'> 240: </pre>
<pre id='line240' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line241")'> 241: 		except ValueError:</pre>
<pre id='line241' class='code' style='background-color: #FFFF86'>
        /* "libchemicalstring_2.pyx":241
 * 			rate_flag = True
 * 
 * 		except ValueError:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			var_dex = variables.index(split[1])
 * 			rate = float(var_vals[var_dex])
 */
        __pyx_t_7 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ValueError);
        if (__pyx_t_7) {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_13, &__pyx_t_14, &__pyx_t_12) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L15_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line242")'> 242: 			var_dex = variables.index(split[1])</pre>
<pre id='line242' class='code' style='background-color: #FFFF55'>
          /* "libchemicalstring_2.pyx":242
 * 
 * 		except ValueError:
 * 			var_dex = variables.index(split[1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			rate = float(var_vals[var_dex])
 * 			rate_flag = False
 */
          __pyx_t_15 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_variables, __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L15_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
          __pyx_t_16 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_split, 1, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_16) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L15_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
          __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L15_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_t_16);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_16);
          __pyx_t_16 = 0;
          __pyx_t_16 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_15, ((PyObject *)__pyx_t_17), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L15_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
          __pyx_v_var_dex = __pyx_t_16;
          __pyx_t_16 = 0;
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line243")'> 243: 			rate = float(var_vals[var_dex])</pre>
<pre id='line243' class='code' style='background-color: #FFFF4f'>
          /* "libchemicalstring_2.pyx":243
 * 		except ValueError:
 * 			var_dex = variables.index(split[1])
 * 			rate = float(var_vals[var_dex])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			rate_flag = False
 * 
 */
          __pyx_t_16 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_var_vals, __pyx_v_var_dex);<span class='error_goto'> if (!__pyx_t_16) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L15_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
          __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_16);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L15_except_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
          __pyx_t_16 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L15_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_cur_scope->__pyx_v_rate);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_cur_scope->__pyx_v_rate);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_16);
          __pyx_cur_scope->__pyx_v_rate = __pyx_t_16;
          __pyx_t_16 = 0;
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line244")'> 244: 			rate_flag = False</pre>
<pre id='line244' class='code' style='background-color: #FFFF6a'>
          /* "libchemicalstring_2.pyx":244
 * 			var_dex = variables.index(split[1])
 * 			rate = float(var_vals[var_dex])
 * 			rate_flag = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	cdef double propensity_minimum = 1e-30
 */
          __pyx_v_rate_flag = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          goto __pyx_L14_exception_handled;
        }
        __pyx_L15_except_error:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_10);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_11);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
        goto __pyx_L5_except_error;
        __pyx_L14_exception_handled:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_9);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_10);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_11);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
        __pyx_L20_try_end:;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L4_exception_handled;
    }
    __pyx_L5_except_error:;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
    goto __pyx_L1_error;
    __pyx_L4_exception_handled:;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
    __pyx_L10_try_end:;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line245")'> 245: </pre>
<pre id='line245' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line246")'> 246: 	cdef double propensity_minimum = 1e-30</pre>
<pre id='line246' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":246
 * 			rate_flag = False
 * 
 * 	cdef double propensity_minimum = 1e-30             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	reagents = [measure_agent(agent) for agent in split[0].split('+')]
 * 	products = [measure_agent(agent) for agent in split[2].split('+')]
 */
  __pyx_v_propensity_minimum = 1e-30;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line247")'> 247: 	reagents = [measure_agent(agent) for agent in split[0].split('+')]</pre>
<pre id='line247' class='code' style='background-color: #FFFF1c'>
  /* "libchemicalstring_2.pyx":247
 * 
 * 	cdef double propensity_minimum = 1e-30
 * 	reagents = [measure_agent(agent) for agent in split[0].split('+')]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	products = [measure_agent(agent) for agent in split[2].split('+')]
 * 	cnt_dexes = [agent[1] for agent in reagents]
 */
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_split, 0, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_56), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_18 = 0;
    __pyx_t_19 = NULL;
  } else {
    __pyx_t_18 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_19 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (!__pyx_t_19 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_18 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_18++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_18); __pyx_t_18++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_19 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_18 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_18++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_18); __pyx_t_18++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_1 = __pyx_t_19(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
    __pyx_v_agent = __pyx_t_1;
    __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_pf_14stringchemical_17generate_reaction_20measure_agent(__pyx_v_measure_agent, __pyx_v_agent);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_8, (PyObject*)__pyx_t_1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_8));
  __pyx_cur_scope->__pyx_v_reagents = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;

  /* "libchemicalstring_2.pyx":247
 * 
 * 	cdef double propensity_minimum = 1e-30
 * 	reagents = [measure_agent(agent) for agent in split[0].split('+')]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	products = [measure_agent(agent) for agent in split[2].split('+')]
 * 	cnt_dexes = [agent[1] for agent in reagents]
 */
  __pyx_k_tuple_56 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_55));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_56)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_56);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_56));
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line248")'> 248: 	products = [measure_agent(agent) for agent in split[2].split('+')]</pre>
<pre id='line248' class='code' style='background-color: #FFFF1c'>
  /* "libchemicalstring_2.pyx":248
 * 	cdef double propensity_minimum = 1e-30
 * 	reagents = [measure_agent(agent) for agent in split[0].split('+')]
 * 	products = [measure_agent(agent) for agent in split[2].split('+')]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cnt_dexes = [agent[1] for agent in reagents]
 * 	try:
 */
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_split, 2, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_57), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_18 = 0;
    __pyx_t_19 = NULL;
  } else {
    __pyx_t_18 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_19 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (!__pyx_t_19 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_18 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_18++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_18); __pyx_t_18++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_19 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_18 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_18++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_18); __pyx_t_18++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_2 = __pyx_t_19(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
    __pyx_v_agent = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_t_2 = __pyx_pf_14stringchemical_17generate_reaction_20measure_agent(__pyx_v_measure_agent, __pyx_v_agent);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_8, (PyObject*)__pyx_t_2)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_8));
  __pyx_cur_scope->__pyx_v_products = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;

  /* "libchemicalstring_2.pyx":248
 * 	cdef double propensity_minimum = 1e-30
 * 	reagents = [measure_agent(agent) for agent in split[0].split('+')]
 * 	products = [measure_agent(agent) for agent in split[2].split('+')]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cnt_dexes = [agent[1] for agent in reagents]
 * 	try:
 */
  __pyx_k_tuple_57 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_55));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_57)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_57);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_57));
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line249")'> 249: 	cnt_dexes = [agent[1] for agent in reagents]</pre>
<pre id='line249' class='code' style='background-color: #FFFF5e'>
  /* "libchemicalstring_2.pyx":249
 * 	reagents = [measure_agent(agent) for agent in split[0].split('+')]
 * 	products = [measure_agent(agent) for agent in split[2].split('+')]
 * 	cnt_dexes = [agent[1] for agent in reagents]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	try:
 * 		stochios, cnt_dexes = zip(*[(agent[0], cnt) for agent, cnt
 */
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_1 = ((PyObject *)__pyx_cur_scope->__pyx_v_reagents); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_18 = 0;
  for (;;) {
    if (__pyx_t_18 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_18++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_18); __pyx_t_18++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
    __pyx_v_agent = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_agent, 1, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_8, (PyObject*)__pyx_t_2)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_8));
  __pyx_cur_scope->__pyx_v_cnt_dexes = ((PyObject *)__pyx_t_8);
  __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line250")'> 250: 	try:</pre>
<pre id='line250' class='code' style='background-color: #FFFFd4'>
  /* "libchemicalstring_2.pyx":250
 * 	products = [measure_agent(agent) for agent in split[2].split('+')]
 * 	cnt_dexes = [agent[1] for agent in reagents]
 * 	try:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		stochios, cnt_dexes = zip(*[(agent[0], cnt) for agent, cnt
 * 					in zip(reagents, cnt_dexes) if agent[0] > 0])
 */
  {
    <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_5, &__pyx_t_4, &__pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);
    /*try:*/ {
</pre><pre class='line' style='background-color: #FFFF18' onclick='toggleDiv("line251")'> 251: 		stochios, cnt_dexes = zip(*[(agent[0], cnt) for agent, cnt</pre>
<pre id='line251' class='code' style='background-color: #FFFF18'>
      /* "libchemicalstring_2.pyx":251
 * 	cnt_dexes = [agent[1] for agent in reagents]
 * 	try:
 * 		stochios, cnt_dexes = zip(*[(agent[0], cnt) for agent, cnt             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 					in zip(reagents, cnt_dexes) if agent[0] > 0])
 * 
 */
      __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);

        /* "libchemicalstring_2.pyx":251
 * 	cnt_dexes = [agent[1] for agent in reagents]
 * 	try:
 * 		stochios, cnt_dexes = zip(*[(agent[0], cnt) for agent, cnt             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 					in zip(reagents, cnt_dexes) if agent[0] > 0])
 * 
 */
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
        __pyx_v_agent = __pyx_t_12;
        __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cnt);
        __pyx_v_cnt = __pyx_t_14;
        __pyx_t_14 = 0;

          /* "libchemicalstring_2.pyx":251
 * 	cnt_dexes = [agent[1] for agent in reagents]
 * 	try:
 * 		stochios, cnt_dexes = zip(*[(agent[0], cnt) for agent, cnt             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 					in zip(reagents, cnt_dexes) if agent[0] > 0])
 * 
 */
          __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_agent, 0, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_14) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
          __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_14);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cnt);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_cnt);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_cnt);
          __pyx_t_14 = 0;
          if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_8, (PyObject*)__pyx_t_2)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
          goto __pyx_L41;
        }
        __pyx_L41:;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PySequence_Tuple</span>(((PyObject *)__pyx_t_8));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_zip, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
        PyObject* sequence = __pyx_t_8;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      } else
      {
        Py_ssize_t index = -1;
        __pyx_t_14 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_20 = Py_TYPE(__pyx_t_14)->tp_iternext;
        index = 0; __pyx_t_1 = __pyx_t_20(__pyx_t_14); if (unlikely(!__pyx_t_1)) goto __pyx_L42_unpacking_failed;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        index = 1; __pyx_t_2 = __pyx_t_20(__pyx_t_14); if (unlikely(!__pyx_t_2)) goto __pyx_L42_unpacking_failed;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_20(__pyx_t_14), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
        __pyx_t_20 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        goto __pyx_L43_unpacking_done;
        __pyx_L42_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        __pyx_t_20 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
        __pyx_L43_unpacking_done:;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_cur_scope->__pyx_v_stochios = __pyx_t_1;
      __pyx_t_1 = 0;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope->__pyx_v_cnt_dexes);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope->__pyx_v_cnt_dexes);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      __pyx_cur_scope->__pyx_v_cnt_dexes = __pyx_t_2;
      __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L36_try_end;
    __pyx_L29_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFF12' onclick='toggleDiv("line252")'> 252: 					in zip(reagents, cnt_dexes) if agent[0] &gt; 0])</pre>
<pre id='line252' class='code' style='background-color: #FFFF12'>
      /* "libchemicalstring_2.pyx":252
 * 	try:
 * 		stochios, cnt_dexes = zip(*[(agent[0], cnt) for agent, cnt
 * 					in zip(reagents, cnt_dexes) if agent[0] > 0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	except ValueError: stochios, cnt_dexes = [], []
 */
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_cur_scope->__pyx_v_reagents));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_cur_scope->__pyx_v_reagents));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_cur_scope->__pyx_v_reagents));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_cnt_dexes);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_cur_scope->__pyx_v_cnt_dexes);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_cnt_dexes);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_zip, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
        __pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_18 = 0;
        __pyx_t_19 = NULL;
      } else {
        __pyx_t_18 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_19 = Py_TYPE(__pyx_t_1)->tp_iternext;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      for (;;) {
        if (!__pyx_t_19 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
          if (__pyx_t_18 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_18++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_18); __pyx_t_18++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
          #endif
        } else if (!__pyx_t_19 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
          if (__pyx_t_18 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_18++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_18); __pyx_t_18++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
          #endif
        } else {
          __pyx_t_2 = __pyx_t_19(__pyx_t_1);
          if (unlikely(!__pyx_t_2)) {
            if (<span class='py_c_api'>PyErr_Occurred</span>()) {
              if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
            }
            break;
          }
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        }
        if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
          PyObject* sequence = __pyx_t_2;
          #if CYTHON_COMPILING_IN_CPYTHON
          Py_ssize_t size = Py_SIZE(sequence);
          #else
          Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
          #endif
          if (unlikely(size != 2)) {
            if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
            else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
          }
          #if CYTHON_COMPILING_IN_CPYTHON
          if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
            __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
            __pyx_t_14 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
          } else {
            __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
            __pyx_t_14 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          #else
          __pyx_t_12 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          __pyx_t_14 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
          #endif
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        } else
        {
          Py_ssize_t index = -1;
          __pyx_t_13 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_20 = Py_TYPE(__pyx_t_13)->tp_iternext;
          index = 0; __pyx_t_12 = __pyx_t_20(__pyx_t_13); if (unlikely(!__pyx_t_12)) goto __pyx_L39_unpacking_failed;
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          index = 1; __pyx_t_14 = __pyx_t_20(__pyx_t_13); if (unlikely(!__pyx_t_14)) goto __pyx_L39_unpacking_failed;
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
          if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_20(__pyx_t_13), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
          __pyx_t_20 = NULL;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          goto __pyx_L40_unpacking_done;
          __pyx_L39_unpacking_failed:;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          __pyx_t_20 = NULL;
          if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
          __pyx_L40_unpacking_done:;
        }

        /* "libchemicalstring_2.pyx":252
 * 	try:
 * 		stochios, cnt_dexes = zip(*[(agent[0], cnt) for agent, cnt
 * 					in zip(reagents, cnt_dexes) if agent[0] > 0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	except ValueError: stochios, cnt_dexes = [], []
 */
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_agent, 0, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_14 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_int_0, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_21 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_14);<span class='error_goto'> if (unlikely(__pyx_t_21 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L29_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        if (__pyx_t_21) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line253")'> 253: </pre>
<pre id='line253' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line254")'> 254: 	except ValueError: stochios, cnt_dexes = [], []</pre>
<pre id='line254' class='code' style='background-color: #FFFF43'>
    /* "libchemicalstring_2.pyx":254
 * 					in zip(reagents, cnt_dexes) if agent[0] > 0])
 * 
 * 	except ValueError: stochios, cnt_dexes = [], []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	if len(cnt_dexes) == 0: has_reagents = False
 * 	elif len(cnt_dexes) == 1 and stochios[0] > 0:
 */
    __pyx_t_7 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ValueError);
    if (__pyx_t_7) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_8, &__pyx_t_2, &__pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L31_except_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_14 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L31_except_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
      __pyx_t_12 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L31_except_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_cur_scope->__pyx_v_stochios);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_cur_scope->__pyx_v_stochios);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_14));
      __pyx_cur_scope->__pyx_v_stochios = ((PyObject *)__pyx_t_14);
      __pyx_t_14 = 0;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope->__pyx_v_cnt_dexes);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope->__pyx_v_cnt_dexes);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_12));
      __pyx_cur_scope->__pyx_v_cnt_dexes = ((PyObject *)__pyx_t_12);
      __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L30_exception_handled;
    }
    __pyx_L31_except_error:;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
    goto __pyx_L1_error;
    __pyx_L30_exception_handled:;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);
    __pyx_L36_try_end:;
  }
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line255")'> 255: 	if len(cnt_dexes) == 0: has_reagents = False</pre>
<pre id='line255' class='code' style='background-color: #FFFF96'>
  /* "libchemicalstring_2.pyx":255
 * 
 * 	except ValueError: stochios, cnt_dexes = [], []
 * 	if len(cnt_dexes) == 0: has_reagents = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	elif len(cnt_dexes) == 1 and stochios[0] > 0:
 * 		has_reagents = True; only_one_reagent = True
 */
  __pyx_t_1 = __pyx_cur_scope->__pyx_v_cnt_dexes;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_18 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_18 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_21 = ((__pyx_t_18 == 0) != 0);
  if (__pyx_t_21) {
    __pyx_v_has_reagents = 0;
    goto __pyx_L46;
  }
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line256")'> 256: 	elif len(cnt_dexes) == 1 and stochios[0] &gt; 0:</pre>
<pre id='line256' class='code' style='background-color: #FFFF52'>
  /* "libchemicalstring_2.pyx":256
 * 	except ValueError: stochios, cnt_dexes = [], []
 * 	if len(cnt_dexes) == 0: has_reagents = False
 * 	elif len(cnt_dexes) == 1 and stochios[0] > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		has_reagents = True; only_one_reagent = True
 * 
 */
  __pyx_t_1 = __pyx_cur_scope->__pyx_v_cnt_dexes;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_18 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_18 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_21 = (__pyx_t_18 == 1);
  if (__pyx_t_21) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_stochios, 0, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_int_0, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_22 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_22 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_23 = __pyx_t_22;
  } else {
    __pyx_t_23 = __pyx_t_21;
  }
  if (__pyx_t_23) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line257")'> 257: 		has_reagents = True; only_one_reagent = True</pre>
<pre id='line257' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":257
 * 	if len(cnt_dexes) == 0: has_reagents = False
 * 	elif len(cnt_dexes) == 1 and stochios[0] > 0:
 * 		has_reagents = True; only_one_reagent = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	else: has_reagents = True; only_one_reagent = False
 */
    __pyx_v_has_reagents = 1;
    __pyx_v_only_one_reagent = 1;
    goto __pyx_L46;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line258")'> 258: </pre>
<pre id='line258' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line259")'> 259: 	else: has_reagents = True; only_one_reagent = False</pre>
<pre id='line259' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":259
 * 		has_reagents = True; only_one_reagent = True
 * 
 * 	else: has_reagents = True; only_one_reagent = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	if len(stochios) == sum(stochios): single_stochios = True
 * 	rate_call_group.append(rate_flag)
 */
    __pyx_v_has_reagents = 1;
    __pyx_v_only_one_reagent = 0;
  }
  __pyx_L46:;
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line260")'> 260: 	if len(stochios) == sum(stochios): single_stochios = True</pre>
<pre id='line260' class='code' style='background-color: #FFFF35'>
  /* "libchemicalstring_2.pyx":260
 * 
 * 	else: has_reagents = True; only_one_reagent = False
 * 	if len(stochios) == sum(stochios): single_stochios = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	rate_call_group.append(rate_flag)
 * 	if not rate_flag:
 */
  __pyx_t_2 = __pyx_cur_scope->__pyx_v_stochios;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_18 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_18 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_stochios);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_cur_scope->__pyx_v_stochios);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_stochios);
  __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_sum, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_8, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_23 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_23 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_23) {
    __pyx_v_single_stochios = 1;
    goto __pyx_L47;
  }
  __pyx_L47:;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line261")'> 261: 	rate_call_group.append(rate_flag)</pre>
<pre id='line261' class='code' style='background-color: #FFFF73'>
  /* "libchemicalstring_2.pyx":261
 * 	else: has_reagents = True; only_one_reagent = False
 * 	if len(stochios) == sum(stochios): single_stochios = True
 * 	rate_call_group.append(rate_flag)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	if not rate_flag:
 * 		if not has_reagents:
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_rate_flag);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_8 = __Pyx_<span class='py_c_api'>PyObject_Append</span>(__pyx_v_rate_call_group, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line262")'> 262: 	if not rate_flag:</pre>
<pre id='line262' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":262
 * 	if len(stochios) == sum(stochios): single_stochios = True
 * 	rate_call_group.append(rate_flag)
 * 	if not rate_flag:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if not has_reagents:
 * 			valid = validator_constant
 */
  __pyx_t_23 = ((!(__pyx_v_rate_flag != 0)) != 0);
  if (__pyx_t_23) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line263")'> 263: 		if not has_reagents:</pre>
<pre id='line263' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":263
 * 	rate_call_group.append(rate_flag)
 * 	if not rate_flag:
 * 		if not has_reagents:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			valid = validator_constant
 * 			if rate > propensity_minimum:
 */
    __pyx_t_23 = ((!(__pyx_v_has_reagents != 0)) != 0);
    if (__pyx_t_23) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line264")'> 264: 			valid = validator_constant</pre>
<pre id='line264' class='code' style='background-color: #FFFFe7'>
      /* "libchemicalstring_2.pyx":264
 * 	if not rate_flag:
 * 		if not has_reagents:
 * 			valid = validator_constant             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			if rate > propensity_minimum:
 * 				correct_propensity = lambda: rate
 */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_validator_constant);
      __pyx_v_valid = __pyx_v_validator_constant;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line265")'> 265: 			if rate &gt; propensity_minimum:</pre>
<pre id='line265' class='code' style='background-color: #FFFF5e'>
      /* "libchemicalstring_2.pyx":265
 * 		if not has_reagents:
 * 			valid = validator_constant
 * 			if rate > propensity_minimum:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				correct_propensity = lambda: rate
 * 
 */
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_propensity_minimum);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_cur_scope->__pyx_v_rate, __pyx_t_8, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_23 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_23 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_23) {
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line266")'> 266: 				correct_propensity = lambda: rate</pre>
<pre id='line266' class='code' style='background-color: #FFFF66'>
/* "libchemicalstring_2.pyx":266
 * 			valid = validator_constant
 * 			if rate > propensity_minimum:
 * 				correct_propensity = lambda: rate             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 			else: correct_propensity = lambda: 0.0
 */

static PyObject *__pyx_lambda_funcdef_lambda1(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("lambda1", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct__generate_reaction *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope->__pyx_v_rate)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("rate");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_rate);
  __pyx_r = __pyx_cur_scope->__pyx_v_rate;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction.lambda1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_23lambda2(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17generate_reaction_23lambda2 = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("lambda2"), (PyCFunction)__pyx_pw_14stringchemical_17generate_reaction_23lambda2, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17generate_reaction_23lambda2(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("lambda2 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda2(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

        /* "libchemicalstring_2.pyx":266
 * 			valid = validator_constant
 * 			if rate > propensity_minimum:
 * 				correct_propensity = lambda: rate             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 			else: correct_propensity = lambda: 0.0
 */
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17generate_reaction_22lambda1, 0, __pyx_n_s_58, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_v_correct_propensity = __pyx_t_1;
        __pyx_t_1 = 0;
        goto __pyx_L50;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line267")'> 267: </pre>
<pre id='line267' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line268")'> 268: 			else: correct_propensity = lambda: 0.0</pre>
<pre id='line268' class='code' style='background-color: #FFFF6e'>
/* "libchemicalstring_2.pyx":268
 * 				correct_propensity = lambda: rate
 * 
 * 			else: correct_propensity = lambda: 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		else:
 */

static PyObject *__pyx_lambda_funcdef_lambda2(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("lambda2", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction.lambda2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

        /* "libchemicalstring_2.pyx":268
 * 				correct_propensity = lambda: rate
 * 
 * 			else: correct_propensity = lambda: 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		else:
 */
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17generate_reaction_23lambda2, 0, __pyx_n_s_58, NULL, __pyx_n_s__stringchemical, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_v_correct_propensity = __pyx_t_1;
        __pyx_t_1 = 0;
      }
      __pyx_L50:;
      goto __pyx_L49;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line269")'> 269: </pre>
<pre id='line269' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line270")'> 270: 		else:</pre>
<pre id='line270' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line271")'> 271: 			valid = validator</pre>
<pre id='line271' class='code' style='background-color: #FFFFe7'>
      /* "libchemicalstring_2.pyx":271
 * 
 * 		else:
 * 			valid = validator             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			if only_one_reagent and single_stochios:
 * 				correct_propensity = propensity_very_simple
 */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_validator);
      __pyx_v_valid = __pyx_v_validator;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line272")'> 272: 			if only_one_reagent and single_stochios:</pre>
<pre id='line272' class='code' style='background-color: #FFFFff'>
      /* "libchemicalstring_2.pyx":272
 * 		else:
 * 			valid = validator
 * 			if only_one_reagent and single_stochios:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				correct_propensity = propensity_very_simple
 * 
 */
      if ((__pyx_v_only_one_reagent != 0)) {
        __pyx_t_23 = (__pyx_v_single_stochios != 0);
      } else {
        __pyx_t_23 = (__pyx_v_only_one_reagent != 0);
      }
      if (__pyx_t_23) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line273")'> 273: 				correct_propensity = propensity_very_simple</pre>
<pre id='line273' class='code' style='background-color: #FFFFe7'>
        /* "libchemicalstring_2.pyx":273
 * 			valid = validator
 * 			if only_one_reagent and single_stochios:
 * 				correct_propensity = propensity_very_simple             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 			elif single_stochios: correct_propensity = propensity_simple
 */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_propensity_very_simple);
        __pyx_v_correct_propensity = __pyx_v_propensity_very_simple;
        goto __pyx_L51;
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line274")'> 274: </pre>
<pre id='line274' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line275")'> 275: 			elif single_stochios: correct_propensity = propensity_simple</pre>
<pre id='line275' class='code' style='background-color: #FFFFe7'>
      /* "libchemicalstring_2.pyx":275
 * 				correct_propensity = propensity_very_simple
 * 
 * 			elif single_stochios: correct_propensity = propensity_simple             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			else: correct_propensity = propensity
 * 
 */
      __pyx_t_23 = (__pyx_v_single_stochios != 0);
      if (__pyx_t_23) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_propensity_simple);
        __pyx_v_correct_propensity = __pyx_v_propensity_simple;
        goto __pyx_L51;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line276")'> 276: 			else: correct_propensity = propensity</pre>
<pre id='line276' class='code' style='background-color: #FFFFe7'>
        /* "libchemicalstring_2.pyx":276
 * 
 * 			elif single_stochios: correct_propensity = propensity_simple
 * 			else: correct_propensity = propensity             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	else:
 */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_propensity);
        __pyx_v_correct_propensity = __pyx_v_propensity;
      }
      __pyx_L51:;
    }
    __pyx_L49:;
    goto __pyx_L48;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line277")'> 277: </pre>
<pre id='line277' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line278")'> 278: 	else:</pre>
<pre id='line278' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line279")'> 279: 		if not has_reagents:</pre>
<pre id='line279' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":279
 * 
 * 	else:
 * 		if not has_reagents:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			valid = validator_constant
 * 			correct_propensity = propensity_simplest_with_rate_call
 */
    __pyx_t_23 = ((!(__pyx_v_has_reagents != 0)) != 0);
    if (__pyx_t_23) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line280")'> 280: 			valid = validator_constant</pre>
<pre id='line280' class='code' style='background-color: #FFFFe7'>
      /* "libchemicalstring_2.pyx":280
 * 	else:
 * 		if not has_reagents:
 * 			valid = validator_constant             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			correct_propensity = propensity_simplest_with_rate_call
 * 
 */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_validator_constant);
      __pyx_v_valid = __pyx_v_validator_constant;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line281")'> 281: 			correct_propensity = propensity_simplest_with_rate_call</pre>
<pre id='line281' class='code' style='background-color: #FFFFe7'>
      /* "libchemicalstring_2.pyx":281
 * 		if not has_reagents:
 * 			valid = validator_constant
 * 			correct_propensity = propensity_simplest_with_rate_call             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		else:
 */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_propensity_simplest_with_rate_call);
      __pyx_v_correct_propensity = __pyx_v_propensity_simplest_with_rate_call;
      goto __pyx_L52;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line282")'> 282: </pre>
<pre id='line282' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line283")'> 283: 		else:</pre>
<pre id='line283' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line284")'> 284: 			valid = validator</pre>
<pre id='line284' class='code' style='background-color: #FFFFe7'>
      /* "libchemicalstring_2.pyx":284
 * 
 * 		else:
 * 			valid = validator             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			if only_one_reagent and single_stochios:
 * 				correct_propensity = propensity_very_simple_with_rate_call
 */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_validator);
      __pyx_v_valid = __pyx_v_validator;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line285")'> 285: 			if only_one_reagent and single_stochios:</pre>
<pre id='line285' class='code' style='background-color: #FFFFff'>
      /* "libchemicalstring_2.pyx":285
 * 		else:
 * 			valid = validator
 * 			if only_one_reagent and single_stochios:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				correct_propensity = propensity_very_simple_with_rate_call
 * 
 */
      if ((__pyx_v_only_one_reagent != 0)) {
        __pyx_t_23 = (__pyx_v_single_stochios != 0);
      } else {
        __pyx_t_23 = (__pyx_v_only_one_reagent != 0);
      }
      if (__pyx_t_23) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line286")'> 286: 				correct_propensity = propensity_very_simple_with_rate_call</pre>
<pre id='line286' class='code' style='background-color: #FFFFe7'>
        /* "libchemicalstring_2.pyx":286
 * 			valid = validator
 * 			if only_one_reagent and single_stochios:
 * 				correct_propensity = propensity_very_simple_with_rate_call             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 			elif single_stochios:
 */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_propensity_very_simple_with_rate_call);
        __pyx_v_correct_propensity = __pyx_v_propensity_very_simple_with_rate_call;
        goto __pyx_L53;
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line287")'> 287: </pre>
<pre id='line287' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line288")'> 288: 			elif single_stochios:</pre>
<pre id='line288' class='code' style='background-color: #FFFFff'>
      /* "libchemicalstring_2.pyx":288
 * 				correct_propensity = propensity_very_simple_with_rate_call
 * 
 * 			elif single_stochios:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				correct_propensity = propensity_simple_with_rate_call
 * 
 */
      __pyx_t_23 = (__pyx_v_single_stochios != 0);
      if (__pyx_t_23) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line289")'> 289: 				correct_propensity = propensity_simple_with_rate_call</pre>
<pre id='line289' class='code' style='background-color: #FFFFe7'>
        /* "libchemicalstring_2.pyx":289
 * 
 * 			elif single_stochios:
 * 				correct_propensity = propensity_simple_with_rate_call             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 			else: correct_propensity = propensity_with_rate_call
 */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_propensity_simple_with_rate_call);
        __pyx_v_correct_propensity = __pyx_v_propensity_simple_with_rate_call;
        goto __pyx_L53;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line290")'> 290: </pre>
<pre id='line290' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line291")'> 291: 			else: correct_propensity = propensity_with_rate_call</pre>
<pre id='line291' class='code' style='background-color: #FFFFe7'>
        /* "libchemicalstring_2.pyx":291
 * 				correct_propensity = propensity_simple_with_rate_call
 * 
 * 			else: correct_propensity = propensity_with_rate_call             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	return correct_propensity, valid, reaction, reagents, products
 */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_propensity_with_rate_call);
        __pyx_v_correct_propensity = __pyx_v_propensity_with_rate_call;
      }
      __pyx_L53:;
    }
    __pyx_L52:;
  }
  __pyx_L48:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line292")'> 292: </pre>
<pre id='line292' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line293")'> 293: 	return correct_propensity, valid, reaction, reagents, products</pre>
<pre id='line293' class='code' style='background-color: #FFFF2b'>
  /* "libchemicalstring_2.pyx":293
 * 			else: correct_propensity = propensity_with_rate_call
 * 
 * 	return correct_propensity, valid, reaction, reagents, products             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_correct_propensity);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_correct_propensity);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_correct_propensity);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_valid);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_valid);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_valid);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_reaction);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_v_reaction);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_reaction);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_cur_scope->__pyx_v_reagents));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, ((PyObject *)__pyx_cur_scope->__pyx_v_reagents));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_cur_scope->__pyx_v_reagents));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_cur_scope->__pyx_v_products));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, ((PyObject *)__pyx_cur_scope->__pyx_v_products));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_cur_scope->__pyx_v_products));
  __pyx_r = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_reaction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_propensity_with_rate_call);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_propensity_simple_with_rate_call);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_propensity_very_simple_with_rate_call);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_propensity_simplest_with_rate_call);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_propensity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_propensity_simple);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_propensity_very_simple);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_validator_constant);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_validator);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_reaction);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_measure_agent);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_split);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_func_dex);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_var_dex);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_valid);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_correct_propensity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cnt);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line294")'> 294: </pre>
<pre id='line294' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line295")'> 295: </pre>
<pre id='line295' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line296")'> 296: </pre>
<pre id='line296' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line297")'> 297: #return a sequence identical to seq but with no duplicates</pre>
<pre id='line297' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line298")'> 298: cdef uniq(seq):</pre>
<pre id='line298' class='code' style='background-color: #FFFFff'>
/* "libchemicalstring_2.pyx":298
 * 
 * #return a sequence identical to seq but with no duplicates
 * cdef uniq(seq):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	seen = {}
 * 	result = []
 */

static PyObject *__pyx_f_14stringchemical_uniq(PyObject *__pyx_v_seq) {
  PyObject *__pyx_v_seen = NULL;
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_item = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("uniq", 0);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line299")'> 299: 	seen = {}</pre>
<pre id='line299' class='code' style='background-color: #FFFFaa'>
  /* "libchemicalstring_2.pyx":299
 * #return a sequence identical to seq but with no duplicates
 * cdef uniq(seq):
 * 	seen = {}             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	result = []
 * 	for item in seq:
 */
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  __pyx_v_seen = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line300")'> 300: 	result = []</pre>
<pre id='line300' class='code' style='background-color: #FFFFaa'>
  /* "libchemicalstring_2.pyx":300
 * cdef uniq(seq):
 * 	seen = {}
 * 	result = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	for item in seq:
 * 		if item in seen: continue
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_result = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line301")'> 301: 	for item in seq:</pre>
<pre id='line301' class='code' style='background-color: #FFFF2a'>
  /* "libchemicalstring_2.pyx":301
 * 	seen = {}
 * 	result = []
 * 	for item in seq:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if item in seen: continue
 * 		seen[item] = 1
 */
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_seq) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_seq)) {
    __pyx_t_1 = __pyx_v_seq; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_seq);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_3 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_3 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_item);
    __pyx_v_item = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line302")'> 302: 		if item in seen: continue</pre>
<pre id='line302' class='code' style='background-color: #FFFFaa'>
    /* "libchemicalstring_2.pyx":302
 * 	result = []
 * 	for item in seq:
 * 		if item in seen: continue             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		seen[item] = 1
 * 		result.append(item)
 */
    __pyx_t_5 = (__Pyx_<span class='py_c_api'>PyDict_Contains</span>(__pyx_v_item, ((PyObject *)__pyx_v_seen), Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {
      goto __pyx_L3_continue;
      goto __pyx_L5;
    }
    __pyx_L5:;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line303")'> 303: 		seen[item] = 1</pre>
<pre id='line303' class='code' style='background-color: #FFFFaa'>
    /* "libchemicalstring_2.pyx":303
 * 	for item in seq:
 * 		if item in seen: continue
 * 		seen[item] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		result.append(item)
 * 
 */
    if (<span class='py_c_api'>PyDict_SetItem</span>(((PyObject *)__pyx_v_seen), __pyx_v_item, __pyx_int_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line304")'> 304: 		result.append(item)</pre>
<pre id='line304' class='code' style='background-color: #FFFF9f'>
    /* "libchemicalstring_2.pyx":304
 * 		if item in seen: continue
 * 		seen[item] = 1
 * 		result.append(item)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	return result
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_result, __pyx_v_item);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L3_continue:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line305")'> 305: </pre>
<pre id='line305' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line306")'> 306: 	return result</pre>
<pre id='line306' class='code' style='background-color: #FFFF1c'>
  /* "libchemicalstring_2.pyx":306
 * 		result.append(item)
 * 
 * 	return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  __pyx_r = ((PyObject *)__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.uniq", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_seen);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_item);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_3wrap_propensities(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_3wrap_propensities = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("wrap_propensities"), (PyCFunction)__pyx_pw_14stringchemical_3wrap_propensities, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_3wrap_propensities(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_propensity_table = 0;
  PyObject *__pyx_v_propensities = 0;
  PyObject *__pyx_v_reagents = 0;
  PyObject *__pyx_v_products = 0;
  PyObject *__pyx_v_rate_call_group = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("wrap_propensities (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__propensity_table,&__pyx_n_s__propensities,&__pyx_n_s__reagents,&__pyx_n_s__products,&__pyx_n_s__rate_call_group,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__propensity_table)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__propensities)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("wrap_propensities", 1, 5, 5, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__reagents)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("wrap_propensities", 1, 5, 5, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__products)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("wrap_propensities", 1, 5, 5, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__rate_call_group)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("wrap_propensities", 1, 5, 5, 4);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "wrap_propensities") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_propensity_table = values[0];
    __pyx_v_propensities = values[1];
    __pyx_v_reagents = values[2];
    __pyx_v_products = values[3];
    __pyx_v_rate_call_group = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("wrap_propensities", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.wrap_propensities", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_2wrap_propensities(__pyx_self, __pyx_v_propensity_table, __pyx_v_propensities, __pyx_v_reagents, __pyx_v_products, __pyx_v_rate_call_group);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17wrap_propensities_1generate_wrap(PyObject *__pyx_self, PyObject *__pyx_v_lookup); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17wrap_propensities_1generate_wrap = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("generate_wrap"), (PyCFunction)__pyx_pw_14stringchemical_17wrap_propensities_1generate_wrap, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17wrap_propensities_1generate_wrap(PyObject *__pyx_self, PyObject *__pyx_v_lookup) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_wrap (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_17wrap_propensities_generate_wrap(__pyx_self, ((PyObject *)__pyx_v_lookup));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17wrap_propensities_13generate_wrap_1propensity_wrap(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17wrap_propensities_13generate_wrap_1propensity_wrap = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("propensity_wrap"), (PyCFunction)__pyx_pw_14stringchemical_17wrap_propensities_13generate_wrap_1propensity_wrap, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17wrap_propensities_13generate_wrap_1propensity_wrap(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_wrap (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_17wrap_propensities_13generate_wrap_propensity_wrap(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line307")'> 307: </pre>
<pre id='line307' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line308")'> 308: </pre>
<pre id='line308' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line309")'> 309: </pre>
<pre id='line309' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line310")'> 310: #propensity functions are replaced with functions which instead</pre>
<pre id='line310' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line311")'> 311: # update the dependant propensity functions based on reactions</pre>
<pre id='line311' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line312")'> 312: def wrap_propensities(propensity_table, propensities,</pre>
<pre id='line312' class='code' style='background-color: #FFFF57'>
/* "libchemicalstring_2.pyx":312
 * #propensity functions are replaced with functions which instead
 * # update the dependant propensity functions based on reactions
 * def wrap_propensities(propensity_table, propensities,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				reagents, products, rate_call_group):
 * 
 */

static PyObject *__pyx_pf_14stringchemical_2wrap_propensities(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_propensity_table, PyObject *__pyx_v_propensities, PyObject *__pyx_v_reagents, PyObject *__pyx_v_products, PyObject *__pyx_v_rate_call_group) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_1_wrap_propensities *__pyx_cur_scope;
  PyObject *__pyx_v_generate_wrap = 0;
  PyObject *__pyx_v_alwayses = NULL;
  PyObject *__pyx_v_propensity_lookups = NULL;
  PyObject *__pyx_v_dex = NULL;
  PyObject *__pyx_v_current = NULL;
  PyObject *__pyx_v_dex2 = NULL;
  PyObject *__pyx_v_temporary = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_prop = NULL;
  PyObject *__pyx_v_agent = NULL;
  PyObject *__pyx_v_lookup = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("wrap_propensities", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_1_wrap_propensities *)__pyx_tp_new_14stringchemical___pyx_scope_struct_1_wrap_propensities(__pyx_ptype_14stringchemical___pyx_scope_struct_1_wrap_propensities, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_propensity_table = __pyx_v_propensity_table;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_propensity_table);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_propensity_table);
  __pyx_cur_scope->__pyx_v_propensities = __pyx_v_propensities;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_propensities);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_propensities);

  /* "libchemicalstring_2.pyx":312
 * #propensity functions are replaced with functions which instead
 * # update the dependant propensity functions based on reactions
 * def wrap_propensities(propensity_table, propensities,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				reagents, products, rate_call_group):
 * 
 */
  __pyx_k_tuple_191 = <span class='py_c_api'>PyTuple_Pack</span>(16, ((PyObject *)__pyx_n_s__propensity_table), ((PyObject *)__pyx_n_s__propensities), ((PyObject *)__pyx_n_s__reagents), ((PyObject *)__pyx_n_s__products), ((PyObject *)__pyx_n_s__rate_call_group), ((PyObject *)__pyx_n_s__generate_wrap), ((PyObject *)__pyx_n_s__generate_wrap), ((PyObject *)__pyx_n_s__alwayses), ((PyObject *)__pyx_n_s__propensity_lookups), ((PyObject *)__pyx_n_s__dex), ((PyObject *)__pyx_n_s__current), ((PyObject *)__pyx_n_s__dex2), ((PyObject *)__pyx_n_s__temporary), ((PyObject *)__pyx_n_s__prop), ((PyObject *)__pyx_n_s__agent), ((PyObject *)__pyx_n_s__lookup));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_191)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_191);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_191));

  /* "libchemicalstring_2.pyx":312
 * #propensity functions are replaced with functions which instead
 * # update the dependant propensity functions based on reactions
 * def wrap_propensities(propensity_table, propensities,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				reagents, products, rate_call_group):
 * 
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_3wrap_propensities, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__wrap_propensities, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_192 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(5, 0, 16, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_191, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__wrap_propensities, 312, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_192)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":312
 * #propensity functions are replaced with functions which instead
 * # update the dependant propensity functions based on reactions
 * def wrap_propensities(propensity_table, propensities,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				reagents, products, rate_call_group):
 * 
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_1_wrap_propensities {
  PyObject_HEAD
  PyObject *__pyx_v_propensities;
  PyObject *__pyx_v_propensity_table;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line313")'> 313: 				reagents, products, rate_call_group):</pre>
<pre id='line313' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line314")'> 314: </pre>
<pre id='line314' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line315")'> 315: 	def generate_wrap(lookup):</pre>
<pre id='line315' class='code' style='background-color: #FFFF5e'>
/* "libchemicalstring_2.pyx":315
 * 				reagents, products, rate_call_group):
 * 
 * 	def generate_wrap(lookup):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		def propensity_wrap():
 */

static PyObject *__pyx_pf_14stringchemical_17wrap_propensities_generate_wrap(PyObject *__pyx_self, PyObject *__pyx_v_lookup) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_2_generate_wrap *__pyx_cur_scope;
  PyObject *__pyx_v_propensity_wrap = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_wrap", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_2_generate_wrap *)__pyx_tp_new_14stringchemical___pyx_scope_struct_2_generate_wrap(__pyx_ptype_14stringchemical___pyx_scope_struct_2_generate_wrap, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_1_wrap_propensities *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_outer_scope);
  __pyx_cur_scope->__pyx_v_lookup = __pyx_v_lookup;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_lookup);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_lookup);

  /* "libchemicalstring_2.pyx":315
 * 				reagents, products, rate_call_group):
 * 
 * 	def generate_wrap(lookup):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		def propensity_wrap():
 */
  __pyx_k_tuple_62 = <span class='py_c_api'>PyTuple_Pack</span>(4, ((PyObject *)__pyx_n_s__lookup), ((PyObject *)__pyx_n_s__propensity_wrap), ((PyObject *)__pyx_n_s__propensity_wrap), ((PyObject *)__pyx_n_s__leng));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_62)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_62);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_62));

  /* "libchemicalstring_2.pyx":315
 * 				reagents, products, rate_call_group):
 * 
 * 	def generate_wrap(lookup):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		def propensity_wrap():
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17wrap_propensities_1generate_wrap, 0, __pyx_n_s_64, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_63));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_generate_wrap = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_63 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(1, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_62, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__generate_wrap, 315, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_63)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":315
 * 				reagents, products, rate_call_group):
 * 
 * 	def generate_wrap(lookup):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		def propensity_wrap():
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_2_generate_wrap {
  PyObject_HEAD
  struct __pyx_obj_14stringchemical___pyx_scope_struct_1_wrap_propensities *__pyx_outer_scope;
  int __pyx_v_leng;
  PyObject *__pyx_v_lookup;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line316")'> 316: </pre>
<pre id='line316' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line317")'> 317: 		def propensity_wrap():</pre>
<pre id='line317' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":317
 * 	def generate_wrap(lookup):
 * 
 * 		def propensity_wrap():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			cdef int dex
 * 			cdef int sub_dex
 */

static PyObject *__pyx_pf_14stringchemical_17wrap_propensities_13generate_wrap_propensity_wrap(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_2_generate_wrap *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct_2_generate_wrap *__pyx_outer_scope;
  int __pyx_v_dex;
  int __pyx_v_sub_dex;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("propensity_wrap", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_2_generate_wrap *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":317
 * 	def generate_wrap(lookup):
 * 
 * 		def propensity_wrap():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			cdef int dex
 * 			cdef int sub_dex
 */
  __pyx_k_tuple_59 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject *)__pyx_n_s__dex), ((PyObject *)__pyx_n_s__sub_dex));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_59)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_59);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_59));

  /* "libchemicalstring_2.pyx":317
 * 	def generate_wrap(lookup):
 * 
 * 		def propensity_wrap():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			cdef int dex
 * 			cdef int sub_dex
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_17wrap_propensities_13generate_wrap_1propensity_wrap, 0, __pyx_n_s_61, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_60));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_propensity_wrap = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_60 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_59, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__propensity_wrap, 317, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_60)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line318")'> 318: 			cdef int dex</pre>
<pre id='line318' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line319")'> 319: 			cdef int sub_dex</pre>
<pre id='line319' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line320")'> 320: 			for dex in range(leng):</pre>
<pre id='line320' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":320
 * 			cdef int dex
 * 			cdef int sub_dex
 * 			for dex in range(leng):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				sub_dex = lookup[dex]
 * 				propensity_table[sub_dex] = propensities[sub_dex]()
 */
  __pyx_t_1 = __pyx_cur_scope->__pyx_v_leng;
  for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_dex = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line321")'> 321: 				sub_dex = lookup[dex]</pre>
<pre id='line321' class='code' style='background-color: #FFFF66'>
    /* "libchemicalstring_2.pyx":321
 * 			cdef int sub_dex
 * 			for dex in range(leng):
 * 				sub_dex = lookup[dex]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				propensity_table[sub_dex] = propensities[sub_dex]()
 * 
 */
    if (unlikely(!__pyx_cur_scope->__pyx_v_lookup)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("lookup");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_lookup, __pyx_v_dex, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_sub_dex = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line322")'> 322: 				propensity_table[sub_dex] = propensities[sub_dex]()</pre>
<pre id='line322' class='code' style='background-color: #FFFF52'>
    /* "libchemicalstring_2.pyx":322
 * 			for dex in range(leng):
 * 				sub_dex = lookup[dex]
 * 				propensity_table[sub_dex] = propensities[sub_dex]()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		cdef int leng = len(lookup)
 */
    if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_propensities)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("propensities");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_propensities, __pyx_v_sub_dex, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_propensity_table)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("propensity_table");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_propensity_table, __pyx_v_sub_dex, __pyx_t_5, sizeof(int), PyInt_FromLong, 0, 1, 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.wrap_propensities.generate_wrap.propensity_wrap", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line323")'> 323: </pre>
<pre id='line323' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line324")'> 324: 		cdef int leng = len(lookup)</pre>
<pre id='line324' class='code' style='background-color: #FFFF96'>
  /* "libchemicalstring_2.pyx":324
 * 				propensity_table[sub_dex] = propensities[sub_dex]()
 * 
 * 		cdef int leng = len(lookup)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return propensity_wrap
 * 
 */
  __pyx_t_1 = __pyx_cur_scope->__pyx_v_lookup;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_cur_scope->__pyx_v_leng = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line325")'> 325: 		return propensity_wrap</pre>
<pre id='line325' class='code' style='background-color: #FFFF86'>
  /* "libchemicalstring_2.pyx":325
 * 
 * 		cdef int leng = len(lookup)
 * 		return propensity_wrap             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#if any reactions propensity depends on say time, it must be appended
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_propensity_wrap);
  __pyx_r = __pyx_v_propensity_wrap;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.wrap_propensities.generate_wrap", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_propensity_wrap);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line326")'> 326: </pre>
<pre id='line326' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line327")'> 327: 	#if any reactions propensity depends on say time, it must be appended</pre>
<pre id='line327' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line328")'> 328: 	#	to every lookup</pre>
<pre id='line328' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line329")'> 329: 	#		alwayses should consist of the indexes of every propensity</pre>
<pre id='line329' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line330")'> 330: 	#			which requires a rate call</pre>
<pre id='line330' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line331")'> 331: 	alwayses = [dex for dex in range(len(rate_call_group))</pre>
<pre id='line331' class='code' style='background-color: #FFFF1c'>
  /* "libchemicalstring_2.pyx":331
 * 	#		alwayses should consist of the indexes of every propensity
 * 	#			which requires a rate call
 * 	alwayses = [dex for dex in range(len(rate_call_group))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 								if rate_call_group[dex]]
 * 	propensity_lookups = [[] for prop in propensities]
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_rate_call_group);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_4 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = Py_TYPE(__pyx_t_4)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (!__pyx_t_5 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_5 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex);
    __pyx_v_dex = __pyx_t_3;
    __pyx_t_3 = 0;

      /* "libchemicalstring_2.pyx":331
 * 	#		alwayses should consist of the indexes of every propensity
 * 	#			which requires a rate call
 * 	alwayses = [dex for dex in range(len(rate_call_group))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 								if rate_call_group[dex]]
 * 	propensity_lookups = [[] for prop in propensities]
 */
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_v_dex)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_alwayses = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line332")'> 332: 								if rate_call_group[dex]]</pre>
<pre id='line332' class='code' style='background-color: #FFFF79'>
    /* "libchemicalstring_2.pyx":332
 * 	#			which requires a rate call
 * 	alwayses = [dex for dex in range(len(rate_call_group))
 * 								if rate_call_group[dex]]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	propensity_lookups = [[] for prop in propensities]
 * 	for dex in range(len(reagents)):
 */
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_rate_call_group, __pyx_v_dex);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_6 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line333")'> 333: 	propensity_lookups = [[] for prop in propensities]</pre>
<pre id='line333' class='code' style='background-color: #FFFF22'>
  /* "libchemicalstring_2.pyx":333
 * 	alwayses = [dex for dex in range(len(rate_call_group))
 * 								if rate_call_group[dex]]
 * 	propensity_lookups = [[] for prop in propensities]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	for dex in range(len(reagents)):
 * 		current = set([agent[1] for agent in products[dex]])
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_cur_scope->__pyx_v_propensities) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_cur_scope->__pyx_v_propensities)) {
    __pyx_t_4 = __pyx_cur_scope->__pyx_v_propensities; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_cur_scope->__pyx_v_propensities);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = Py_TYPE(__pyx_t_4)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_5 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_5 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_prop);
    __pyx_v_prop = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_3)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_propensity_lookups = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line334")'> 334: 	for dex in range(len(reagents)):</pre>
<pre id='line334' class='code' style='background-color: #FFFF1e'>
  /* "libchemicalstring_2.pyx":334
 * 								if rate_call_group[dex]]
 * 	propensity_lookups = [[] for prop in propensities]
 * 	for dex in range(len(reagents)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		current = set([agent[1] for agent in products[dex]])
 * 		for dex2 in range(len(reagents)):
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_reagents);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_4 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = Py_TYPE(__pyx_t_4)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (!__pyx_t_5 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_5 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_1 = __pyx_t_5(__pyx_t_4);
      if (unlikely(!__pyx_t_1)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex);
    __pyx_v_dex = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line335")'> 335: 		current = set([agent[1] for agent in products[dex]])</pre>
<pre id='line335' class='code' style='background-color: #FFFF1c'>
    /* "libchemicalstring_2.pyx":335
 * 	propensity_lookups = [[] for prop in propensities]
 * 	for dex in range(len(reagents)):
 * 		current = set([agent[1] for agent in products[dex]])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		for dex2 in range(len(reagents)):
 * 			temporary = set([agent[1] for agent in reagents[dex2]])
 */
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_products, __pyx_v_dex);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      __pyx_t_7 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_9 = Py_TYPE(__pyx_t_7)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    for (;;) {
      if (!__pyx_t_9 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7)) {
        if (__pyx_t_8 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_7, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_8++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_9 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7)) {
        if (__pyx_t_8 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_7, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_8++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_3 = __pyx_t_9(__pyx_t_7);
        if (unlikely(!__pyx_t_3)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
      __pyx_v_agent = __pyx_t_3;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_agent, 1, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_3)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, ((PyObject *)__pyx_t_1));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PySet_Type))), ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_current));
    __pyx_v_current = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line336")'> 336: 		for dex2 in range(len(reagents)):</pre>
<pre id='line336' class='code' style='background-color: #FFFF1e'>
    /* "libchemicalstring_2.pyx":336
 * 	for dex in range(len(reagents)):
 * 		current = set([agent[1] for agent in products[dex]])
 * 		for dex2 in range(len(reagents)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			temporary = set([agent[1] for agent in reagents[dex2]])
 * 			if temporary & current:
 */
    __pyx_t_8 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_reagents);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_7 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_9 = Py_TYPE(__pyx_t_7)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (!__pyx_t_9 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7)) {
        if (__pyx_t_8 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_7, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_9 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7)) {
        if (__pyx_t_8 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_7, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_1 = __pyx_t_9(__pyx_t_7);
        if (unlikely(!__pyx_t_1)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex2);
      __pyx_v_dex2 = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line337")'> 337: 			temporary = set([agent[1] for agent in reagents[dex2]])</pre>
<pre id='line337' class='code' style='background-color: #FFFF1c'>
      /* "libchemicalstring_2.pyx":337
 * 		current = set([agent[1] for agent in products[dex]])
 * 		for dex2 in range(len(reagents)):
 * 			temporary = set([agent[1] for agent in reagents[dex2]])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			if temporary & current:
 * 				propensity_lookups[dex].append(dex2)
 */
      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_reagents, __pyx_v_dex2);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
        __pyx_t_10 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10); __pyx_t_11 = 0;
        __pyx_t_12 = NULL;
      } else {
        __pyx_t_11 = -1; __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        __pyx_t_12 = Py_TYPE(__pyx_t_10)->tp_iternext;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      for (;;) {
        if (!__pyx_t_12 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_10)) {
          if (__pyx_t_11 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_10)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_10, __pyx_t_11); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_11++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_10, __pyx_t_11); __pyx_t_11++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else if (!__pyx_t_12 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_10)) {
          if (__pyx_t_11 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_10)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_10, __pyx_t_11); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_11++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_10, __pyx_t_11); __pyx_t_11++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else {
          __pyx_t_3 = __pyx_t_12(__pyx_t_10);
          if (unlikely(!__pyx_t_3)) {
            if (<span class='py_c_api'>PyErr_Occurred</span>()) {
              if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            break;
          }
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
        __pyx_v_agent = __pyx_t_3;
        __pyx_t_3 = 0;
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_agent, 1, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_3)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, ((PyObject *)__pyx_t_1));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_1));
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PySet_Type))), ((PyObject *)__pyx_t_10), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_temporary));
      __pyx_v_temporary = ((PyObject*)__pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line338")'> 338: 			if temporary &amp; current:</pre>
<pre id='line338' class='code' style='background-color: #FFFF79'>
      /* "libchemicalstring_2.pyx":338
 * 		for dex2 in range(len(reagents)):
 * 			temporary = set([agent[1] for agent in reagents[dex2]])
 * 			if temporary & current:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				propensity_lookups[dex].append(dex2)
 * 
 */
      __pyx_t_1 = <span class='py_c_api'>PyNumber_And</span>(((PyObject *)__pyx_v_temporary), ((PyObject *)__pyx_v_current));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
      __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(__pyx_t_6 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line339")'> 339: 				propensity_lookups[dex].append(dex2)</pre>
<pre id='line339' class='code' style='background-color: #FFFF6e'>
        /* "libchemicalstring_2.pyx":339
 * 			temporary = set([agent[1] for agent in reagents[dex2]])
 * 			if temporary & current:
 * 				propensity_lookups[dex].append(dex2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		propensity_lookups[dex].extend(alwayses)
 */
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_propensity_lookups), __pyx_v_dex);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_10 = __Pyx_<span class='py_c_api'>PyObject_Append</span>(__pyx_t_1, __pyx_v_dex2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        goto __pyx_L16;
      }
      __pyx_L16:;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line340")'> 340: </pre>
<pre id='line340' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line341")'> 341: 		propensity_lookups[dex].extend(alwayses)</pre>
<pre id='line341' class='code' style='background-color: #FFFF44'>
    /* "libchemicalstring_2.pyx":341
 * 				propensity_lookups[dex].append(dex2)
 * 
 * 		propensity_lookups[dex].extend(alwayses)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	propensity_lookups = [uniq(lookup) for lookup in propensity_lookups]
 */
    __pyx_t_7 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_propensity_lookups), __pyx_v_dex);<span class='error_goto'> if (!__pyx_t_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    __pyx_t_10 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s__extend);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_alwayses));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, ((PyObject *)__pyx_v_alwayses));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_alwayses));
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_10, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line342")'> 342: </pre>
<pre id='line342' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line343")'> 343: 	propensity_lookups = [uniq(lookup) for lookup in propensity_lookups]</pre>
<pre id='line343' class='code' style='background-color: #FFFF62'>
  /* "libchemicalstring_2.pyx":343
 * 		propensity_lookups[dex].extend(alwayses)
 * 
 * 	propensity_lookups = [uniq(lookup) for lookup in propensity_lookups]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return [generate_wrap(lookup) for lookup in propensity_lookups]
 * 
 */
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_1 = ((PyObject *)__pyx_v_propensity_lookups); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lookup);
    __pyx_v_lookup = __pyx_t_7;
    __pyx_t_7 = 0;
    __pyx_t_7 = __pyx_f_14stringchemical_uniq(__pyx_v_lookup);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_4, (PyObject*)__pyx_t_7)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_propensity_lookups));
  __pyx_v_propensity_lookups = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF1b' onclick='toggleDiv("line344")'> 344: 	return [generate_wrap(lookup) for lookup in propensity_lookups]</pre>
<pre id='line344' class='code' style='background-color: #FFFF1b'>
  /* "libchemicalstring_2.pyx":344
 * 
 * 	propensity_lookups = [uniq(lookup) for lookup in propensity_lookups]
 * 	return [generate_wrap(lookup) for lookup in propensity_lookups]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_1 = ((PyObject *)__pyx_v_propensity_lookups); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lookup);
    __pyx_v_lookup = __pyx_t_7;
    __pyx_t_7 = 0;
    __pyx_t_7 = __pyx_pf_14stringchemical_17wrap_propensities_generate_wrap(__pyx_v_generate_wrap, __pyx_v_lookup);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_4, (PyObject*)__pyx_t_7)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = ((PyObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.wrap_propensities", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_generate_wrap);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_alwayses);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_propensity_lookups);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_current);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_temporary);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_prop);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_agent);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lookup);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_5generate_functions(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_5generate_functions = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("generate_functions"), (PyCFunction)__pyx_pw_14stringchemical_5generate_functions, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_5generate_functions(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_functions = 0;
  PyObject *__pyx_v_count_targets = 0;
  PyObject *__pyx_v_counts = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_functions (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__functions,&__pyx_n_s__count_targets,&__pyx_n_s__counts,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__functions)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__count_targets)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_functions", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__counts)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_functions", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "generate_functions") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_functions = values[0];
    __pyx_v_count_targets = values[1];
    __pyx_v_counts = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_functions", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_functions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_4generate_functions(__pyx_self, __pyx_v_functions, __pyx_v_count_targets, __pyx_v_counts);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_18generate_functions_1convert(PyObject *__pyx_self, PyObject *__pyx_v_substr); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_18generate_functions_1convert = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("convert"), (PyCFunction)__pyx_pw_14stringchemical_18generate_functions_1convert, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_18generate_functions_1convert(PyObject *__pyx_self, PyObject *__pyx_v_substr) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("convert (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_18generate_functions_convert(__pyx_self, ((PyObject *)__pyx_v_substr));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line345")'> 345: </pre>
<pre id='line345' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line346")'> 346: </pre>
<pre id='line346' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line347")'> 347: </pre>
<pre id='line347' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line348")'> 348: #turn function strings into compiled lambda functions</pre>
<pre id='line348' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line349")'> 349: def generate_functions(functions, count_targets, counts):</pre>
<pre id='line349' class='code' style='background-color: #FFFF5b'>
/* "libchemicalstring_2.pyx":349
 * 
 * #turn function strings into compiled lambda functions
 * def generate_functions(functions, count_targets, counts):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def convert(substr):
 */

static PyObject *__pyx_pf_14stringchemical_4generate_functions(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_functions, PyObject *__pyx_v_count_targets, PyObject *__pyx_v_counts) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_3_generate_functions *__pyx_cur_scope;
  PyObject *__pyx_v_encode = 0;
  PyObject *__pyx_v_func_names = NULL;
  PyObject *__pyx_v_encoded = NULL;
  PyObject *__pyx_v_funcs = NULL;
  PyObject *__pyx_v_fu = NULL;
  PyObject *__pyx_v_string = NULL;
  PyObject *__pyx_v_expr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_functions", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_3_generate_functions *)__pyx_tp_new_14stringchemical___pyx_scope_struct_3_generate_functions(__pyx_ptype_14stringchemical___pyx_scope_struct_3_generate_functions, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_count_targets = __pyx_v_count_targets;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_count_targets);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_count_targets);

  /* "libchemicalstring_2.pyx":349
 * 
 * #turn function strings into compiled lambda functions
 * def generate_functions(functions, count_targets, counts):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def convert(substr):
 */
  __pyx_k_tuple_193 = <span class='py_c_api'>PyTuple_Pack</span>(13, ((PyObject *)__pyx_n_s__functions), ((PyObject *)__pyx_n_s__count_targets), ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_n_s__convert), ((PyObject *)__pyx_n_s__convert), ((PyObject *)__pyx_n_s__encode), ((PyObject *)__pyx_n_s__encode), ((PyObject *)__pyx_n_s__func_names), ((PyObject *)__pyx_n_s__encoded), ((PyObject *)__pyx_n_s__funcs), ((PyObject *)__pyx_n_s__fu), ((PyObject *)__pyx_n_s__string), ((PyObject *)__pyx_n_s__expr));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_193)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_193);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_193));

  /* "libchemicalstring_2.pyx":349
 * 
 * #turn function strings into compiled lambda functions
 * def generate_functions(functions, count_targets, counts):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def convert(substr):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_5generate_functions, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__generate_functions, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_194 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(3, 0, 13, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_193, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__generate_functions, 349, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_194)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":349
 * 
 * #turn function strings into compiled lambda functions
 * def generate_functions(functions, count_targets, counts):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def convert(substr):
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_3_generate_functions {
  PyObject_HEAD
  PyObject *__pyx_v_convert;
  PyObject *__pyx_v_count_targets;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line350")'> 350: </pre>
<pre id='line350' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line351")'> 351: 	def convert(substr):</pre>
<pre id='line351' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":351
 * def generate_functions(functions, count_targets, counts):
 * 
 * 	def convert(substr):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if substr in count_targets:
 * 			return "".join(["counts[",
 */

static PyObject *__pyx_pf_14stringchemical_18generate_functions_convert(PyObject *__pyx_self, PyObject *__pyx_v_substr) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_3_generate_functions *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct_3_generate_functions *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("convert", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_3_generate_functions *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":351
 * def generate_functions(functions, count_targets, counts):
 * 
 * 	def convert(substr):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if substr in count_targets:
 * 			return "".join(["counts[",
 */
  __pyx_k_tuple_67 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_n_s__substr));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_67)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_67);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_67));

  /* "libchemicalstring_2.pyx":351
 * def generate_functions(functions, count_targets, counts):
 * 
 * 	def convert(substr):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if substr in count_targets:
 * 			return "".join(["counts[",
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_18generate_functions_1convert, 0, __pyx_n_s_69, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_68));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_cur_scope->__pyx_v_convert = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_68 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_67, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__convert, 351, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_68)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line352")'> 352: 		if substr in count_targets:</pre>
<pre id='line352' class='code' style='background-color: #FFFF96'>
  /* "libchemicalstring_2.pyx":352
 * 
 * 	def convert(substr):
 * 		if substr in count_targets:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			return "".join(["counts[",
 * 				str(count_targets.index(substr)), "]"])
 */
  if (unlikely(!__pyx_cur_scope->__pyx_v_count_targets)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("count_targets");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = (__Pyx_<span class='py_c_api'>PySequence_Contains</span>(__pyx_v_substr, __pyx_cur_scope->__pyx_v_count_targets, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_1 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line353")'> 353: 			return "".join(["counts[",</pre>
<pre id='line353' class='code' style='background-color: #FFFF9f'>
    /* "libchemicalstring_2.pyx":353
 * 	def convert(substr):
 * 		if substr in count_targets:
 * 			return "".join(["counts[",             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				str(count_targets.index(substr)), "]"])
 * 
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(((PyObject *)__pyx_kp_s_10), __pyx_n_s__join);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
</pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line354")'> 354: 				str(count_targets.index(substr)), "]"])</pre>
<pre id='line354' class='code' style='background-color: #FFFF27'>
    /* "libchemicalstring_2.pyx":354
 * 		if substr in count_targets:
 * 			return "".join(["counts[",
 * 				str(count_targets.index(substr)), "]"])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		else: return substr
 */
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_cur_scope->__pyx_v_count_targets, __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_substr);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_substr);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_substr);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_65));
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, ((PyObject *)__pyx_kp_s_65));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_65));
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_6);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_66));
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, ((PyObject *)__pyx_kp_s_66));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_66));
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, ((PyObject *)__pyx_t_5));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_5));
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line355")'> 355: </pre>
<pre id='line355' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line356")'> 356: 		else: return substr</pre>
<pre id='line356' class='code' style='background-color: #FFFF6e'>
    /* "libchemicalstring_2.pyx":356
 * 				str(count_targets.index(substr)), "]"])
 * 
 * 		else: return substr             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def encode(string):
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_substr);
    __pyx_r = __pyx_v_substr;
    goto __pyx_L0;
  }
  __pyx_L3:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_functions.convert", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_18generate_functions_3encode(PyObject *__pyx_self, PyObject *__pyx_v_string); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_18generate_functions_3encode = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("encode"), (PyCFunction)__pyx_pw_14stringchemical_18generate_functions_3encode, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_18generate_functions_3encode(PyObject *__pyx_self, PyObject *__pyx_v_string) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("encode (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_18generate_functions_2encode(__pyx_self, ((PyObject *)__pyx_v_string));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line357")'> 357: </pre>
<pre id='line357' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line358")'> 358: 	def encode(string):</pre>
<pre id='line358' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":358
 * 		else: return substr
 * 
 * 	def encode(string):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return ''.join([convert(substr) for substr in string])
 * 
 */

static PyObject *__pyx_pf_14stringchemical_18generate_functions_2encode(PyObject *__pyx_self, PyObject *__pyx_v_string) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_3_generate_functions *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct_3_generate_functions *__pyx_outer_scope;
  PyObject *__pyx_v_substr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("encode", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_3_generate_functions *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":358
 * 		else: return substr
 * 
 * 	def encode(string):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return ''.join([convert(substr) for substr in string])
 * 
 */
  __pyx_k_tuple_70 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject *)__pyx_n_s__string), ((PyObject *)__pyx_n_s__substr));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_70)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_70);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_70));

  /* "libchemicalstring_2.pyx":358
 * 		else: return substr
 * 
 * 	def encode(string):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return ''.join([convert(substr) for substr in string])
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_18generate_functions_3encode, 0, __pyx_n_s_72, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_71));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_encode = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_71 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(1, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_70, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__encode, 358, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_71)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line359")'> 359: 		return ''.join([convert(substr) for substr in string])</pre>
<pre id='line359' class='code' style='background-color: #FFFF19'>
  /* "libchemicalstring_2.pyx":359
 * 
 * 	def encode(string):
 * 		return ''.join([convert(substr) for substr in string])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	func_names = [fu[:fu.find('=')] for fu in functions]
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(((PyObject *)__pyx_kp_s_10), __pyx_n_s__join);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_string) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_string)) {
    __pyx_t_3 = __pyx_v_string; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_string);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_5 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_5 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_6 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_6)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_substr);
    __pyx_v_substr = __pyx_t_6;
    __pyx_t_6 = 0;
    if (unlikely(!__pyx_cur_scope->__pyx_v_convert)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("convert");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_6 = __pyx_pf_14stringchemical_18generate_functions_convert(__pyx_cur_scope->__pyx_v_convert, __pyx_v_substr);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_2, (PyObject*)__pyx_t_6)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_functions.encode", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_substr);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line360")'> 360: </pre>
<pre id='line360' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line361")'> 361: 	func_names = [fu[:fu.find('=')] for fu in functions]</pre>
<pre id='line361' class='code' style='background-color: #FFFF1c'>
  /* "libchemicalstring_2.pyx":361
 * 		return ''.join([convert(substr) for substr in string])
 * 
 * 	func_names = [fu[:fu.find('=')] for fu in functions]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	encoded = [fu[fu.find('=') + 1:] for fu in functions]
 * 	encoded = ['lambda counts: ' + encode(re.split('(\W)', string))
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_functions) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_functions)) {
    __pyx_t_2 = __pyx_v_functions; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_functions);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_4 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_4 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fu);
    __pyx_v_fu = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_fu, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_k_tuple_74), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_fu, 0, 0, NULL, &__pyx_t_6, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_5)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_func_names = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":361
 * 		return ''.join([convert(substr) for substr in string])
 * 
 * 	func_names = [fu[:fu.find('=')] for fu in functions]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	encoded = [fu[fu.find('=') + 1:] for fu in functions]
 * 	encoded = ['lambda counts: ' + encode(re.split('(\W)', string))
 */
  __pyx_k_tuple_74 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_73));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_74)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_74);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_74));
</pre><pre class='line' style='background-color: #FFFF1a' onclick='toggleDiv("line362")'> 362: 	encoded = [fu[fu.find('=') + 1:] for fu in functions]</pre>
<pre id='line362' class='code' style='background-color: #FFFF1a'>
  /* "libchemicalstring_2.pyx":362
 * 
 * 	func_names = [fu[:fu.find('=')] for fu in functions]
 * 	encoded = [fu[fu.find('=') + 1:] for fu in functions]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	encoded = ['lambda counts: ' + encode(re.split('(\W)', string))
 * 											for string in encoded]
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_functions) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_functions)) {
    __pyx_t_2 = __pyx_v_functions; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_functions);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_4 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_4 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fu);
    __pyx_v_fu = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_fu, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_k_tuple_75), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_fu, 0, 0, &__pyx_t_5, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_6)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_encoded = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":362
 * 
 * 	func_names = [fu[:fu.find('=')] for fu in functions]
 * 	encoded = [fu[fu.find('=') + 1:] for fu in functions]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	encoded = ['lambda counts: ' + encode(re.split('(\W)', string))
 * 											for string in encoded]
 */
  __pyx_k_tuple_75 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_73));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_75)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_75);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_75));
</pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line363")'> 363: 	encoded = ['lambda counts: ' + encode(re.split('(\W)', string))</pre>
<pre id='line363' class='code' style='background-color: #FFFF32'>
  /* "libchemicalstring_2.pyx":363
 * 	func_names = [fu[:fu.find('=')] for fu in functions]
 * 	encoded = [fu[fu.find('=') + 1:] for fu in functions]
 * 	encoded = ['lambda counts: ' + encode(re.split('(\W)', string))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 											for string in encoded]
 * 	funcs = [eval(expr) for expr in encoded]
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);

    /* "libchemicalstring_2.pyx":363
 * 	func_names = [fu[:fu.find('=')] for fu in functions]
 * 	encoded = [fu[fu.find('=') + 1:] for fu in functions]
 * 	encoded = ['lambda counts: ' + encode(re.split('(\W)', string))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 											for string in encoded]
 * 	funcs = [eval(expr) for expr in encoded]
 */
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__re);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_77));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, ((PyObject *)__pyx_kp_s_77));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_77));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_string);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_v_string);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_string);
    __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
    __pyx_t_6 = __pyx_pf_14stringchemical_18generate_functions_2encode(__pyx_v_encode, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_76), __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_7)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_encoded));
  __pyx_v_encoded = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line364")'> 364: 											for string in encoded]</pre>
<pre id='line364' class='code' style='background-color: #FFFF9f'>
  /* "libchemicalstring_2.pyx":364
 * 	encoded = [fu[fu.find('=') + 1:] for fu in functions]
 * 	encoded = ['lambda counts: ' + encode(re.split('(\W)', string))
 * 											for string in encoded]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	funcs = [eval(expr) for expr in encoded]
 * 	return func_names, funcs
 */
  __pyx_t_2 = ((PyObject *)__pyx_v_encoded); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_string);
    __pyx_v_string = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line365")'> 365: 	funcs = [eval(expr) for expr in encoded]</pre>
<pre id='line365' class='code' style='background-color: #FFFF19'>
  /* "libchemicalstring_2.pyx":365
 * 	encoded = ['lambda counts: ' + encode(re.split('(\W)', string))
 * 											for string in encoded]
 * 	funcs = [eval(expr) for expr in encoded]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return func_names, funcs
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = ((PyObject *)__pyx_v_encoded); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_expr);
    __pyx_v_expr = __pyx_t_7;
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_Globals</span>();<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_6));
    if (((PyObject *)__pyx_v_funcs)) {
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, ((PyObject *)__pyx_n_s__funcs), ((PyObject *)__pyx_v_funcs)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    if (__pyx_cur_scope->__pyx_v_convert) {
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, ((PyObject *)__pyx_n_s__convert), __pyx_cur_scope->__pyx_v_convert) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    if (__pyx_v_fu) {
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, ((PyObject *)__pyx_n_s__fu), __pyx_v_fu) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    if (__pyx_cur_scope->__pyx_v_count_targets) {
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, ((PyObject *)__pyx_n_s__count_targets), __pyx_cur_scope->__pyx_v_count_targets) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    if (__pyx_v_expr) {
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, ((PyObject *)__pyx_n_s__expr), __pyx_v_expr) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    if (__pyx_v_functions) {
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, ((PyObject *)__pyx_n_s__functions), __pyx_v_functions) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    if (((PyObject *)__pyx_v_encoded)) {
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, ((PyObject *)__pyx_n_s__encoded), ((PyObject *)__pyx_v_encoded)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    if (__pyx_v_encode) {
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, ((PyObject *)__pyx_n_s__encode), __pyx_v_encode) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    if (((PyObject *)__pyx_v_func_names)) {
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, ((PyObject *)__pyx_n_s__func_names), ((PyObject *)__pyx_v_func_names)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    if (__pyx_v_counts) {
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, ((PyObject *)__pyx_n_s__counts), __pyx_v_counts) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    if (__pyx_v_string) {
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, ((PyObject *)__pyx_n_s__string), __pyx_v_string) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_expr);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_expr);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_expr);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, ((PyObject *)__pyx_t_7));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_7));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, ((PyObject *)__pyx_t_6));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_6));
    __pyx_t_7 = 0;
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_eval, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_6)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_funcs = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF18' onclick='toggleDiv("line366")'> 366: 	return func_names, funcs</pre>
<pre id='line366' class='code' style='background-color: #FFFF18'>
  /* "libchemicalstring_2.pyx":366
 * 											for string in encoded]
 * 	funcs = [eval(expr) for expr in encoded]
 * 	return func_names, funcs             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_func_names));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_func_names));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_func_names));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_funcs));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_funcs));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_funcs));
  __pyx_r = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_functions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_encode);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_func_names);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_encoded);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_funcs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fu);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_string);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_expr);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_7make_lt_eq(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_7make_lt_eq = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("make_lt_eq"), (PyCFunction)__pyx_pw_14stringchemical_7make_lt_eq, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_7make_lt_eq(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_counts = 0;
  int __pyx_v_cnt_dex;
  double __pyx_v_value;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_lt_eq (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__counts,&__pyx_n_s__cnt_dex,&__pyx_n_s__value,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__counts)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__cnt_dex)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_lt_eq", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__value)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_lt_eq", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "make_lt_eq") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_counts = values[0];
    __pyx_v_cnt_dex = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_cnt_dex == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_value = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_value == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_lt_eq", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_lt_eq", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_6make_lt_eq(__pyx_self, __pyx_v_counts, __pyx_v_cnt_dex, __pyx_v_value);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_10make_lt_eq_1lt_eq(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_10make_lt_eq_1lt_eq = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("lt_eq"), (PyCFunction)__pyx_pw_14stringchemical_10make_lt_eq_1lt_eq, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_10make_lt_eq_1lt_eq(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("lt_eq (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_10make_lt_eq_lt_eq(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line367")'> 367: </pre>
<pre id='line367' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line368")'> 368: </pre>
<pre id='line368' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line369")'> 369: </pre>
<pre id='line369' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line370")'> 370: #various simplified test functions available to make_test</pre>
<pre id='line370' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line371")'> 371: def make_lt_eq(counts, int cnt_dex, double value):</pre>
<pre id='line371' class='code' style='background-color: #FFFF5b'>
/* "libchemicalstring_2.pyx":371
 * 
 * #various simplified test functions available to make_test
 * def make_lt_eq(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_lt_eq(counts, cnt_dex, value):
 * 	def lt_eq(): return counts[cnt_dex] <code><</code>= value
 */

static PyObject *__pyx_pf_14stringchemical_6make_lt_eq(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_counts, int __pyx_v_cnt_dex, double __pyx_v_value) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_4_make_lt_eq *__pyx_cur_scope;
  PyObject *__pyx_v_lt_eq = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_lt_eq", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_4_make_lt_eq *)__pyx_tp_new_14stringchemical___pyx_scope_struct_4_make_lt_eq(__pyx_ptype_14stringchemical___pyx_scope_struct_4_make_lt_eq, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_counts = __pyx_v_counts;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);
  __pyx_cur_scope->__pyx_v_cnt_dex = __pyx_v_cnt_dex;
  __pyx_cur_scope->__pyx_v_value = __pyx_v_value;

  /* "libchemicalstring_2.pyx":371
 * 
 * #various simplified test functions available to make_test
 * def make_lt_eq(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_lt_eq(counts, cnt_dex, value):
 * 	def lt_eq(): return counts[cnt_dex] <code><</code>= value
 */
  __pyx_k_tuple_195 = <span class='py_c_api'>PyTuple_Pack</span>(5, ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_n_s__cnt_dex), ((PyObject *)__pyx_n_s__value), ((PyObject *)__pyx_n_s__lt_eq), ((PyObject *)__pyx_n_s__lt_eq));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_195)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_195);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_195));

  /* "libchemicalstring_2.pyx":371
 * 
 * #various simplified test functions available to make_test
 * def make_lt_eq(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_lt_eq(counts, cnt_dex, value):
 * 	def lt_eq(): return counts[cnt_dex] <code><</code>= value
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_7make_lt_eq, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__make_lt_eq, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_196 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(3, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_195, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__make_lt_eq, 371, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_196)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":371
 * 
 * #various simplified test functions available to make_test
 * def make_lt_eq(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_lt_eq(counts, cnt_dex, value):
 * 	def lt_eq(): return counts[cnt_dex] <code><</code>= value
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_4_make_lt_eq {
  PyObject_HEAD
  int __pyx_v_cnt_dex;
  PyObject *__pyx_v_counts;
  double __pyx_v_value;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line372")'> 372: #def make_lt_eq(counts, cnt_dex, value):</pre>
<pre id='line372' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line373")'> 373: 	def lt_eq(): return counts[cnt_dex] &lt;= value</pre>
<pre id='line373' class='code' style='background-color: #FFFF3b'>
/* "libchemicalstring_2.pyx":373
 * def make_lt_eq(counts, int cnt_dex, double value):
 * #def make_lt_eq(counts, cnt_dex, value):
 * 	def lt_eq(): return counts[cnt_dex] <code><</code>= value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return lt_eq
 * 
 */

static PyObject *__pyx_pf_14stringchemical_10make_lt_eq_lt_eq(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_4_make_lt_eq *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct_4_make_lt_eq *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("lt_eq", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_4_make_lt_eq *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_cur_scope->__pyx_v_cnt_dex, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_cur_scope->__pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_2, Py_LE); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_lt_eq.lt_eq", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "libchemicalstring_2.pyx":373
 * def make_lt_eq(counts, int cnt_dex, double value):
 * #def make_lt_eq(counts, cnt_dex, value):
 * 	def lt_eq(): return counts[cnt_dex] <code><</code>= value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return lt_eq
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_10make_lt_eq_1lt_eq, 0, __pyx_n_s_79, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_78));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_lt_eq = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":373
 * def make_lt_eq(counts, int cnt_dex, double value):
 * #def make_lt_eq(counts, cnt_dex, value):
 * 	def lt_eq(): return counts[cnt_dex] <code><</code>= value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return lt_eq
 * 
 */
  __pyx_k_codeobj_78 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 0, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__lt_eq, 373, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_78)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line374")'> 374: 	return lt_eq</pre>
<pre id='line374' class='code' style='background-color: #FFFF1e'>
  /* "libchemicalstring_2.pyx":374
 * #def make_lt_eq(counts, cnt_dex, value):
 * 	def lt_eq(): return counts[cnt_dex] <code><</code>= value
 * 	return lt_eq             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def make_gt_eq(counts, int cnt_dex, double value):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_lt_eq);
  __pyx_r = __pyx_v_lt_eq;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_lt_eq", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lt_eq);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_9make_gt_eq(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_9make_gt_eq = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("make_gt_eq"), (PyCFunction)__pyx_pw_14stringchemical_9make_gt_eq, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_9make_gt_eq(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_counts = 0;
  int __pyx_v_cnt_dex;
  double __pyx_v_value;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_gt_eq (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__counts,&__pyx_n_s__cnt_dex,&__pyx_n_s__value,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__counts)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__cnt_dex)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_gt_eq", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__value)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_gt_eq", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "make_gt_eq") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_counts = values[0];
    __pyx_v_cnt_dex = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_cnt_dex == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_value = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_value == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_gt_eq", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_gt_eq", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_8make_gt_eq(__pyx_self, __pyx_v_counts, __pyx_v_cnt_dex, __pyx_v_value);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_10make_gt_eq_1gt_eq(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_10make_gt_eq_1gt_eq = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("gt_eq"), (PyCFunction)__pyx_pw_14stringchemical_10make_gt_eq_1gt_eq, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_10make_gt_eq_1gt_eq(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("gt_eq (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_10make_gt_eq_gt_eq(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line375")'> 375: </pre>
<pre id='line375' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line376")'> 376: def make_gt_eq(counts, int cnt_dex, double value):</pre>
<pre id='line376' class='code' style='background-color: #FFFF5b'>
/* "libchemicalstring_2.pyx":376
 * 	return lt_eq
 * 
 * def make_gt_eq(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_gt_eq(counts, cnt_dex, value):
 * 	def gt_eq(): return counts[cnt_dex] >= value
 */

static PyObject *__pyx_pf_14stringchemical_8make_gt_eq(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_counts, int __pyx_v_cnt_dex, double __pyx_v_value) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_5_make_gt_eq *__pyx_cur_scope;
  PyObject *__pyx_v_gt_eq = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_gt_eq", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_5_make_gt_eq *)__pyx_tp_new_14stringchemical___pyx_scope_struct_5_make_gt_eq(__pyx_ptype_14stringchemical___pyx_scope_struct_5_make_gt_eq, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_counts = __pyx_v_counts;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);
  __pyx_cur_scope->__pyx_v_cnt_dex = __pyx_v_cnt_dex;
  __pyx_cur_scope->__pyx_v_value = __pyx_v_value;

  /* "libchemicalstring_2.pyx":376
 * 	return lt_eq
 * 
 * def make_gt_eq(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_gt_eq(counts, cnt_dex, value):
 * 	def gt_eq(): return counts[cnt_dex] >= value
 */
  __pyx_k_tuple_197 = <span class='py_c_api'>PyTuple_Pack</span>(5, ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_n_s__cnt_dex), ((PyObject *)__pyx_n_s__value), ((PyObject *)__pyx_n_s__gt_eq), ((PyObject *)__pyx_n_s__gt_eq));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_197)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_197);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_197));

  /* "libchemicalstring_2.pyx":376
 * 	return lt_eq
 * 
 * def make_gt_eq(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_gt_eq(counts, cnt_dex, value):
 * 	def gt_eq(): return counts[cnt_dex] >= value
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_9make_gt_eq, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__make_gt_eq, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_198 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(3, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_197, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__make_gt_eq, 376, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_198)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":376
 * 	return lt_eq
 * 
 * def make_gt_eq(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_gt_eq(counts, cnt_dex, value):
 * 	def gt_eq(): return counts[cnt_dex] >= value
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_5_make_gt_eq {
  PyObject_HEAD
  int __pyx_v_cnt_dex;
  PyObject *__pyx_v_counts;
  double __pyx_v_value;
};


</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line377")'> 377: #def make_gt_eq(counts, cnt_dex, value):</pre>
<pre id='line377' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line378")'> 378: 	def gt_eq(): return counts[cnt_dex] &gt;= value</pre>
<pre id='line378' class='code' style='background-color: #FFFF3b'>
/* "libchemicalstring_2.pyx":378
 * def make_gt_eq(counts, int cnt_dex, double value):
 * #def make_gt_eq(counts, cnt_dex, value):
 * 	def gt_eq(): return counts[cnt_dex] >= value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return gt_eq
 * 
 */

static PyObject *__pyx_pf_14stringchemical_10make_gt_eq_gt_eq(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_5_make_gt_eq *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct_5_make_gt_eq *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("gt_eq", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_5_make_gt_eq *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_cur_scope->__pyx_v_cnt_dex, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_cur_scope->__pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_2, Py_GE); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_gt_eq.gt_eq", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "libchemicalstring_2.pyx":378
 * def make_gt_eq(counts, int cnt_dex, double value):
 * #def make_gt_eq(counts, cnt_dex, value):
 * 	def gt_eq(): return counts[cnt_dex] >= value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return gt_eq
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_10make_gt_eq_1gt_eq, 0, __pyx_n_s_81, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_80));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_gt_eq = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":378
 * def make_gt_eq(counts, int cnt_dex, double value):
 * #def make_gt_eq(counts, cnt_dex, value):
 * 	def gt_eq(): return counts[cnt_dex] >= value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return gt_eq
 * 
 */
  __pyx_k_codeobj_80 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 0, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__gt_eq, 378, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_80)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line379")'> 379: 	return gt_eq</pre>
<pre id='line379' class='code' style='background-color: #FFFF1e'>
  /* "libchemicalstring_2.pyx":379
 * #def make_gt_eq(counts, cnt_dex, value):
 * 	def gt_eq(): return counts[cnt_dex] >= value
 * 	return gt_eq             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def make_lt(counts, int cnt_dex, double value):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_gt_eq);
  __pyx_r = __pyx_v_gt_eq;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_gt_eq", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_gt_eq);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_11make_lt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_11make_lt = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("make_lt"), (PyCFunction)__pyx_pw_14stringchemical_11make_lt, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_11make_lt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_counts = 0;
  int __pyx_v_cnt_dex;
  double __pyx_v_value;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_lt (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__counts,&__pyx_n_s__cnt_dex,&__pyx_n_s__value,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__counts)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__cnt_dex)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_lt", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__value)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_lt", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "make_lt") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_counts = values[0];
    __pyx_v_cnt_dex = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_cnt_dex == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_value = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_value == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_lt", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_lt", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_10make_lt(__pyx_self, __pyx_v_counts, __pyx_v_cnt_dex, __pyx_v_value);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_7make_lt_1lt(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_7make_lt_1lt = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("lt"), (PyCFunction)__pyx_pw_14stringchemical_7make_lt_1lt, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_7make_lt_1lt(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("lt (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_7make_lt_lt(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line380")'> 380: </pre>
<pre id='line380' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line381")'> 381: def make_lt(counts, int cnt_dex, double value):</pre>
<pre id='line381' class='code' style='background-color: #FFFF5b'>
/* "libchemicalstring_2.pyx":381
 * 	return gt_eq
 * 
 * def make_lt(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_lt(counts, cnt_dex, value):
 * 	def lt(): return counts[cnt_dex] <code><</code> value
 */

static PyObject *__pyx_pf_14stringchemical_10make_lt(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_counts, int __pyx_v_cnt_dex, double __pyx_v_value) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_6_make_lt *__pyx_cur_scope;
  PyObject *__pyx_v_lt = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_lt", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_6_make_lt *)__pyx_tp_new_14stringchemical___pyx_scope_struct_6_make_lt(__pyx_ptype_14stringchemical___pyx_scope_struct_6_make_lt, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_counts = __pyx_v_counts;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);
  __pyx_cur_scope->__pyx_v_cnt_dex = __pyx_v_cnt_dex;
  __pyx_cur_scope->__pyx_v_value = __pyx_v_value;

  /* "libchemicalstring_2.pyx":381
 * 	return gt_eq
 * 
 * def make_lt(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_lt(counts, cnt_dex, value):
 * 	def lt(): return counts[cnt_dex] <code><</code> value
 */
  __pyx_k_tuple_199 = <span class='py_c_api'>PyTuple_Pack</span>(5, ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_n_s__cnt_dex), ((PyObject *)__pyx_n_s__value), ((PyObject *)__pyx_n_s__lt), ((PyObject *)__pyx_n_s__lt));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_199)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_199);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_199));

  /* "libchemicalstring_2.pyx":381
 * 	return gt_eq
 * 
 * def make_lt(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_lt(counts, cnt_dex, value):
 * 	def lt(): return counts[cnt_dex] <code><</code> value
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_11make_lt, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__make_lt, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_200 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(3, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_199, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__make_lt, 381, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_200)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":381
 * 	return gt_eq
 * 
 * def make_lt(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_lt(counts, cnt_dex, value):
 * 	def lt(): return counts[cnt_dex] <code><</code> value
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_6_make_lt {
  PyObject_HEAD
  int __pyx_v_cnt_dex;
  PyObject *__pyx_v_counts;
  double __pyx_v_value;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line382")'> 382: #def make_lt(counts, cnt_dex, value):</pre>
<pre id='line382' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line383")'> 383: 	def lt(): return counts[cnt_dex] &lt; value</pre>
<pre id='line383' class='code' style='background-color: #FFFF3b'>
/* "libchemicalstring_2.pyx":383
 * def make_lt(counts, int cnt_dex, double value):
 * #def make_lt(counts, cnt_dex, value):
 * 	def lt(): return counts[cnt_dex] <code><</code> value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return lt
 * 
 */

static PyObject *__pyx_pf_14stringchemical_7make_lt_lt(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_6_make_lt *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct_6_make_lt *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("lt", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_6_make_lt *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_cur_scope->__pyx_v_cnt_dex, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_cur_scope->__pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_2, Py_LT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_lt.lt", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "libchemicalstring_2.pyx":383
 * def make_lt(counts, int cnt_dex, double value):
 * #def make_lt(counts, cnt_dex, value):
 * 	def lt(): return counts[cnt_dex] <code><</code> value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return lt
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_7make_lt_1lt, 0, __pyx_n_s_83, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_82));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_lt = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":383
 * def make_lt(counts, int cnt_dex, double value):
 * #def make_lt(counts, cnt_dex, value):
 * 	def lt(): return counts[cnt_dex] <code><</code> value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return lt
 * 
 */
  __pyx_k_codeobj_82 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 0, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__lt, 383, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_82)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line384")'> 384: 	return lt</pre>
<pre id='line384' class='code' style='background-color: #FFFF1e'>
  /* "libchemicalstring_2.pyx":384
 * #def make_lt(counts, cnt_dex, value):
 * 	def lt(): return counts[cnt_dex] <code><</code> value
 * 	return lt             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def make_gt(counts, int cnt_dex, double value):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_lt);
  __pyx_r = __pyx_v_lt;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_lt", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lt);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_13make_gt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_13make_gt = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("make_gt"), (PyCFunction)__pyx_pw_14stringchemical_13make_gt, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_13make_gt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_counts = 0;
  int __pyx_v_cnt_dex;
  double __pyx_v_value;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_gt (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__counts,&__pyx_n_s__cnt_dex,&__pyx_n_s__value,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__counts)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__cnt_dex)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_gt", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__value)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_gt", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "make_gt") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_counts = values[0];
    __pyx_v_cnt_dex = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_cnt_dex == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_value = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_value == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_gt", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_gt", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_12make_gt(__pyx_self, __pyx_v_counts, __pyx_v_cnt_dex, __pyx_v_value);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_7make_gt_1gt(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_7make_gt_1gt = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("gt"), (PyCFunction)__pyx_pw_14stringchemical_7make_gt_1gt, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_7make_gt_1gt(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("gt (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_7make_gt_gt(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line385")'> 385: </pre>
<pre id='line385' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line386")'> 386: def make_gt(counts, int cnt_dex, double value):</pre>
<pre id='line386' class='code' style='background-color: #FFFF5b'>
/* "libchemicalstring_2.pyx":386
 * 	return lt
 * 
 * def make_gt(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_gt(counts, cnt_dex, value):
 * 	def gt(): return counts[cnt_dex] > value
 */

static PyObject *__pyx_pf_14stringchemical_12make_gt(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_counts, int __pyx_v_cnt_dex, double __pyx_v_value) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_7_make_gt *__pyx_cur_scope;
  PyObject *__pyx_v_gt = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_gt", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_7_make_gt *)__pyx_tp_new_14stringchemical___pyx_scope_struct_7_make_gt(__pyx_ptype_14stringchemical___pyx_scope_struct_7_make_gt, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_counts = __pyx_v_counts;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);
  __pyx_cur_scope->__pyx_v_cnt_dex = __pyx_v_cnt_dex;
  __pyx_cur_scope->__pyx_v_value = __pyx_v_value;

  /* "libchemicalstring_2.pyx":386
 * 	return lt
 * 
 * def make_gt(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_gt(counts, cnt_dex, value):
 * 	def gt(): return counts[cnt_dex] > value
 */
  __pyx_k_tuple_201 = <span class='py_c_api'>PyTuple_Pack</span>(5, ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_n_s__cnt_dex), ((PyObject *)__pyx_n_s__value), ((PyObject *)__pyx_n_s__gt), ((PyObject *)__pyx_n_s__gt));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_201)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_201);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_201));

  /* "libchemicalstring_2.pyx":386
 * 	return lt
 * 
 * def make_gt(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_gt(counts, cnt_dex, value):
 * 	def gt(): return counts[cnt_dex] > value
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_13make_gt, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__make_gt, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_202 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(3, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_201, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__make_gt, 386, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_202)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":386
 * 	return lt
 * 
 * def make_gt(counts, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_gt(counts, cnt_dex, value):
 * 	def gt(): return counts[cnt_dex] > value
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_7_make_gt {
  PyObject_HEAD
  int __pyx_v_cnt_dex;
  PyObject *__pyx_v_counts;
  double __pyx_v_value;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line387")'> 387: #def make_gt(counts, cnt_dex, value):</pre>
<pre id='line387' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line388")'> 388: 	def gt(): return counts[cnt_dex] &gt; value</pre>
<pre id='line388' class='code' style='background-color: #FFFF3b'>
/* "libchemicalstring_2.pyx":388
 * def make_gt(counts, int cnt_dex, double value):
 * #def make_gt(counts, cnt_dex, value):
 * 	def gt(): return counts[cnt_dex] > value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return gt
 * 
 */

static PyObject *__pyx_pf_14stringchemical_7make_gt_gt(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_7_make_gt *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct_7_make_gt *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("gt", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_7_make_gt *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_cur_scope->__pyx_v_cnt_dex, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_cur_scope->__pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_2, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_gt.gt", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "libchemicalstring_2.pyx":388
 * def make_gt(counts, int cnt_dex, double value):
 * #def make_gt(counts, cnt_dex, value):
 * 	def gt(): return counts[cnt_dex] > value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return gt
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_7make_gt_1gt, 0, __pyx_n_s_85, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_84));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_gt = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":388
 * def make_gt(counts, int cnt_dex, double value):
 * #def make_gt(counts, cnt_dex, value):
 * 	def gt(): return counts[cnt_dex] > value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return gt
 * 
 */
  __pyx_k_codeobj_84 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 0, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__gt, 388, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_84)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF1b' onclick='toggleDiv("line389")'> 389: 	return gt</pre>
<pre id='line389' class='code' style='background-color: #FFFF1b'>
  /* "libchemicalstring_2.pyx":389
 * #def make_gt(counts, cnt_dex, value):
 * 	def gt(): return counts[cnt_dex] > value
 * 	return gt             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def make_increment(counts, data, int cnt_dex, double value):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_gt);
  __pyx_r = __pyx_v_gt;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_gt", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_gt);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_15make_increment(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_15make_increment = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("make_increment"), (PyCFunction)__pyx_pw_14stringchemical_15make_increment, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_15make_increment(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_counts = 0;
  PyObject *__pyx_v_data = 0;
  int __pyx_v_cnt_dex;
  double __pyx_v_value;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_increment (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__counts,&__pyx_n_s__data,&__pyx_n_s__cnt_dex,&__pyx_n_s__value,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__counts)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__data)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_increment", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__cnt_dex)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_increment", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__value)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_increment", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "make_increment") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_counts = values[0];
    __pyx_v_data = values[1];
    __pyx_v_cnt_dex = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_cnt_dex == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_value = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_value == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_increment", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_increment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_14make_increment(__pyx_self, __pyx_v_counts, __pyx_v_data, __pyx_v_cnt_dex, __pyx_v_value);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_14make_increment_1incre(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_14make_increment_1incre = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("incre"), (PyCFunction)__pyx_pw_14stringchemical_14make_increment_1incre, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_14make_increment_1incre(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("incre (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_14make_increment_incre(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line390")'> 390: </pre>
<pre id='line390' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line391")'> 391: def make_increment(counts, data, int cnt_dex, double value):</pre>
<pre id='line391' class='code' style='background-color: #FFFF57'>
/* "libchemicalstring_2.pyx":391
 * 	return gt
 * 
 * def make_increment(counts, data, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_increment(counts, data, cnt_dex, value):
 * 	def incre(): return counts[cnt_dex] - data[cnt_dex][-1] >= value
 */

static PyObject *__pyx_pf_14stringchemical_14make_increment(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_counts, PyObject *__pyx_v_data, int __pyx_v_cnt_dex, double __pyx_v_value) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_8_make_increment *__pyx_cur_scope;
  PyObject *__pyx_v_incre = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_increment", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_8_make_increment *)__pyx_tp_new_14stringchemical___pyx_scope_struct_8_make_increment(__pyx_ptype_14stringchemical___pyx_scope_struct_8_make_increment, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_counts = __pyx_v_counts;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);
  __pyx_cur_scope->__pyx_v_data = __pyx_v_data;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_data);
  __pyx_cur_scope->__pyx_v_cnt_dex = __pyx_v_cnt_dex;
  __pyx_cur_scope->__pyx_v_value = __pyx_v_value;

  /* "libchemicalstring_2.pyx":391
 * 	return gt
 * 
 * def make_increment(counts, data, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_increment(counts, data, cnt_dex, value):
 * 	def incre(): return counts[cnt_dex] - data[cnt_dex][-1] >= value
 */
  __pyx_k_tuple_203 = <span class='py_c_api'>PyTuple_Pack</span>(6, ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__cnt_dex), ((PyObject *)__pyx_n_s__value), ((PyObject *)__pyx_n_s__incre), ((PyObject *)__pyx_n_s__incre));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_203)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_203);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_203));

  /* "libchemicalstring_2.pyx":391
 * 	return gt
 * 
 * def make_increment(counts, data, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_increment(counts, data, cnt_dex, value):
 * 	def incre(): return counts[cnt_dex] - data[cnt_dex][-1] >= value
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_15make_increment, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__make_increment, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_204 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(4, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_203, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__make_increment, 391, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_204)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":391
 * 	return gt
 * 
 * def make_increment(counts, data, int cnt_dex, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_increment(counts, data, cnt_dex, value):
 * 	def incre(): return counts[cnt_dex] - data[cnt_dex][-1] >= value
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_8_make_increment {
  PyObject_HEAD
  int __pyx_v_cnt_dex;
  PyObject *__pyx_v_counts;
  PyObject *__pyx_v_data;
  double __pyx_v_value;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line392")'> 392: #def make_increment(counts, data, cnt_dex, value):</pre>
<pre id='line392' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2c' onclick='toggleDiv("line393")'> 393: 	def incre(): return counts[cnt_dex] - data[cnt_dex][-1] &gt;= value</pre>
<pre id='line393' class='code' style='background-color: #FFFF2c'>
/* "libchemicalstring_2.pyx":393
 * def make_increment(counts, data, int cnt_dex, double value):
 * #def make_increment(counts, data, cnt_dex, value):
 * 	def incre(): return counts[cnt_dex] - data[cnt_dex][-1] >= value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return incre
 * 
 */

static PyObject *__pyx_pf_14stringchemical_14make_increment_incre(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_8_make_increment *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct_8_make_increment *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("incre", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_8_make_increment *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_cur_scope->__pyx_v_cnt_dex, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (unlikely(!__pyx_cur_scope->__pyx_v_data)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("data");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_data, __pyx_cur_scope->__pyx_v_cnt_dex, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, -1, sizeof(long), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_cur_scope->__pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_GE); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_increment.incre", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "libchemicalstring_2.pyx":393
 * def make_increment(counts, data, int cnt_dex, double value):
 * #def make_increment(counts, data, cnt_dex, value):
 * 	def incre(): return counts[cnt_dex] - data[cnt_dex][-1] >= value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return incre
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_14make_increment_1incre, 0, __pyx_n_s_87, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_86));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_incre = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":393
 * def make_increment(counts, data, int cnt_dex, double value):
 * #def make_increment(counts, data, cnt_dex, value):
 * 	def incre(): return counts[cnt_dex] - data[cnt_dex][-1] >= value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return incre
 * 
 */
  __pyx_k_codeobj_86 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 0, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__incre, 393, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_86)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF16' onclick='toggleDiv("line394")'> 394: 	return incre</pre>
<pre id='line394' class='code' style='background-color: #FFFF16'>
  /* "libchemicalstring_2.pyx":394
 * #def make_increment(counts, data, cnt_dex, value):
 * 	def incre(): return counts[cnt_dex] - data[cnt_dex][-1] >= value
 * 	return incre             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def make_asymmetric_increment(counts, data, int dex1, int dex2, double value):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_incre);
  __pyx_r = __pyx_v_incre;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_increment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_incre);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_17make_asymmetric_increment(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_17make_asymmetric_increment = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("make_asymmetric_increment"), (PyCFunction)__pyx_pw_14stringchemical_17make_asymmetric_increment, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_17make_asymmetric_increment(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_counts = 0;
  PyObject *__pyx_v_data = 0;
  int __pyx_v_dex1;
  int __pyx_v_dex2;
  double __pyx_v_value;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_asymmetric_increment (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__counts,&__pyx_n_s__data,&__pyx_n_s__dex1,&__pyx_n_s__dex2,&__pyx_n_s__value,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__counts)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__data)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_asymmetric_increment", 1, 5, 5, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__dex1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_asymmetric_increment", 1, 5, 5, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__dex2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_asymmetric_increment", 1, 5, 5, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__value)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_asymmetric_increment", 1, 5, 5, 4);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "make_asymmetric_increment") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_counts = values[0];
    __pyx_v_data = values[1];
    __pyx_v_dex1 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_dex1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_dex2 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_dex2 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_value = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_value == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_asymmetric_increment", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_asymmetric_increment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_16make_asymmetric_increment(__pyx_self, __pyx_v_counts, __pyx_v_data, __pyx_v_dex1, __pyx_v_dex2, __pyx_v_value);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_25make_asymmetric_increment_1asym_incre(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_25make_asymmetric_increment_1asym_incre = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("asym_incre"), (PyCFunction)__pyx_pw_14stringchemical_25make_asymmetric_increment_1asym_incre, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_25make_asymmetric_increment_1asym_incre(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("asym_incre (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_25make_asymmetric_increment_asym_incre(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line395")'> 395: </pre>
<pre id='line395' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line396")'> 396: def make_asymmetric_increment(counts, data, int dex1, int dex2, double value):</pre>
<pre id='line396' class='code' style='background-color: #FFFF57'>
/* "libchemicalstring_2.pyx":396
 * 	return incre
 * 
 * def make_asymmetric_increment(counts, data, int dex1, int dex2, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_asymmetric_increment(counts, data, dex1, dex2, value):
 * 	def asym_incre(): return counts[dex1] - data[dex2][-1] >= value
 */

static PyObject *__pyx_pf_14stringchemical_16make_asymmetric_increment(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_counts, PyObject *__pyx_v_data, int __pyx_v_dex1, int __pyx_v_dex2, double __pyx_v_value) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_9_make_asymmetric_increment *__pyx_cur_scope;
  PyObject *__pyx_v_asym_incre = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_asymmetric_increment", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_9_make_asymmetric_increment *)__pyx_tp_new_14stringchemical___pyx_scope_struct_9_make_asymmetric_increment(__pyx_ptype_14stringchemical___pyx_scope_struct_9_make_asymmetric_increment, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_counts = __pyx_v_counts;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);
  __pyx_cur_scope->__pyx_v_data = __pyx_v_data;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_data);
  __pyx_cur_scope->__pyx_v_dex1 = __pyx_v_dex1;
  __pyx_cur_scope->__pyx_v_dex2 = __pyx_v_dex2;
  __pyx_cur_scope->__pyx_v_value = __pyx_v_value;

  /* "libchemicalstring_2.pyx":396
 * 	return incre
 * 
 * def make_asymmetric_increment(counts, data, int dex1, int dex2, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_asymmetric_increment(counts, data, dex1, dex2, value):
 * 	def asym_incre(): return counts[dex1] - data[dex2][-1] >= value
 */
  __pyx_k_tuple_205 = <span class='py_c_api'>PyTuple_Pack</span>(7, ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__dex1), ((PyObject *)__pyx_n_s__dex2), ((PyObject *)__pyx_n_s__value), ((PyObject *)__pyx_n_s__asym_incre), ((PyObject *)__pyx_n_s__asym_incre));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_205)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_205);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_205));

  /* "libchemicalstring_2.pyx":396
 * 	return incre
 * 
 * def make_asymmetric_increment(counts, data, int dex1, int dex2, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_asymmetric_increment(counts, data, dex1, dex2, value):
 * 	def asym_incre(): return counts[dex1] - data[dex2][-1] >= value
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_17make_asymmetric_increment, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_207, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_206 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(5, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_205, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s_207, 396, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_206)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":396
 * 	return incre
 * 
 * def make_asymmetric_increment(counts, data, int dex1, int dex2, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #def make_asymmetric_increment(counts, data, dex1, dex2, value):
 * 	def asym_incre(): return counts[dex1] - data[dex2][-1] >= value
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_9_make_asymmetric_increment {
  PyObject_HEAD
  PyObject *__pyx_v_counts;
  PyObject *__pyx_v_data;
  int __pyx_v_dex1;
  int __pyx_v_dex2;
  double __pyx_v_value;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line397")'> 397: #def make_asymmetric_increment(counts, data, dex1, dex2, value):</pre>
<pre id='line397' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2c' onclick='toggleDiv("line398")'> 398: 	def asym_incre(): return counts[dex1] - data[dex2][-1] &gt;= value</pre>
<pre id='line398' class='code' style='background-color: #FFFF2c'>
/* "libchemicalstring_2.pyx":398
 * def make_asymmetric_increment(counts, data, int dex1, int dex2, double value):
 * #def make_asymmetric_increment(counts, data, dex1, dex2, value):
 * 	def asym_incre(): return counts[dex1] - data[dex2][-1] >= value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return asym_incre
 * 
 */

static PyObject *__pyx_pf_14stringchemical_25make_asymmetric_increment_asym_incre(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_9_make_asymmetric_increment *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct_9_make_asymmetric_increment *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("asym_incre", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_9_make_asymmetric_increment *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_cur_scope->__pyx_v_dex1, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (unlikely(!__pyx_cur_scope->__pyx_v_data)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("data");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_data, __pyx_cur_scope->__pyx_v_dex2, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, -1, sizeof(long), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_cur_scope->__pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_GE); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_asymmetric_increment.asym_incre", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "libchemicalstring_2.pyx":398
 * def make_asymmetric_increment(counts, data, int dex1, int dex2, double value):
 * #def make_asymmetric_increment(counts, data, dex1, dex2, value):
 * 	def asym_incre(): return counts[dex1] - data[dex2][-1] >= value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return asym_incre
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_25make_asymmetric_increment_1asym_incre, 0, __pyx_n_s_89, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_88));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_asym_incre = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":398
 * def make_asymmetric_increment(counts, data, int dex1, int dex2, double value):
 * #def make_asymmetric_increment(counts, data, dex1, dex2, value):
 * 	def asym_incre(): return counts[dex1] - data[dex2][-1] >= value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return asym_incre
 * 
 */
  __pyx_k_codeobj_88 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 0, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__asym_incre, 398, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_88)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line399")'> 399: 	return asym_incre</pre>
<pre id='line399' class='code' style='background-color: #FFFF23'>
  /* "libchemicalstring_2.pyx":399
 * #def make_asymmetric_increment(counts, data, dex1, dex2, value):
 * 	def asym_incre(): return counts[dex1] - data[dex2][-1] >= value
 * 	return asym_incre             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_asym_incre);
  __pyx_r = __pyx_v_asym_incre;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_asymmetric_increment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_asym_incre);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_19make_test(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_19make_test = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("make_test"), (PyCFunction)__pyx_pw_14stringchemical_19make_test, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_19make_test(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_counts = 0;
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_count_targets = 0;
  PyObject *__pyx_v_string = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_test (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__counts,&__pyx_n_s__data,&__pyx_n_s__count_targets,&__pyx_n_s__string,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__counts)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__data)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_test", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__count_targets)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_test", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__string)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_test", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "make_test") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_counts = values[0];
    __pyx_v_data = values[1];
    __pyx_v_count_targets = values[2];
    __pyx_v_string = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_test", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_test", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_18make_test(__pyx_self, __pyx_v_counts, __pyx_v_data, __pyx_v_count_targets, __pyx_v_string);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line400")'> 400: </pre>
<pre id='line400' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line401")'> 401: </pre>
<pre id='line401' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line402")'> 402: </pre>
<pre id='line402' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line403")'> 403: #returns a function which checks the specified criterion in string</pre>
<pre id='line403' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line404")'> 404: def make_test(counts, data, count_targets, string):</pre>
<pre id='line404' class='code' style='background-color: #FFFF62'>
/* "libchemicalstring_2.pyx":404
 * 
 * #returns a function which checks the specified criterion in string
 * def make_test(counts, data, count_targets, string):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	eq_rel = ['>' in string, '<code><</code>' in string, '>=' in string, '<code><</code>=' in string]
 * 	if eq_rel[3]:
 */

static PyObject *__pyx_pf_14stringchemical_18make_test(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_counts, PyObject *__pyx_v_data, PyObject *__pyx_v_count_targets, PyObject *__pyx_v_string) {
  PyObject *__pyx_v_eq_rel = NULL;
  PyObject *__pyx_v_left = NULL;
  PyObject *__pyx_v_right = NULL;
  PyObject *__pyx_v_incr_target = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_test", 0);

  /* "libchemicalstring_2.pyx":404
 * 
 * #returns a function which checks the specified criterion in string
 * def make_test(counts, data, count_targets, string):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	eq_rel = ['>' in string, '<code><</code>' in string, '>=' in string, '<code><</code>=' in string]
 * 	if eq_rel[3]:
 */
  __pyx_k_tuple_208 = <span class='py_c_api'>PyTuple_Pack</span>(8, ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__count_targets), ((PyObject *)__pyx_n_s__string), ((PyObject *)__pyx_n_s__eq_rel), ((PyObject *)__pyx_n_s__left), ((PyObject *)__pyx_n_s__right), ((PyObject *)__pyx_n_s__incr_target));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_208)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_208);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_208));

  /* "libchemicalstring_2.pyx":404
 * 
 * #returns a function which checks the specified criterion in string
 * def make_test(counts, data, count_targets, string):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	eq_rel = ['>' in string, '<code><</code>' in string, '>=' in string, '<code><</code>=' in string]
 * 	if eq_rel[3]:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_19make_test, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__make_test, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_209 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(4, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_208, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__make_test, 404, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_209)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line405")'> 405: 	eq_rel = ['&gt;' in string, '&lt;' in string, '&gt;=' in string, '&lt;=' in string]</pre>
<pre id='line405' class='code' style='background-color: #FFFF2b'>
  /* "libchemicalstring_2.pyx":405
 * #returns a function which checks the specified criterion in string
 * def make_test(counts, data, count_targets, string):
 * 	eq_rel = ['>' in string, '<code><</code>' in string, '>=' in string, '<code><</code>=' in string]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	if eq_rel[3]:
 * 		return make_lt_eq(counts, count_targets.index(string[:string.find('<code><</code>=')]),
 */
  __pyx_t_1 = (__Pyx_<span class='py_c_api'>PySequence_Contains</span>(((PyObject *)__pyx_kp_s_90), __pyx_v_string, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_1 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = (__Pyx_<span class='py_c_api'>PySequence_Contains</span>(((PyObject *)__pyx_kp_s_91), __pyx_v_string, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_1 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = (__Pyx_<span class='py_c_api'>PySequence_Contains</span>(((PyObject *)__pyx_kp_s_92), __pyx_v_string, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_1 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_1 = (__Pyx_<span class='py_c_api'>PySequence_Contains</span>(((PyObject *)__pyx_kp_s_93), __pyx_v_string, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_1 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_4);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_5);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_v_eq_rel = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line406")'> 406: 	if eq_rel[3]:</pre>
<pre id='line406' class='code' style='background-color: #FFFF8d'>
  /* "libchemicalstring_2.pyx":406
 * def make_test(counts, data, count_targets, string):
 * 	eq_rel = ['>' in string, '<code><</code>' in string, '>=' in string, '<code><</code>=' in string]
 * 	if eq_rel[3]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return make_lt_eq(counts, count_targets.index(string[:string.find('<code><</code>=')]),
 * 									float(string[string.find('<code><</code>=') + 2:]))
 */
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(((PyObject *)__pyx_v_eq_rel), 3, sizeof(long), PyInt_FromLong, 1, 0, 1);<span class='error_goto'> if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 406; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_1 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 406; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line407")'> 407: 		return make_lt_eq(counts, count_targets.index(string[:string.find('&lt;=')]),</pre>
<pre id='line407' class='code' style='background-color: #FFFF30'>
    /* "libchemicalstring_2.pyx":407
 * 	eq_rel = ['>' in string, '<code><</code>' in string, '>=' in string, '<code><</code>=' in string]
 * 	if eq_rel[3]:
 * 		return make_lt_eq(counts, count_targets.index(string[:string.find('<code><</code>=')]),             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 									float(string[string.find('<code><</code>=') + 2:]))
 * 
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__make_lt_eq);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_count_targets, __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_string, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_k_tuple_94), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_string, 0, 0, NULL, &__pyx_t_3, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;

  /* "libchemicalstring_2.pyx":407
 * 	eq_rel = ['>' in string, '<code><</code>' in string, '>=' in string, '<code><</code>=' in string]
 * 	if eq_rel[3]:
 * 		return make_lt_eq(counts, count_targets.index(string[:string.find('<code><</code>=')]),             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 									float(string[string.find('<code><</code>=') + 2:]))
 * 
 */
  __pyx_k_tuple_94 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_93));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_94)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_94);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_94));
</pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line408")'> 408: 									float(string[string.find('&lt;=') + 2:]))</pre>
<pre id='line408' class='code' style='background-color: #FFFF24'>
    /* "libchemicalstring_2.pyx":408
 * 	if eq_rel[3]:
 * 		return make_lt_eq(counts, count_targets.index(string[:string.find('<code><</code>=')]),
 * 									float(string[string.find('<code><</code>=') + 2:]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	elif eq_rel[2]:
 */
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_string, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_95), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_string, 0, 0, &__pyx_t_3, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_counts);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }

  /* "libchemicalstring_2.pyx":408
 * 	if eq_rel[3]:
 * 		return make_lt_eq(counts, count_targets.index(string[:string.find('<code><</code>=')]),
 * 									float(string[string.find('<code><</code>=') + 2:]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	elif eq_rel[2]:
 */
  __pyx_k_tuple_95 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_93));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_95)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_95);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_95));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line409")'> 409: </pre>
<pre id='line409' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line410")'> 410: 	elif eq_rel[2]:</pre>
<pre id='line410' class='code' style='background-color: #FFFF8d'>
  /* "libchemicalstring_2.pyx":410
 * 									float(string[string.find('<code><</code>=') + 2:]))
 * 
 * 	elif eq_rel[2]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return make_gt_eq(counts, count_targets.index(string[:string.find('>=')]),
 * 									float(string[string.find('>=') + 2:]))
 */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(((PyObject *)__pyx_v_eq_rel), 2, sizeof(long), PyInt_FromLong, 1, 0, 1);<span class='error_goto'> if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_1 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line411")'> 411: 		return make_gt_eq(counts, count_targets.index(string[:string.find('&gt;=')]),</pre>
<pre id='line411' class='code' style='background-color: #FFFF30'>
    /* "libchemicalstring_2.pyx":411
 * 
 * 	elif eq_rel[2]:
 * 		return make_gt_eq(counts, count_targets.index(string[:string.find('>=')]),             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 									float(string[string.find('>=') + 2:]))
 * 
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__make_gt_eq);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_count_targets, __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_string, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_k_tuple_96), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_string, 0, 0, NULL, &__pyx_t_4, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;

  /* "libchemicalstring_2.pyx":411
 * 
 * 	elif eq_rel[2]:
 * 		return make_gt_eq(counts, count_targets.index(string[:string.find('>=')]),             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 									float(string[string.find('>=') + 2:]))
 * 
 */
  __pyx_k_tuple_96 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_92));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_96)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_96);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_96));
</pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line412")'> 412: 									float(string[string.find('&gt;=') + 2:]))</pre>
<pre id='line412' class='code' style='background-color: #FFFF24'>
    /* "libchemicalstring_2.pyx":412
 * 	elif eq_rel[2]:
 * 		return make_gt_eq(counts, count_targets.index(string[:string.find('>=')]),
 * 									float(string[string.find('>=') + 2:]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	elif eq_rel[1]:
 */
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_string, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_k_tuple_97), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_string, 0, 0, &__pyx_t_4, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_counts);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_6);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_6 = 0;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }

  /* "libchemicalstring_2.pyx":412
 * 	elif eq_rel[2]:
 * 		return make_gt_eq(counts, count_targets.index(string[:string.find('>=')]),
 * 									float(string[string.find('>=') + 2:]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	elif eq_rel[1]:
 */
  __pyx_k_tuple_97 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_92));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_97)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_97);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_97));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line413")'> 413: </pre>
<pre id='line413' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line414")'> 414: 	elif eq_rel[1]:</pre>
<pre id='line414' class='code' style='background-color: #FFFF8d'>
  /* "libchemicalstring_2.pyx":414
 * 									float(string[string.find('>=') + 2:]))
 * 
 * 	elif eq_rel[1]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return make_lt(counts, count_targets.index(string[:string.find('<code><</code>')]),
 * 								float(string[string.find('<code><</code>') + 1:]))
 */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(((PyObject *)__pyx_v_eq_rel), 1, sizeof(long), PyInt_FromLong, 1, 0, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_1 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line415")'> 415: 		return make_lt(counts, count_targets.index(string[:string.find('&lt;')]),</pre>
<pre id='line415' class='code' style='background-color: #FFFF30'>
    /* "libchemicalstring_2.pyx":415
 * 
 * 	elif eq_rel[1]:
 * 		return make_lt(counts, count_targets.index(string[:string.find('<code><</code>')]),             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 								float(string[string.find('<code><</code>') + 1:]))
 * 
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__make_lt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_count_targets, __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_string, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_k_tuple_98), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_string, 0, 0, NULL, &__pyx_t_6, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;

  /* "libchemicalstring_2.pyx":415
 * 
 * 	elif eq_rel[1]:
 * 		return make_lt(counts, count_targets.index(string[:string.find('<code><</code>')]),             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 								float(string[string.find('<code><</code>') + 1:]))
 * 
 */
  __pyx_k_tuple_98 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_91));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_98)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_98);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_98));
</pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line416")'> 416: 								float(string[string.find('&lt;') + 1:]))</pre>
<pre id='line416' class='code' style='background-color: #FFFF24'>
    /* "libchemicalstring_2.pyx":416
 * 	elif eq_rel[1]:
 * 		return make_lt(counts, count_targets.index(string[:string.find('<code><</code>')]),
 * 								float(string[string.find('<code><</code>') + 1:]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	elif eq_rel[0]:
 */
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_string, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_k_tuple_99), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_string, 0, 0, &__pyx_t_6, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_counts);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_t_5 = 0;
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }

  /* "libchemicalstring_2.pyx":416
 * 	elif eq_rel[1]:
 * 		return make_lt(counts, count_targets.index(string[:string.find('<code><</code>')]),
 * 								float(string[string.find('<code><</code>') + 1:]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	elif eq_rel[0]:
 */
  __pyx_k_tuple_99 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_91));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_99)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_99);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_99));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line417")'> 417: </pre>
<pre id='line417' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line418")'> 418: 	elif eq_rel[0]:</pre>
<pre id='line418' class='code' style='background-color: #FFFF8d'>
  /* "libchemicalstring_2.pyx":418
 * 								float(string[string.find('<code><</code>') + 1:]))
 * 
 * 	elif eq_rel[0]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return make_gt(counts, count_targets.index(string[:string.find('>')]),
 * 								float(string[string.find('>') + 1:]))
 */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(((PyObject *)__pyx_v_eq_rel), 0, sizeof(long), PyInt_FromLong, 1, 0, 1);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_1 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line419")'> 419: 		return make_gt(counts, count_targets.index(string[:string.find('&gt;')]),</pre>
<pre id='line419' class='code' style='background-color: #FFFF30'>
    /* "libchemicalstring_2.pyx":419
 * 
 * 	elif eq_rel[0]:
 * 		return make_gt(counts, count_targets.index(string[:string.find('>')]),             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 								float(string[string.find('>') + 1:]))
 * 
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__make_gt);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_count_targets, __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_string, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_100), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_string, 0, 0, NULL, &__pyx_t_5, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;

  /* "libchemicalstring_2.pyx":419
 * 
 * 	elif eq_rel[0]:
 * 		return make_gt(counts, count_targets.index(string[:string.find('>')]),             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 								float(string[string.find('>') + 1:]))
 * 
 */
  __pyx_k_tuple_100 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_90));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_100)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_100);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_100));
</pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line420")'> 420: 								float(string[string.find('&gt;') + 1:]))</pre>
<pre id='line420' class='code' style='background-color: #FFFF24'>
    /* "libchemicalstring_2.pyx":420
 * 	elif eq_rel[0]:
 * 		return make_gt(counts, count_targets.index(string[:string.find('>')]),
 * 								float(string[string.find('>') + 1:]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	elif string.startswith('increment'):
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_string, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_k_tuple_101), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_string, 0, 0, &__pyx_t_5, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_counts);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_6);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
    __pyx_t_3 = 0;
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_r = __pyx_t_6;
    __pyx_t_6 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }

  /* "libchemicalstring_2.pyx":420
 * 	elif eq_rel[0]:
 * 		return make_gt(counts, count_targets.index(string[:string.find('>')]),
 * 								float(string[string.find('>') + 1:]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	elif string.startswith('increment'):
 */
  __pyx_k_tuple_101 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_90));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_101)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_101);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_101));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line421")'> 421: </pre>
<pre id='line421' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line422")'> 422: 	elif string.startswith('increment'):</pre>
<pre id='line422' class='code' style='background-color: #FFFF4f'>
  /* "libchemicalstring_2.pyx":422
 * 								float(string[string.find('>') + 1:]))
 * 
 * 	elif string.startswith('increment'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		left = string.find(':') + 1
 * 		right = string.rfind(':')
 */
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_string, __pyx_n_s__startswith);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_k_tuple_102), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_1 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (__pyx_t_1) {

  /* "libchemicalstring_2.pyx":422
 * 								float(string[string.find('>') + 1:]))
 * 
 * 	elif string.startswith('increment'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		left = string.find(':') + 1
 * 		right = string.rfind(':')
 */
  __pyx_k_tuple_102 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_n_s__increment));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_102)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_102);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_102));
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line423")'> 423: 		left = string.find(':') + 1</pre>
<pre id='line423' class='code' style='background-color: #FFFF4f'>
    /* "libchemicalstring_2.pyx":423
 * 
 * 	elif string.startswith('increment'):
 * 		left = string.find(':') + 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		right = string.rfind(':')
 * 		incr_target = string[left:right]
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_string, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_k_tuple_103), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_left = __pyx_t_5;
    __pyx_t_5 = 0;

  /* "libchemicalstring_2.pyx":423
 * 
 * 	elif string.startswith('increment'):
 * 		left = string.find(':') + 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		right = string.rfind(':')
 * 		incr_target = string[left:right]
 */
  __pyx_k_tuple_103 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_5));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_103)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_103);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_103));
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line424")'> 424: 		right = string.rfind(':')</pre>
<pre id='line424' class='code' style='background-color: #FFFF62'>
    /* "libchemicalstring_2.pyx":424
 * 	elif string.startswith('increment'):
 * 		left = string.find(':') + 1
 * 		right = string.rfind(':')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		incr_target = string[left:right]
 * 		return make_increment(counts, data,
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_string, __pyx_n_s__rfind);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_k_tuple_104), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_right = __pyx_t_6;
    __pyx_t_6 = 0;

  /* "libchemicalstring_2.pyx":424
 * 	elif string.startswith('increment'):
 * 		left = string.find(':') + 1
 * 		right = string.rfind(':')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		incr_target = string[left:right]
 * 		return make_increment(counts, data,
 */
  __pyx_k_tuple_104 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_5));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_104)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_104);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_104));
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line425")'> 425: 		incr_target = string[left:right]</pre>
<pre id='line425' class='code' style='background-color: #FFFFaa'>
    /* "libchemicalstring_2.pyx":425
 * 		left = string.find(':') + 1
 * 		right = string.rfind(':')
 * 		incr_target = string[left:right]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return make_increment(counts, data,
 * 				count_targets.index(incr_target),
 */
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_string, 0, 0, &__pyx_v_left, &__pyx_v_right, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_v_incr_target = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line426")'> 426: 		return make_increment(counts, data,</pre>
<pre id='line426' class='code' style='background-color: #FFFFc4'>
    /* "libchemicalstring_2.pyx":426
 * 		right = string.rfind(':')
 * 		incr_target = string[left:right]
 * 		return make_increment(counts, data,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				count_targets.index(incr_target),
 * 				float(string[right + 1:]))
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__make_increment);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line427")'> 427: 				count_targets.index(incr_target),</pre>
<pre id='line427' class='code' style='background-color: #FFFF57'>
    /* "libchemicalstring_2.pyx":427
 * 		incr_target = string[left:right]
 * 		return make_increment(counts, data,
 * 				count_targets.index(incr_target),             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				float(string[right + 1:]))
 * 
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_count_targets, __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_incr_target);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_incr_target);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_incr_target);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line428")'> 428: 				float(string[right + 1:]))</pre>
<pre id='line428' class='code' style='background-color: #FFFF2e'>
    /* "libchemicalstring_2.pyx":428
 * 		return make_increment(counts, data,
 * 				count_targets.index(incr_target),
 * 				float(string[right + 1:]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	else:
 */
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_right, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_string, 0, 0, &__pyx_t_4, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_counts);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_data);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3, __pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
    __pyx_t_3 = 0;
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line429")'> 429: </pre>
<pre id='line429' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line430")'> 430: 	else:</pre>
<pre id='line430' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line431")'> 431: 		print 'here is that one bug...'</pre>
<pre id='line431' class='code' style='background-color: #FFFFd4'>
    /* "libchemicalstring_2.pyx":431
 * 
 * 	else:
 * 		print 'here is that one bug...'             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		print counts, data, count_targets, string
 * 
 */
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, ((PyObject *)__pyx_kp_s_105)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line432")'> 432: 		print counts, data, count_targets, string</pre>
<pre id='line432' class='code' style='background-color: #FFFF41'>
    /* "libchemicalstring_2.pyx":432
 * 	else:
 * 		print 'here is that one bug...'
 * 		print counts, data, count_targets, string             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_counts);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_data);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_count_targets);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_v_count_targets);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_count_targets);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_string);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 3, __pyx_v_string);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_string);
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_5), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  }
  __pyx_L3:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.make_test", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_eq_rel);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_left);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_right);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_incr_target);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line433")'> 433: </pre>
<pre id='line433' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line434")'> 434: </pre>
<pre id='line434' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line435")'> 435: </pre>
<pre id='line435' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line436")'> 436: #helper function to break up string representations of the system</pre>
<pre id='line436' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line437")'> 437: cdef inline parse(system_string, int dex, string):</pre>
<pre id='line437' class='code' style='background-color: #FFFFff'>
/* "libchemicalstring_2.pyx":437
 * 
 * #helper function to break up string representations of the system
 * cdef inline parse(system_string, int dex, string):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef int new_dex
 * 	new_dex = system_string.find(string)
 */

static CYTHON_INLINE PyObject *__pyx_f_14stringchemical_parse(PyObject *__pyx_v_system_string, int __pyx_v_dex, PyObject *__pyx_v_string) {
  int __pyx_v_new_dex;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("parse", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line438")'> 438: 	cdef int new_dex</pre>
<pre id='line438' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line439")'> 439: 	new_dex = system_string.find(string)</pre>
<pre id='line439' class='code' style='background-color: #FFFF3f'>
  /* "libchemicalstring_2.pyx":439
 * cdef inline parse(system_string, int dex, string):
 * 	cdef int new_dex
 * 	new_dex = system_string.find(string)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return system_string[dex:new_dex], new_dex
 * 
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_system_string, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_string);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_string);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_string);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_new_dex = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line440")'> 440: 	return system_string[dex:new_dex], new_dex</pre>
<pre id='line440' class='code' style='background-color: #FFFF48'>
  /* "libchemicalstring_2.pyx":440
 * 	cdef int new_dex
 * 	new_dex = system_string.find(string)
 * 	return system_string[dex:new_dex], new_dex             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_system_string, __pyx_v_dex, __pyx_v_new_dex, NULL, NULL, NULL, 1, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_new_dex);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_3 = 0;
  __pyx_t_2 = 0;
  __pyx_r = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.parse", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line441")'> 441: </pre>
<pre id='line441' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line442")'> 442: </pre>
<pre id='line442' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line443")'> 443: </pre>
<pre id='line443' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line444")'> 444: #reorder targets so they will match order of data lists</pre>
<pre id='line444' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line445")'> 445: cdef follow_order(targets, count_targets):</pre>
<pre id='line445' class='code' style='background-color: #FFFFff'>
/* "libchemicalstring_2.pyx":445
 * 
 * #reorder targets so they will match order of data lists
 * cdef follow_order(targets, count_targets):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	targs = []
 * 	[targs.append(targ) for targ in count_targets if targ in targets]
 */

static PyObject *__pyx_f_14stringchemical_follow_order(PyObject *__pyx_v_targets, PyObject *__pyx_v_count_targets) {
  PyObject *__pyx_v_targs = NULL;
  PyObject *__pyx_v_targ = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("follow_order", 0);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line446")'> 446: 	targs = []</pre>
<pre id='line446' class='code' style='background-color: #FFFFaa'>
  /* "libchemicalstring_2.pyx":446
 * #reorder targets so they will match order of data lists
 * cdef follow_order(targets, count_targets):
 * 	targs = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	[targs.append(targ) for targ in count_targets if targ in targets]
 * 	return targs
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_targs = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line447")'> 447: 	[targs.append(targ) for targ in count_targets if targ in targets]</pre>
<pre id='line447' class='code' style='background-color: #FFFF1f'>
  /* "libchemicalstring_2.pyx":447
 * cdef follow_order(targets, count_targets):
 * 	targs = []
 * 	[targs.append(targ) for targ in count_targets if targ in targets]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return targs
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_count_targets) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_count_targets)) {
    __pyx_t_2 = __pyx_v_count_targets; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_count_targets);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_4 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_4 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_targ);
    __pyx_v_targ = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_t_6 = (__Pyx_<span class='py_c_api'>PySequence_Contains</span>(__pyx_v_targ, __pyx_v_targets, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_6 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_7 = (__pyx_t_6 != 0);
    if (__pyx_t_7) {
      __pyx_t_8 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_targs, __pyx_v_targ);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_Owned_Py_None</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_5)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF28' onclick='toggleDiv("line448")'> 448: 	return targs</pre>
<pre id='line448' class='code' style='background-color: #FFFF28'>
  /* "libchemicalstring_2.pyx":448
 * 	targs = []
 * 	[targs.append(targ) for targ in count_targets if targ in targets]
 * 	return targs             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_targs));
  __pyx_r = ((PyObject *)__pyx_v_targs);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.follow_order", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_targs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_targ);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_21find_infinite_tail(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_21find_infinite_tail = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("find_infinite_tail"), (PyCFunction)__pyx_pw_14stringchemical_21find_infinite_tail, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_21find_infinite_tail(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_sequence = 0;
  PyObject *__pyx_v_ratio_res = 0;
  PyObject *__pyx_v_min_seq_length = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("find_infinite_tail (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__sequence,&__pyx_n_s__ratio_res,&__pyx_n_s__min_seq_length,0};
    PyObject* values[3] = {0,0,0};
    values[1] = __pyx_k_106;
    values[2] = ((PyObject *)__pyx_int_100);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__sequence)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ratio_res);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__min_seq_length);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "find_infinite_tail") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_sequence = values[0];
    __pyx_v_ratio_res = values[1];
    __pyx_v_min_seq_length = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_infinite_tail", 0, 1, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.find_infinite_tail", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_20find_infinite_tail(__pyx_self, __pyx_v_sequence, __pyx_v_ratio_res, __pyx_v_min_seq_length);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_18find_infinite_tail_1max_of_diff_splits(PyObject *__pyx_self, PyObject *__pyx_v_seq); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_18find_infinite_tail_1max_of_diff_splits = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("max_of_diff_splits"), (PyCFunction)__pyx_pw_14stringchemical_18find_infinite_tail_1max_of_diff_splits, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_18find_infinite_tail_1max_of_diff_splits(PyObject *__pyx_self, PyObject *__pyx_v_seq) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("max_of_diff_splits (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_18find_infinite_tail_max_of_diff_splits(__pyx_self, ((PyObject *)__pyx_v_seq));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line449")'> 449: </pre>
<pre id='line449' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line450")'> 450: </pre>
<pre id='line450' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line451")'> 451: </pre>
<pre id='line451' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line452")'> 452: #identifies a relatively huge jump in value in a sequence of values</pre>
<pre id='line452' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line453")'> 453: #used here to identify when time 'explodes' as the propensity of</pre>
<pre id='line453' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line454")'> 454: # every reaction approaches zero</pre>
<pre id='line454' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line455")'> 455: # - not called if end criteria are met</pre>
<pre id='line455' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line456")'> 456: def find_infinite_tail(sequence, ratio_res = 1.0, min_seq_length = 100):</pre>
<pre id='line456' class='code' style='background-color: #FFFF4f'>
/* "libchemicalstring_2.pyx":456
 * # every reaction approaches zero
 * # - not called if end criteria are met
 * def find_infinite_tail(sequence, ratio_res = 1.0, min_seq_length = 100):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def max_of_diff_splits(seq):
 */

static PyObject *__pyx_pf_14stringchemical_20find_infinite_tail(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_sequence, PyObject *__pyx_v_ratio_res, PyObject *__pyx_v_min_seq_length) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_10_find_infinite_tail *__pyx_cur_scope;
  PyObject *__pyx_v_max_of_diff_splits = 0;
  PyObject *__pyx_v_complete_deltas = NULL;
  PyObject *__pyx_v_ratio = NULL;
  PyObject *__pyx_v_ratio_threshold = NULL;
  PyObject *__pyx_v_split2 = NULL;
  PyObject *__pyx_v_split1 = NULL;
  PyObject *__pyx_v_max1 = NULL;
  PyObject *__pyx_v_max2 = NULL;
  PyObject *__pyx_v_last_good_dex = NULL;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("find_infinite_tail", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_10_find_infinite_tail *)__pyx_tp_new_14stringchemical___pyx_scope_struct_10_find_infinite_tail(__pyx_ptype_14stringchemical___pyx_scope_struct_10_find_infinite_tail, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);

  /* "libchemicalstring_2.pyx":456
 * # every reaction approaches zero
 * # - not called if end criteria are met
 * def find_infinite_tail(sequence, ratio_res = 1.0, min_seq_length = 100):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def max_of_diff_splits(seq):
 */
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_k_106 = __pyx_t_2;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "libchemicalstring_2.pyx":456
 * # every reaction approaches zero
 * # - not called if end criteria are met
 * def find_infinite_tail(sequence, ratio_res = 1.0, min_seq_length = 100):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def max_of_diff_splits(seq):
 */
  __pyx_k_tuple_210 = <span class='py_c_api'>PyTuple_Pack</span>(17, ((PyObject *)__pyx_n_s__sequence), ((PyObject *)__pyx_n_s__ratio_res), ((PyObject *)__pyx_n_s__min_seq_length), ((PyObject *)__pyx_n_s__max_of_diff_splits), ((PyObject *)__pyx_n_s__max_of_diff_splits), ((PyObject *)__pyx_n_s__complete_deltas), ((PyObject *)__pyx_n_s__deltas), ((PyObject *)__pyx_n_s__ratio), ((PyObject *)__pyx_n_s__ratio_threshold), ((PyObject *)__pyx_n_s__split2), ((PyObject *)__pyx_n_s__split1), ((PyObject *)__pyx_n_s__max1), ((PyObject *)__pyx_n_s__max2), ((PyObject *)__pyx_n_s__last_good_dex), ((PyObject *)__pyx_n_s__k), ((PyObject *)__pyx_n_s__genexpr), ((PyObject *)__pyx_n_s__genexpr));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_210)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_210);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_210));
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_21find_infinite_tail, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__find_infinite_tail, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_211 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(3, 0, 17, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_210, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__find_infinite_tail, 456, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_211)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":456
 * # every reaction approaches zero
 * # - not called if end criteria are met
 * def find_infinite_tail(sequence, ratio_res = 1.0, min_seq_length = 100):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def max_of_diff_splits(seq):
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_10_find_infinite_tail {
  PyObject_HEAD
  PyObject *__pyx_v_deltas;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line457")'> 457: </pre>
<pre id='line457' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line458")'> 458: 	def max_of_diff_splits(seq):</pre>
<pre id='line458' class='code' style='background-color: #FFFF73'>
/* "libchemicalstring_2.pyx":458
 * def find_infinite_tail(sequence, ratio_res = 1.0, min_seq_length = 100):
 * 
 * 	def max_of_diff_splits(seq):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		middle = len(seq)/2
 * 		split1 = seq[:middle]
 */

static PyObject *__pyx_pf_14stringchemical_18find_infinite_tail_max_of_diff_splits(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seq) {
  PyObject *__pyx_v_middle = NULL;
  PyObject *__pyx_v_split1 = NULL;
  PyObject *__pyx_v_split2 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("max_of_diff_splits", 0);

  /* "libchemicalstring_2.pyx":458
 * def find_infinite_tail(sequence, ratio_res = 1.0, min_seq_length = 100):
 * 
 * 	def max_of_diff_splits(seq):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		middle = len(seq)/2
 * 		split1 = seq[:middle]
 */
  __pyx_k_tuple_107 = <span class='py_c_api'>PyTuple_Pack</span>(4, ((PyObject *)__pyx_n_s__seq), ((PyObject *)__pyx_n_s__middle), ((PyObject *)__pyx_n_s__split1), ((PyObject *)__pyx_n_s__split2));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_107)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_107);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_107));

  /* "libchemicalstring_2.pyx":458
 * def find_infinite_tail(sequence, ratio_res = 1.0, min_seq_length = 100):
 * 
 * 	def max_of_diff_splits(seq):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		middle = len(seq)/2
 * 		split1 = seq[:middle]
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_18find_infinite_tail_1max_of_diff_splits, 0, __pyx_n_s_109, NULL, __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_108));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_max_of_diff_splits = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_108 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(1, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_107, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__max_of_diff_splits, 458, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_108)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line459")'> 459: 		middle = len(seq)/2</pre>
<pre id='line459' class='code' style='background-color: #FFFF7f'>
  /* "libchemicalstring_2.pyx":459
 * 
 * 	def max_of_diff_splits(seq):
 * 		middle = len(seq)/2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		split1 = seq[:middle]
 * 		split2 = seq[middle:]
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_seq);<span class='error_goto'> if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__Pyx_div_Py_ssize_t(__pyx_t_1, 2));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_v_middle = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line460")'> 460: 		split1 = seq[:middle]</pre>
<pre id='line460' class='code' style='background-color: #FFFFaa'>
  /* "libchemicalstring_2.pyx":460
 * 	def max_of_diff_splits(seq):
 * 		middle = len(seq)/2
 * 		split1 = seq[:middle]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		split2 = seq[middle:]
 * 		return split2, split1
 */
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_seq, 0, 0, NULL, &__pyx_v_middle, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_v_split1 = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line461")'> 461: 		split2 = seq[middle:]</pre>
<pre id='line461' class='code' style='background-color: #FFFFaa'>
  /* "libchemicalstring_2.pyx":461
 * 		middle = len(seq)/2
 * 		split1 = seq[:middle]
 * 		split2 = seq[middle:]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return split2, split1
 * 
 */
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_seq, 0, 0, &__pyx_v_middle, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 461; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_v_split2 = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line462")'> 462: 		return split2, split1</pre>
<pre id='line462' class='code' style='background-color: #FFFF5b'>
  /* "libchemicalstring_2.pyx":462
 * 		split1 = seq[:middle]
 * 		split2 = seq[middle:]
 * 		return split2, split1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	complete_deltas = [sequence[k] - sequence[k - 1] for k in
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_split2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_split2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_split2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_split1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_split1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_split1);
  __pyx_r = ((PyObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.find_infinite_tail.max_of_diff_splits", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_middle);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_split1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_split2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
static PyObject *__pyx_gb_14stringchemical_18find_infinite_tail_4generator(__pyx_GeneratorObject *__pyx_generator, PyObject *__pyx_sent_value); /* proto */
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line463")'> 463: </pre>
<pre id='line463' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line464")'> 464: 	complete_deltas = [sequence[k] - sequence[k - 1] for k in</pre>
<pre id='line464' class='code' style='background-color: #FFFF35'>
  /* "libchemicalstring_2.pyx":464
 * 		return split2, split1
 * 
 * 	complete_deltas = [sequence[k] - sequence[k - 1] for k in             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 									range(len(sequence))][1:]
 * 	if len(complete_deltas) == 0 or len(sequence) <code><</code> min_seq_length:
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);

    /* "libchemicalstring_2.pyx":464
 * 		return split2, split1
 * 
 * 	complete_deltas = [sequence[k] - sequence[k - 1] for k in             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 									range(len(sequence))][1:]
 * 	if len(complete_deltas) == 0 or len(sequence) <code><</code> min_seq_length:
 */
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_sequence, __pyx_v_k);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_k, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_7 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_sequence, __pyx_t_6);<span class='error_goto'> if (!__pyx_t_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_6)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyList_GetSlice</span>(((PyObject *)__pyx_t_1), 1, PY_SSIZE_T_MAX);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_v_complete_deltas = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line465")'> 465: 									range(len(sequence))][1:]</pre>
<pre id='line465' class='code' style='background-color: #FFFF1e'>
  /* "libchemicalstring_2.pyx":465
 * 
 * 	complete_deltas = [sequence[k] - sequence[k - 1] for k in
 * 									range(len(sequence))][1:]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	if len(complete_deltas) == 0 or len(sequence) <code><</code> min_seq_length:
 * 		return 0
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_sequence);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_4 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = Py_TYPE(__pyx_t_4)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (!__pyx_t_5 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_5 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_k);
    __pyx_v_k = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line466")'> 466: 	if len(complete_deltas) == 0 or len(sequence) &lt; min_seq_length:</pre>
<pre id='line466' class='code' style='background-color: #FFFF43'>
  /* "libchemicalstring_2.pyx":466
 * 	complete_deltas = [sequence[k] - sequence[k - 1] for k in
 * 									range(len(sequence))][1:]
 * 	if len(complete_deltas) == 0 or len(sequence) <code><</code> min_seq_length:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return 0
 * 
 */
  if (unlikely(((PyObject *)__pyx_v_complete_deltas) == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_2 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_complete_deltas));<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_8 = (__pyx_t_2 == 0);
  if (!__pyx_t_8) {
    __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_sequence);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_v_min_seq_length, Py_LT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_10 = __pyx_t_9;
  } else {
    __pyx_t_10 = __pyx_t_8;
  }
  if (__pyx_t_10) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line467")'> 467: 		return 0</pre>
<pre id='line467' class='code' style='background-color: #FFFFd4'>
    /* "libchemicalstring_2.pyx":467
 * 									range(len(sequence))][1:]
 * 	if len(complete_deltas) == 0 or len(sequence) <code><</code> min_seq_length:
 * 		return 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	deltas = complete_deltas
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_r = __pyx_int_0;
    goto __pyx_L0;
    goto __pyx_L5;
  }
  __pyx_L5:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line468")'> 468: </pre>
<pre id='line468' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line469")'> 469: 	deltas = complete_deltas</pre>
<pre id='line469' class='code' style='background-color: #FFFFe7'>
  /* "libchemicalstring_2.pyx":469
 * 		return 0
 * 
 * 	deltas = complete_deltas             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	ratio = max(deltas)/min(delt for delt in deltas if delt > 0.0)
 * 	ratio_threshold = ratio/ratio_res	#anticpate magnitude of jump
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_complete_deltas));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_complete_deltas));
  __pyx_cur_scope->__pyx_v_deltas = ((PyObject *)__pyx_v_complete_deltas);
</pre><pre class='line' style='background-color: #FFFF12' onclick='toggleDiv("line470")'> 470: 	ratio = max(deltas)/min(delt for delt in deltas if delt &gt; 0.0)</pre>
<pre id='line470' class='code' style='background-color: #FFFF12'>
/* "libchemicalstring_2.pyx":470
 * 
 * 	deltas = complete_deltas
 * 	ratio = max(deltas)/min(delt for delt in deltas if delt > 0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	ratio_threshold = ratio/ratio_res	#anticpate magnitude of jump
 * 	while ratio > ratio_threshold:
 */

static PyObject *__pyx_pf_14stringchemical_18find_infinite_tail_2genexpr(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_11_genexpr *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("genexpr", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_11_genexpr *)__pyx_tp_new_14stringchemical___pyx_scope_struct_11_genexpr(__pyx_ptype_14stringchemical___pyx_scope_struct_11_genexpr, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_10_find_infinite_tail *) __pyx_self;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_outer_scope);
  {
    __pyx_GeneratorObject *gen = <span class='pyx_c_api'>__Pyx_Generator_New</span>((__pyx_generator_body_t) __pyx_gb_14stringchemical_18find_infinite_tail_4generator, (PyObject *) __pyx_cur_scope);<span class='error_goto'> if (unlikely(!gen)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope);
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return (PyObject *) gen;
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.find_infinite_tail.genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

static PyObject *__pyx_gb_14stringchemical_18find_infinite_tail_4generator(__pyx_GeneratorObject *__pyx_generator, PyObject *__pyx_sent_value) /* generator body */
{
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("None", 0);
  __pyx_L3_first_run:;
  if (unlikely(!__pyx_sent_value))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_deltas)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("deltas");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_deltas) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_deltas)) {
    __pyx_t_1 = __pyx_cur_scope->__pyx_outer_scope->__pyx_v_deltas; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_deltas);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_3 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_3 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_cur_scope->__pyx_v_delt);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_cur_scope->__pyx_v_delt);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_cur_scope->__pyx_v_delt = __pyx_t_4;
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_cur_scope->__pyx_v_delt, __pyx_t_4, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_6 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_6) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_delt);
      __pyx_r = __pyx_cur_scope->__pyx_v_delt;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_1);
      __pyx_cur_scope->__pyx_t_0 = __pyx_t_1;
      __pyx_cur_scope->__pyx_t_1 = __pyx_t_2;
      __pyx_cur_scope->__pyx_t_2 = __pyx_t_3;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
      <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
      /* return from generator, yielding value */
      __pyx_generator->resume_label = 1;
      return __pyx_r;
      __pyx_L7_resume_from_yield:;
      __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
      __pyx_cur_scope->__pyx_t_0 = 0;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);
      __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
      __pyx_t_3 = __pyx_cur_scope->__pyx_t_2;
      if (unlikely(!__pyx_sent_value))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      goto __pyx_L6;
    }
    __pyx_L6:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='py_c_api'>PyErr_SetNone</span>(PyExc_StopIteration);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_generator->resume_label = -1;
  <span class='pyx_c_api'>__Pyx_Generator_clear</span>((PyObject*)__pyx_generator);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
}

  /* "libchemicalstring_2.pyx":470
 * 
 * 	deltas = complete_deltas
 * 	ratio = max(deltas)/min(delt for delt in deltas if delt > 0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	ratio_threshold = ratio/ratio_res	#anticpate magnitude of jump
 * 	while ratio > ratio_threshold:
 */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_deltas);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_cur_scope->__pyx_v_deltas);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_deltas);
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_max, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_pf_14stringchemical_18find_infinite_tail_2genexpr(((PyObject*)__pyx_cur_scope));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_min, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ratio = __pyx_t_6;
  __pyx_t_6 = 0;

/* "libchemicalstring_2.pyx":470
 * 
 * 	deltas = complete_deltas
 * 	ratio = max(deltas)/min(delt for delt in deltas if delt > 0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	ratio_threshold = ratio/ratio_res	#anticpate magnitude of jump
 * 	while ratio > ratio_threshold:
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_11_genexpr {
  PyObject_HEAD
  struct __pyx_obj_14stringchemical___pyx_scope_struct_10_find_infinite_tail *__pyx_outer_scope;
  PyObject *__pyx_v_delt;
  PyObject *__pyx_t_0;
  Py_ssize_t __pyx_t_1;
  PyObject *(*__pyx_t_2)(PyObject *);
};

</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line471")'> 471: 	ratio_threshold = ratio/ratio_res	#anticpate magnitude of jump</pre>
<pre id='line471' class='code' style='background-color: #FFFFaa'>
  /* "libchemicalstring_2.pyx":471
 * 	deltas = complete_deltas
 * 	ratio = max(deltas)/min(delt for delt in deltas if delt > 0.0)
 * 	ratio_threshold = ratio/ratio_res	#anticpate magnitude of jump             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	while ratio > ratio_threshold:
 * 		split2, split1 = max_of_diff_splits(deltas)
 */
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_v_ratio, __pyx_v_ratio_res);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_v_ratio_threshold = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line472")'> 472: 	while ratio &gt; ratio_threshold:</pre>
<pre id='line472' class='code' style='background-color: #FFFF79'>
  /* "libchemicalstring_2.pyx":472
 * 	ratio = max(deltas)/min(delt for delt in deltas if delt > 0.0)
 * 	ratio_threshold = ratio/ratio_res	#anticpate magnitude of jump
 * 	while ratio > ratio_threshold:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		split2, split1 = max_of_diff_splits(deltas)
 * 		try: max1 = max(split1); max2 = max(split2)
 */
  while (1) {
    __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_ratio, __pyx_v_ratio_threshold, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_10 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (!__pyx_t_10) break;
</pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line473")'> 473: 		split2, split1 = max_of_diff_splits(deltas)</pre>
<pre id='line473' class='code' style='background-color: #FFFF29'>
    /* "libchemicalstring_2.pyx":473
 * 	ratio_threshold = ratio/ratio_res	#anticpate magnitude of jump
 * 	while ratio > ratio_threshold:
 * 		split2, split1 = max_of_diff_splits(deltas)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		try: max1 = max(split1); max2 = max(split2)
 * 		except ValueError:
 */
    __pyx_t_6 = __pyx_cur_scope->__pyx_v_deltas;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    __pyx_t_1 = __pyx_pf_14stringchemical_18find_infinite_tail_max_of_diff_splits(__pyx_v_max_of_diff_splits, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      #else
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else
    {
      Py_ssize_t index = -1;
      __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_11 = Py_TYPE(__pyx_t_7)->tp_iternext;
      index = 0; __pyx_t_6 = __pyx_t_11(__pyx_t_7); if (unlikely(!__pyx_t_6)) goto __pyx_L8_unpacking_failed;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      index = 1; __pyx_t_4 = __pyx_t_11(__pyx_t_7); if (unlikely(!__pyx_t_4)) goto __pyx_L8_unpacking_failed;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_11(__pyx_t_7), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_11 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L9_unpacking_done;
      __pyx_L8_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_11 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_L9_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_split2);
    __pyx_v_split2 = __pyx_t_6;
    __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_split1);
    __pyx_v_split1 = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line474")'> 474: 		try: max1 = max(split1); max2 = max(split2)</pre>
<pre id='line474' class='code' style='background-color: #FFFF35'>
    /* "libchemicalstring_2.pyx":474
 * 	while ratio > ratio_threshold:
 * 		split2, split1 = max_of_diff_splits(deltas)
 * 		try: max1 = max(split1); max2 = max(split2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		except ValueError:
 * 			print 'failed to find that tail!'
 */
    {
      <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_12, &__pyx_t_13, &__pyx_t_14);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_12);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_13);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_14);
      /*try:*/ {
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L10_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_split1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_split1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_split1);
        __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_max, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L10_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_max1);
        __pyx_v_max1 = __pyx_t_4;
        __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L10_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_split2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_split2);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_split2);
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_max, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L10_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_max2);
        __pyx_v_max2 = __pyx_t_1;
        __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      goto __pyx_L17_try_end;
      __pyx_L10_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line475")'> 475: 		except ValueError:</pre>
<pre id='line475' class='code' style='background-color: #FFFF86'>
      /* "libchemicalstring_2.pyx":475
 * 		split2, split1 = max_of_diff_splits(deltas)
 * 		try: max1 = max(split1); max2 = max(split2)
 * 		except ValueError:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			print 'failed to find that tail!'
 * 			return -1
 */
      __pyx_t_15 = <span class='py_c_api'>PyErr_ExceptionMatches</span>(__pyx_builtin_ValueError);
      if (__pyx_t_15) {
        <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.find_infinite_tail", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_1, &__pyx_t_4, &__pyx_t_6) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 475; __pyx_clineno = __LINE__; goto __pyx_L12_except_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line476")'> 476: 			print 'failed to find that tail!'</pre>
<pre id='line476' class='code' style='background-color: #FFFFd4'>
        /* "libchemicalstring_2.pyx":476
 * 		try: max1 = max(split1); max2 = max(split2)
 * 		except ValueError:
 * 			print 'failed to find that tail!'             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			return -1
 * 
 */
        if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, ((PyObject *)__pyx_kp_s_110)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L12_except_error;}</span>
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line477")'> 477: 			return -1</pre>
<pre id='line477' class='code' style='background-color: #FFFF6a'>
        /* "libchemicalstring_2.pyx":477
 * 		except ValueError:
 * 			print 'failed to find that tail!'
 * 			return -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		if max2/max1 > ratio_threshold: deltas = split2
 */
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
        __pyx_r = __pyx_int_neg_1;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        goto __pyx_L13_except_return;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        goto __pyx_L11_exception_handled;
      }
      __pyx_L12_except_error:;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_12);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_13);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_14);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_12, __pyx_t_13, __pyx_t_14);
      goto __pyx_L1_error;
      __pyx_L13_except_return:;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_12);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_13);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_14);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_12, __pyx_t_13, __pyx_t_14);
      goto __pyx_L0;
      __pyx_L11_exception_handled:;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_12);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_13);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_14);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_12, __pyx_t_13, __pyx_t_14);
      __pyx_L17_try_end:;
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line478")'> 478: </pre>
<pre id='line478' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line479")'> 479: 		if max2/max1 &gt; ratio_threshold: deltas = split2</pre>
<pre id='line479' class='code' style='background-color: #FFFF57'>
    /* "libchemicalstring_2.pyx":479
 * 			return -1
 * 
 * 		if max2/max1 > ratio_threshold: deltas = split2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		else: deltas = split1
 * 		ratio = max(deltas)/min(deltas)
 */
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_v_max2, __pyx_v_max1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_v_ratio_threshold, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_10 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_10 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_10) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_split2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope->__pyx_v_deltas);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope->__pyx_v_deltas);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_split2);
      __pyx_cur_scope->__pyx_v_deltas = __pyx_v_split2;
      goto __pyx_L20;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line480")'> 480: 		else: deltas = split1</pre>
<pre id='line480' class='code' style='background-color: #FFFFd4'>
      /* "libchemicalstring_2.pyx":480
 * 
 * 		if max2/max1 > ratio_threshold: deltas = split2
 * 		else: deltas = split1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		ratio = max(deltas)/min(deltas)
 * 
 */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_split1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope->__pyx_v_deltas);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope->__pyx_v_deltas);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_split1);
      __pyx_cur_scope->__pyx_v_deltas = __pyx_v_split1;
    }
    __pyx_L20:;
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line481")'> 481: 		ratio = max(deltas)/min(deltas)</pre>
<pre id='line481' class='code' style='background-color: #FFFF39'>
    /* "libchemicalstring_2.pyx":481
 * 		if max2/max1 > ratio_threshold: deltas = split2
 * 		else: deltas = split1
 * 		ratio = max(deltas)/min(deltas)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	last_good_dex = complete_deltas.index(deltas[-1])
 */
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_deltas);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_cur_scope->__pyx_v_deltas);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_deltas);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_max, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_deltas);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_cur_scope->__pyx_v_deltas);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_deltas);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_min, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_6, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_ratio);
    __pyx_v_ratio = __pyx_t_4;
    __pyx_t_4 = 0;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line482")'> 482: </pre>
<pre id='line482' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line483")'> 483: 	last_good_dex = complete_deltas.index(deltas[-1])</pre>
<pre id='line483' class='code' style='background-color: #FFFF55'>
  /* "libchemicalstring_2.pyx":483
 * 		ratio = max(deltas)/min(deltas)
 * 
 * 	last_good_dex = complete_deltas.index(deltas[-1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	return last_good_dex + 1
 * 
 */
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_complete_deltas), __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_deltas, -1, sizeof(long), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  __pyx_v_last_good_dex = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line484")'> 484: 	return last_good_dex + 1</pre>
<pre id='line484' class='code' style='background-color: #FFFF46'>
  /* "libchemicalstring_2.pyx":484
 * 
 * 	last_good_dex = complete_deltas.index(deltas[-1])
 * 	return last_good_dex + 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_last_good_dex, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.find_infinite_tail", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_max_of_diff_splits);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_complete_deltas);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ratio);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ratio_threshold);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_split2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_split1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_max1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_max2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_last_good_dex);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line485")'> 485: </pre>
<pre id='line485' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line486")'> 486: </pre>
<pre id='line486' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line487")'> 487: </pre>
<pre id='line487' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line488")'> 488: #indentifies the last data capture before the reactions occur</pre>
<pre id='line488' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line489")'> 489: # incredibly spaced out in time (relative to the majority of the data)</pre>
<pre id='line489' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line490")'> 490: cdef inline validate_data(data, int dex):</pre>
<pre id='line490' class='code' style='background-color: #FFFFff'>
/* "libchemicalstring_2.pyx":490
 * #indentifies the last data capture before the reactions occur
 * # incredibly spaced out in time (relative to the majority of the data)
 * cdef inline validate_data(data, int dex):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef int validex
 * 	validex = find_infinite_tail(data[dex])
 */

static CYTHON_INLINE PyObject *__pyx_f_14stringchemical_validate_data(PyObject *__pyx_v_data, int __pyx_v_dex) {
  int __pyx_v_validex;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("validate_data", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line491")'> 491: 	cdef int validex</pre>
<pre id='line491' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line492")'> 492: 	validex = find_infinite_tail(data[dex])</pre>
<pre id='line492' class='code' style='background-color: #FFFF43'>
  /* "libchemicalstring_2.pyx":492
 * cdef inline validate_data(data, int dex):
 * 	cdef int validex
 * 	validex = find_infinite_tail(data[dex])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	if validex <code><</code> 100: return len(data[dex]) - 10
 * 	else: return validex
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__find_infinite_tail);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_data, __pyx_v_dex, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_validex = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line493")'> 493: 	if validex &lt; 100: return len(data[dex]) - 10</pre>
<pre id='line493' class='code' style='background-color: #FFFF6a'>
  /* "libchemicalstring_2.pyx":493
 * 	cdef int validex
 * 	validex = find_infinite_tail(data[dex])
 * 	if validex <code><</code> 100: return len(data[dex]) - 10             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	else: return validex
 * 
 */
  __pyx_t_5 = ((__pyx_v_validex <code><</code> 100) != 0);
  if (__pyx_t_5) {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_data, __pyx_v_dex, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_t_6 - 10));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line494")'> 494: 	else: return validex</pre>
<pre id='line494' class='code' style='background-color: #FFFF1f'>
    /* "libchemicalstring_2.pyx":494
 * 	validex = find_infinite_tail(data[dex])
 * 	if validex <code><</code> 100: return len(data[dex]) - 10
 * 	else: return validex             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_validex);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }
  __pyx_L3:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.validate_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_23generate_test(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_23generate_test = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("generate_test"), (PyCFunction)__pyx_pw_14stringchemical_23generate_test, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_23generate_test(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_count_targets = 0;
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_counts = 0;
  PyObject *__pyx_v_split = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_test (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__count_targets,&__pyx_n_s__data,&__pyx_n_s__counts,&__pyx_n_s__split,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__count_targets)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__data)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_test", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__counts)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_test", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__split)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_test", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "generate_test") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_count_targets = values[0];
    __pyx_v_data = values[1];
    __pyx_v_counts = values[2];
    __pyx_v_split = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_test", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_test", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_22generate_test(__pyx_self, __pyx_v_count_targets, __pyx_v_data, __pyx_v_counts, __pyx_v_split);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_13generate_test_1make_and_condition(PyObject *__pyx_self, PyObject *__pyx_v_tests); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_13generate_test_1make_and_condition = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("make_and_condition"), (PyCFunction)__pyx_pw_14stringchemical_13generate_test_1make_and_condition, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_13generate_test_1make_and_condition(PyObject *__pyx_self, PyObject *__pyx_v_tests) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_and_condition (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_13generate_test_make_and_condition(__pyx_self, ((PyObject *)__pyx_v_tests));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_13generate_test_18make_and_condition_1and_condition(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_13generate_test_18make_and_condition_1and_condition = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("and_condition"), (PyCFunction)__pyx_pw_14stringchemical_13generate_test_18make_and_condition_1and_condition, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_13generate_test_18make_and_condition_1and_condition(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("and_condition (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_13generate_test_18make_and_condition_and_condition(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line495")'> 495: </pre>
<pre id='line495' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line496")'> 496: </pre>
<pre id='line496' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line497")'> 497: </pre>
<pre id='line497' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line498")'> 498: #used to generate functions for capture and end criteria tests</pre>
<pre id='line498' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line499")'> 499: def generate_test(count_targets, data, counts, split):</pre>
<pre id='line499' class='code' style='background-color: #FFFF62'>
/* "libchemicalstring_2.pyx":499
 * 
 * #used to generate functions for capture and end criteria tests
 * def generate_test(count_targets, data, counts, split):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#create a function which returns True if all tests return True
 */

static PyObject *__pyx_pf_14stringchemical_22generate_test(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_count_targets, PyObject *__pyx_v_data, PyObject *__pyx_v_counts, PyObject *__pyx_v_split) {
  PyObject *__pyx_v_make_and_condition = 0;
  PyObject *__pyx_v_tests = NULL;
  PyObject *__pyx_v_spl = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_test", 0);

  /* "libchemicalstring_2.pyx":499
 * 
 * #used to generate functions for capture and end criteria tests
 * def generate_test(count_targets, data, counts, split):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#create a function which returns True if all tests return True
 */
  __pyx_k_tuple_212 = <span class='py_c_api'>PyTuple_Pack</span>(8, ((PyObject *)__pyx_n_s__count_targets), ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_n_s__split), ((PyObject *)__pyx_n_s__make_and_condition), ((PyObject *)__pyx_n_s__make_and_condition), ((PyObject *)__pyx_n_s__tests), ((PyObject *)__pyx_n_s__spl));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_212)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_212);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_212));

  /* "libchemicalstring_2.pyx":499
 * 
 * #used to generate functions for capture and end criteria tests
 * def generate_test(count_targets, data, counts, split):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#create a function which returns True if all tests return True
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_23generate_test, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__generate_test, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_213 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(4, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_212, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__generate_test, 499, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_213)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line500")'> 500: </pre>
<pre id='line500' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line501")'> 501: 	#create a function which returns True if all tests return True</pre>
<pre id='line501' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line502")'> 502: 	# and False otherwise</pre>
<pre id='line502' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line503")'> 503: 	def make_and_condition(tests):</pre>
<pre id='line503' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":503
 * 	#create a function which returns True if all tests return True
 * 	# and False otherwise
 * 	def make_and_condition(tests):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		def and_condition():
 */

static PyObject *__pyx_pf_14stringchemical_13generate_test_make_and_condition(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tests) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_12_make_and_condition *__pyx_cur_scope;
  PyObject *__pyx_v_and_condition = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("make_and_condition", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_12_make_and_condition *)__pyx_tp_new_14stringchemical___pyx_scope_struct_12_make_and_condition(__pyx_ptype_14stringchemical___pyx_scope_struct_12_make_and_condition, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_tests = __pyx_v_tests;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_tests);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_tests);

  /* "libchemicalstring_2.pyx":503
 * 	#create a function which returns True if all tests return True
 * 	# and False otherwise
 * 	def make_and_condition(tests):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		def and_condition():
 */
  __pyx_k_tuple_114 = <span class='py_c_api'>PyTuple_Pack</span>(3, ((PyObject *)__pyx_n_s__tests), ((PyObject *)__pyx_n_s__and_condition), ((PyObject *)__pyx_n_s__and_condition));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_114)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_114);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_114));

  /* "libchemicalstring_2.pyx":503
 * 	#create a function which returns True if all tests return True
 * 	# and False otherwise
 * 	def make_and_condition(tests):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		def and_condition():
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_13generate_test_1make_and_condition, 0, __pyx_n_s_116, NULL, __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_115));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_make_and_condition = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_115 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_114, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__make_and_condition, 503, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_115)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":503
 * 	#create a function which returns True if all tests return True
 * 	# and False otherwise
 * 	def make_and_condition(tests):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		def and_condition():
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_12_make_and_condition {
  PyObject_HEAD
  PyObject *__pyx_v_tests;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line504")'> 504: </pre>
<pre id='line504' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line505")'> 505: 		def and_condition():</pre>
<pre id='line505' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":505
 * 	def make_and_condition(tests):
 * 
 * 		def and_condition():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			return False not in [test() for test in tests]
 * 
 */

static PyObject *__pyx_pf_14stringchemical_13generate_test_18make_and_condition_and_condition(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_12_make_and_condition *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct_12_make_and_condition *__pyx_outer_scope;
  PyObject *__pyx_v_test = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("and_condition", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_12_make_and_condition *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":505
 * 	def make_and_condition(tests):
 * 
 * 		def and_condition():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			return False not in [test() for test in tests]
 * 
 */
  __pyx_k_tuple_111 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_n_s__test));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_111)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 505; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_111);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_111));

  /* "libchemicalstring_2.pyx":505
 * 	def make_and_condition(tests):
 * 
 * 		def and_condition():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			return False not in [test() for test in tests]
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_13generate_test_18make_and_condition_1and_condition, 0, __pyx_n_s_113, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_112));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 505; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_and_condition = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_112 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_111, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__and_condition, 505, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_112)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 505; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF18' onclick='toggleDiv("line506")'> 506: 			return False not in [test() for test in tests]</pre>
<pre id='line506' class='code' style='background-color: #FFFF18'>
  /* "libchemicalstring_2.pyx":506
 * 
 * 		def and_condition():
 * 			return False not in [test() for test in tests]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		return and_condition
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (unlikely(!__pyx_cur_scope->__pyx_v_tests)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("tests");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_cur_scope->__pyx_v_tests) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_cur_scope->__pyx_v_tests)) {
    __pyx_t_3 = __pyx_cur_scope->__pyx_v_tests; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_cur_scope->__pyx_v_tests);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_5 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_5 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_6 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_6)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_test);
    __pyx_v_test = __pyx_t_6;
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_v_test, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_2, (PyObject*)__pyx_t_6)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = (__Pyx_<span class='py_c_api'>PySequence_Contains</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), Py_NE));<span class='error_goto'> if (unlikely(__pyx_t_7 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_test.make_and_condition.and_condition", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_test);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line507")'> 507: </pre>
<pre id='line507' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line508")'> 508: 		return and_condition</pre>
<pre id='line508' class='code' style='background-color: #FFFF86'>
  /* "libchemicalstring_2.pyx":508
 * 			return False not in [test() for test in tests]
 * 
 * 		return and_condition             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#only create AND logic wrapper if 2+ tests specified in split
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_and_condition);
  __pyx_r = __pyx_v_and_condition;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_test.make_and_condition", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_and_condition);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line509")'> 509: </pre>
<pre id='line509' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line510")'> 510: 	#only create AND logic wrapper if 2+ tests specified in split</pre>
<pre id='line510' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line511")'> 511: 	if len(split) &gt; 1:</pre>
<pre id='line511' class='code' style='background-color: #FFFFaa'>
  /* "libchemicalstring_2.pyx":511
 * 
 * 	#only create AND logic wrapper if 2+ tests specified in split
 * 	if len(split) > 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		tests = [make_test(counts,
 * 			data, count_targets, spl)
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_split);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = ((__pyx_t_2 > 1) != 0);
  if (__pyx_t_3) {
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line512")'> 512: 		tests = [make_test(counts,</pre>
<pre id='line512' class='code' style='background-color: #FFFF96'>
    /* "libchemicalstring_2.pyx":512
 * 	#only create AND logic wrapper if 2+ tests specified in split
 * 	if len(split) > 1:
 * 		tests = [make_test(counts,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			data, count_targets, spl)
 * 					for spl in split]
 */
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);

      /* "libchemicalstring_2.pyx":512
 * 	#only create AND logic wrapper if 2+ tests specified in split
 * 	if len(split) > 1:
 * 		tests = [make_test(counts,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			data, count_targets, spl)
 * 					for spl in split]
 */
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__make_test);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line513")'> 513: 			data, count_targets, spl)</pre>
<pre id='line513' class='code' style='background-color: #FFFF4b'>
      /* "libchemicalstring_2.pyx":513
 * 	if len(split) > 1:
 * 		tests = [make_test(counts,
 * 			data, count_targets, spl)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 					for spl in split]
 * 		return make_and_condition(tests)
 */
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_counts);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_data);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_count_targets);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_v_count_targets);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_count_targets);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_spl);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3, __pyx_v_spl);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_spl);
      __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_8)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_tests = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line514")'> 514: 					for spl in split]</pre>
<pre id='line514' class='code' style='background-color: #FFFF2a'>
    /* "libchemicalstring_2.pyx":514
 * 		tests = [make_test(counts,
 * 			data, count_targets, spl)
 * 					for spl in split]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		return make_and_condition(tests)
 * 
 */
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_split) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_split)) {
      __pyx_t_4 = __pyx_v_split; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2 = 0;
      __pyx_t_5 = NULL;
    } else {
      __pyx_t_2 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_split);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_5 = Py_TYPE(__pyx_t_4)->tp_iternext;
    }
    for (;;) {
      if (!__pyx_t_5 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) {
        if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_5 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
        if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_6 = __pyx_t_5(__pyx_t_4);
        if (unlikely(!__pyx_t_6)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_spl);
      __pyx_v_spl = __pyx_t_6;
      __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line515")'> 515: 		return make_and_condition(tests)</pre>
<pre id='line515' class='code' style='background-color: #FFFFe7'>
    /* "libchemicalstring_2.pyx":515
 * 			data, count_targets, spl)
 * 					for spl in split]
 * 		return make_and_condition(tests)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#if only one test specified, return the unwrapped test function
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = __pyx_pf_14stringchemical_13generate_test_make_and_condition(__pyx_v_make_and_condition, ((PyObject *)__pyx_v_tests));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line516")'> 516: </pre>
<pre id='line516' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line517")'> 517: 	#if only one test specified, return the unwrapped test function</pre>
<pre id='line517' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1b' onclick='toggleDiv("line518")'> 518: 	else: return make_test(counts, data, count_targets, split[0])</pre>
<pre id='line518' class='code' style='background-color: #FFFF1b'>
    /* "libchemicalstring_2.pyx":518
 * 
 * 	#if only one test specified, return the unwrapped test function
 * 	else: return make_test(counts, data, count_targets, split[0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__make_test);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_split, 0, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_counts);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_data);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_count_targets);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_v_count_targets);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_count_targets);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 3, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }
  __pyx_L3:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_test", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_make_and_condition);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tests);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_spl);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_25generate_capture_function(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_25generate_capture_function = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("generate_capture_function"), (PyCFunction)__pyx_pw_14stringchemical_25generate_capture_function, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_25generate_capture_function(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_target_dexes = 0;
  PyObject *__pyx_v_counts = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_capture_function (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__data,&__pyx_n_s__target_dexes,&__pyx_n_s__counts,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__data)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_dexes)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_capture_function", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__counts)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_capture_function", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "generate_capture_function") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_data = values[0];
    __pyx_v_target_dexes = values[1];
    __pyx_v_counts = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_capture_function", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_capture_function", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_24generate_capture_function(__pyx_self, __pyx_v_data, __pyx_v_target_dexes, __pyx_v_counts);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_25generate_capture_function_1capture(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_25generate_capture_function_1capture = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("capture"), (PyCFunction)__pyx_pw_14stringchemical_25generate_capture_function_1capture, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_25generate_capture_function_1capture(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("capture (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_25generate_capture_function_capture(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line519")'> 519: </pre>
<pre id='line519' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line520")'> 520: </pre>
<pre id='line520' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line521")'> 521: </pre>
<pre id='line521' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line522")'> 522: #appends the appropriate values of the counts vector</pre>
<pre id='line522' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line523")'> 523: # to the appropriate data lists in the data structure</pre>
<pre id='line523' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line524")'> 524: def generate_capture_function(data, target_dexes, counts):</pre>
<pre id='line524' class='code' style='background-color: #FFFF55'>
/* "libchemicalstring_2.pyx":524
 * #appends the appropriate values of the counts vector
 * # to the appropriate data lists in the data structure
 * def generate_capture_function(data, target_dexes, counts):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def capture():
 */

static PyObject *__pyx_pf_14stringchemical_24generate_capture_function(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_target_dexes, PyObject *__pyx_v_counts) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_13_generate_capture_function *__pyx_cur_scope;
  PyObject *__pyx_v_capture = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_capture_function", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_13_generate_capture_function *)__pyx_tp_new_14stringchemical___pyx_scope_struct_13_generate_capture_function(__pyx_ptype_14stringchemical___pyx_scope_struct_13_generate_capture_function, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_data = __pyx_v_data;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_data);
  __pyx_cur_scope->__pyx_v_target_dexes = __pyx_v_target_dexes;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_target_dexes);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_target_dexes);
  __pyx_cur_scope->__pyx_v_counts = __pyx_v_counts;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);

  /* "libchemicalstring_2.pyx":524
 * #appends the appropriate values of the counts vector
 * # to the appropriate data lists in the data structure
 * def generate_capture_function(data, target_dexes, counts):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def capture():
 */
  __pyx_k_tuple_214 = <span class='py_c_api'>PyTuple_Pack</span>(5, ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__target_dexes), ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_n_s__capture), ((PyObject *)__pyx_n_s__capture));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_214)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_214);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_214));

  /* "libchemicalstring_2.pyx":524
 * #appends the appropriate values of the counts vector
 * # to the appropriate data lists in the data structure
 * def generate_capture_function(data, target_dexes, counts):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def capture():
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_25generate_capture_function, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_153, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_215 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(3, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_214, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s_153, 524, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_215)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":524
 * #appends the appropriate values of the counts vector
 * # to the appropriate data lists in the data structure
 * def generate_capture_function(data, target_dexes, counts):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	def capture():
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_13_generate_capture_function {
  PyObject_HEAD
  PyObject *__pyx_v_counts;
  PyObject *__pyx_v_data;
  PyObject *__pyx_v_target_dexes;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line525")'> 525: </pre>
<pre id='line525' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line526")'> 526: 	def capture():</pre>
<pre id='line526' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":526
 * def generate_capture_function(data, target_dexes, counts):
 * 
 * 	def capture():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		values = [counts[dex] for dex in target_dexes]
 * 		[data[dex].append(value) for dex, value in
 */

static PyObject *__pyx_pf_14stringchemical_25generate_capture_function_capture(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_13_generate_capture_function *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct_13_generate_capture_function *__pyx_outer_scope;
  PyObject *__pyx_v_values = NULL;
  PyObject *__pyx_v_dex = NULL;
  PyObject *__pyx_v_value = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("capture", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_13_generate_capture_function *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":526
 * def generate_capture_function(data, target_dexes, counts):
 * 
 * 	def capture():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		values = [counts[dex] for dex in target_dexes]
 * 		[data[dex].append(value) for dex, value in
 */
  __pyx_k_tuple_117 = <span class='py_c_api'>PyTuple_Pack</span>(3, ((PyObject *)__pyx_n_s__values), ((PyObject *)__pyx_n_s__dex), ((PyObject *)__pyx_n_s__value));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_117)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_117);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_117));

  /* "libchemicalstring_2.pyx":526
 * def generate_capture_function(data, target_dexes, counts):
 * 
 * 	def capture():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		values = [counts[dex] for dex in target_dexes]
 * 		[data[dex].append(value) for dex, value in
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_25generate_capture_function_1capture, 0, __pyx_n_s_119, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_118));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_capture = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_118 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_117, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__capture, 526, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_118)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line527")'> 527: 		values = [counts[dex] for dex in target_dexes]</pre>
<pre id='line527' class='code' style='background-color: #FFFF20'>
  /* "libchemicalstring_2.pyx":527
 * 
 * 	def capture():
 * 		values = [counts[dex] for dex in target_dexes]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		[data[dex].append(value) for dex, value in
 * 						zip(target_dexes, values)]
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (unlikely(!__pyx_cur_scope->__pyx_v_target_dexes)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("target_dexes");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_cur_scope->__pyx_v_target_dexes) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_cur_scope->__pyx_v_target_dexes)) {
    __pyx_t_2 = __pyx_cur_scope->__pyx_v_target_dexes; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_cur_scope->__pyx_v_target_dexes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_4 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_4 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex);
    __pyx_v_dex = __pyx_t_5;
    __pyx_t_5 = 0;
    if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_v_dex);<span class='error_goto'> if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_5)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_values = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line528")'> 528: 		[data[dex].append(value) for dex, value in</pre>
<pre id='line528' class='code' style='background-color: #FFFF35'>
  /* "libchemicalstring_2.pyx":528
 * 	def capture():
 * 		values = [counts[dex] for dex in target_dexes]
 * 		[data[dex].append(value) for dex, value in             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 						zip(target_dexes, values)]
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);

    /* "libchemicalstring_2.pyx":528
 * 	def capture():
 * 		values = [counts[dex] for dex in target_dexes]
 * 		[data[dex].append(value) for dex, value in             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 						zip(target_dexes, values)]
 * 
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex);
    __pyx_v_dex = __pyx_t_6;
    __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value);
    __pyx_v_value = __pyx_t_7;
    __pyx_t_7 = 0;
    if (unlikely(!__pyx_cur_scope->__pyx_v_data)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("data");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_cur_scope->__pyx_v_data, __pyx_v_dex);<span class='error_goto'> if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyObject_Append</span>(__pyx_t_5, __pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_7)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_capture_function.capture", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_values);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF14' onclick='toggleDiv("line529")'> 529: 						zip(target_dexes, values)]</pre>
<pre id='line529' class='code' style='background-color: #FFFF14'>
  /* "libchemicalstring_2.pyx":529
 * 		values = [counts[dex] for dex in target_dexes]
 * 		[data[dex].append(value) for dex, value in
 * 						zip(target_dexes, values)]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	return capture
 */
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_target_dexes);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_cur_scope->__pyx_v_target_dexes);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_target_dexes);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_values));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_values));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_values));
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_zip, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5)) {
    __pyx_t_2 = __pyx_t_5; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  for (;;) {
    if (!__pyx_t_4 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_4 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
      PyObject* sequence = __pyx_t_5;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      #else
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    {
      Py_ssize_t index = -1;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_9 = Py_TYPE(__pyx_t_8)->tp_iternext;
      index = 0; __pyx_t_6 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_6)) goto __pyx_L7_unpacking_failed;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      index = 1; __pyx_t_7 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_7)) goto __pyx_L7_unpacking_failed;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_8), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L8_unpacking_done;
      __pyx_L7_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_L8_unpacking_done:;
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line530")'> 530: </pre>
<pre id='line530' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line531")'> 531: 	return capture</pre>
<pre id='line531' class='code' style='background-color: #FFFF86'>
  /* "libchemicalstring_2.pyx":531
 * 						zip(target_dexes, values)]
 * 
 * 	return capture             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_capture);
  __pyx_r = __pyx_v_capture;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_capture_function", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_capture);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line532")'> 532: </pre>
<pre id='line532' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line533")'> 533: </pre>
<pre id='line533' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line534")'> 534: </pre>
<pre id='line534' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line535")'> 535: #@cython.boundscheck(False) # turn of bounds-checking for entire function</pre>
<pre id='line535' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line536")'> 536: #@cython.cdivision(False)</pre>
<pre id='line536' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line537")'> 537: cdef inline int pick_reaction(double [:] table, double rand, int leng):</pre>
<pre id='line537' class='code' style='background-color: #FFFFff'>
/* "libchemicalstring_2.pyx":537
 * #@cython.boundscheck(False) # turn of bounds-checking for entire function
 * #@cython.cdivision(False)
 * cdef inline int pick_reaction(double [:] table, double rand, int leng):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef int dex
 * 	for dex in range(leng):
 */

static CYTHON_INLINE int __pyx_f_14stringchemical_pick_reaction(__Pyx_memviewslice __pyx_v_table, double __pyx_v_rand, int __pyx_v_leng) {
  int __pyx_v_dex;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("pick_reaction", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line538")'> 538: 	cdef int dex</pre>
<pre id='line538' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line539")'> 539: 	for dex in range(leng):</pre>
<pre id='line539' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":539
 * cdef inline int pick_reaction(double [:] table, double rand, int leng):
 * 	cdef int dex
 * 	for dex in range(leng):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		if rand <code><</code> table[dex]:
 * 			return dex
 */
  __pyx_t_1 = __pyx_v_leng;
  for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_dex = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line540")'> 540: 		if rand &lt; table[dex]:</pre>
<pre id='line540' class='code' style='background-color: #FFFFd4'>
    /* "libchemicalstring_2.pyx":540
 * 	cdef int dex
 * 	for dex in range(leng):
 * 		if rand <code><</code> table[dex]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			return dex
 * 
 */
    __pyx_t_3 = __pyx_v_dex;
    __pyx_t_4 = -1;
    if (__pyx_t_3 <code><</code> 0) {
      __pyx_t_3 += __pyx_v_table.shape[0];
      if (unlikely(__pyx_t_3 <code><</code> 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_3 >= __pyx_v_table.shape[0])) __pyx_t_4 = 0;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 540; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_5 = ((__pyx_v_rand <code><</code> (*((double *) ( /* dim=0 */ (__pyx_v_table.data + __pyx_t_3 * __pyx_v_table.strides[0]) )))) != 0);
    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF25' onclick='toggleDiv("line541")'> 541: 			return dex</pre>
<pre id='line541' class='code' style='background-color: #FFFF25'>
      /* "libchemicalstring_2.pyx":541
 * 	for dex in range(leng):
 * 		if rand <code><</code> table[dex]:
 * 			return dex             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
      __pyx_r = __pyx_v_dex;
      goto __pyx_L0;
      goto __pyx_L5;
    }
    __pyx_L5:;
  }

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("stringchemical.pick_reaction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_27generate_update_functions(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_27generate_update_functions = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("generate_update_functions"), (PyCFunction)__pyx_pw_14stringchemical_27generate_update_functions, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_27generate_update_functions(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_count_targets = 0;
  PyObject *__pyx_v_counts = 0;
  PyObject *__pyx_v_functions = 0;
  PyObject *__pyx_v_func_names = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_update_functions (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__count_targets,&__pyx_n_s__counts,&__pyx_n_s__functions,&__pyx_n_s__func_names,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__count_targets)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__counts)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_update_functions", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__functions)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_update_functions", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__func_names)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_update_functions", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "generate_update_functions") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_count_targets = values[0];
    __pyx_v_counts = values[1];
    __pyx_v_functions = values[2];
    __pyx_v_func_names = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("generate_update_functions", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_update_functions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_26generate_update_functions(__pyx_self, __pyx_v_count_targets, __pyx_v_counts, __pyx_v_functions, __pyx_v_func_names);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_25generate_update_functions_1dummy(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_25generate_update_functions_1dummy = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("dummy"), (PyCFunction)__pyx_pw_14stringchemical_25generate_update_functions_1dummy, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_25generate_update_functions_1dummy(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("dummy (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_25generate_update_functions_dummy(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line542")'> 542: </pre>
<pre id='line542' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line543")'> 543: </pre>
<pre id='line543' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line544")'> 544: </pre>
<pre id='line544' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line545")'> 545: #create a function which updates the current functions' values</pre>
<pre id='line545' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line546")'> 546: def generate_update_functions(count_targets, counts,</pre>
<pre id='line546' class='code' style='background-color: #FFFF52'>
/* "libchemicalstring_2.pyx":546
 * 
 * #create a function which updates the current functions' values
 * def generate_update_functions(count_targets, counts,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 							functions, func_names):
 * 
 */

static PyObject *__pyx_pf_14stringchemical_26generate_update_functions(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_count_targets, PyObject *__pyx_v_counts, PyObject *__pyx_v_functions, PyObject *__pyx_v_func_names) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_14_generate_update_functions *__pyx_cur_scope;
  PyObject *__pyx_v_dummy = 0;
  PyObject *__pyx_v_update_function = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("generate_update_functions", 0);
  __pyx_cur_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_14_generate_update_functions *)__pyx_tp_new_14stringchemical___pyx_scope_struct_14_generate_update_functions(__pyx_ptype_14stringchemical___pyx_scope_struct_14_generate_update_functions, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_count_targets = __pyx_v_count_targets;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_count_targets);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_count_targets);
  __pyx_cur_scope->__pyx_v_counts = __pyx_v_counts;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);
  __pyx_cur_scope->__pyx_v_functions = __pyx_v_functions;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_functions);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_functions);
  __pyx_cur_scope->__pyx_v_func_names = __pyx_v_func_names;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_func_names);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_func_names);

  /* "libchemicalstring_2.pyx":546
 * 
 * #create a function which updates the current functions' values
 * def generate_update_functions(count_targets, counts,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 							functions, func_names):
 * 
 */
  __pyx_k_tuple_216 = <span class='py_c_api'>PyTuple_Pack</span>(8, ((PyObject *)__pyx_n_s__count_targets), ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_n_s__functions), ((PyObject *)__pyx_n_s__func_names), ((PyObject *)__pyx_n_s__dummy), ((PyObject *)__pyx_n_s__dummy), ((PyObject *)__pyx_n_s__update_function), ((PyObject *)__pyx_n_s__update_function));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_216)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_216);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_216));

  /* "libchemicalstring_2.pyx":546
 * 
 * #create a function which updates the current functions' values
 * def generate_update_functions(count_targets, counts,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 							functions, func_names):
 * 
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_27generate_update_functions, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_144, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_217 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(4, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_216, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s_144, 546, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_217)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "libchemicalstring_2.pyx":546
 * 
 * #create a function which updates the current functions' values
 * def generate_update_functions(count_targets, counts,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 							functions, func_names):
 * 
 */
struct __pyx_obj_14stringchemical___pyx_scope_struct_14_generate_update_functions {
  PyObject_HEAD
  PyObject *__pyx_v_count_targets;
  PyObject *__pyx_v_counts;
  PyObject *__pyx_v_func_names;
  PyObject *__pyx_v_functions;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line547")'> 547: 							functions, func_names):</pre>
<pre id='line547' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line548")'> 548: </pre>
<pre id='line548' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line549")'> 549: 	def dummy(): pass</pre>
<pre id='line549' class='code' style='background-color: #FFFF73'>
/* "libchemicalstring_2.pyx":549
 * 							functions, func_names):
 * 
 * 	def dummy(): pass             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	def update_function():
 * 		func_dex = count_targets.index(func_names[0])
 */

static PyObject *__pyx_pf_14stringchemical_25generate_update_functions_dummy(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("dummy", 0);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_25generate_update_functions_3update_function(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_25generate_update_functions_3update_function = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("update_function"), (PyCFunction)__pyx_pw_14stringchemical_25generate_update_functions_3update_function, METH_NOARGS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_25generate_update_functions_3update_function(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("update_function (wrapper)", 0);
  __pyx_r = __pyx_pf_14stringchemical_25generate_update_functions_2update_function(__pyx_self);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "libchemicalstring_2.pyx":549
 * 							functions, func_names):
 * 
 * 	def dummy(): pass             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	def update_function():
 * 		func_dex = count_targets.index(func_names[0])
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_25generate_update_functions_1dummy, 0, __pyx_n_s_121, NULL, __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_120));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_dummy = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":549
 * 							functions, func_names):
 * 
 * 	def dummy(): pass             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	def update_function():
 * 		func_dex = count_targets.index(func_names[0])
 */
  __pyx_k_codeobj_120 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 0, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__dummy, 549, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_120)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line550")'> 550: 	def update_function():</pre>
<pre id='line550' class='code' style='background-color: #FFFF6a'>
/* "libchemicalstring_2.pyx":550
 * 
 * 	def dummy(): pass
 * 	def update_function():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		func_dex = count_targets.index(func_names[0])
 * 		for dex in range(func_dex, len(counts)):
 */

static PyObject *__pyx_pf_14stringchemical_25generate_update_functions_2update_function(PyObject *__pyx_self) {
  struct __pyx_obj_14stringchemical___pyx_scope_struct_14_generate_update_functions *__pyx_cur_scope;
  struct __pyx_obj_14stringchemical___pyx_scope_struct_14_generate_update_functions *__pyx_outer_scope;
  PyObject *__pyx_v_func_dex = NULL;
  PyObject *__pyx_v_dex = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("update_function", 0);
  __pyx_outer_scope = (struct __pyx_obj_14stringchemical___pyx_scope_struct_14_generate_update_functions *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "libchemicalstring_2.pyx":550
 * 
 * 	def dummy(): pass
 * 	def update_function():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		func_dex = count_targets.index(func_names[0])
 * 		for dex in range(func_dex, len(counts)):
 */
  __pyx_k_tuple_122 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject *)__pyx_n_s__func_dex), ((PyObject *)__pyx_n_s__dex));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_122)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_122);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_122));

  /* "libchemicalstring_2.pyx":550
 * 
 * 	def dummy(): pass
 * 	def update_function():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		func_dex = count_targets.index(func_names[0])
 * 		for dex in range(func_dex, len(counts)):
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_14stringchemical_25generate_update_functions_3update_function, 0, __pyx_n_s_124, ((PyObject*)__pyx_cur_scope), __pyx_n_s__stringchemical, ((PyObject *)__pyx_k_codeobj_123));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_update_function = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_codeobj_123 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(0, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_122, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__update_function, 550, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_123)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line551")'> 551: 		func_dex = count_targets.index(func_names[0])</pre>
<pre id='line551' class='code' style='background-color: #FFFF4b'>
  /* "libchemicalstring_2.pyx":551
 * 	def dummy(): pass
 * 	def update_function():
 * 		func_dex = count_targets.index(func_names[0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		for dex in range(func_dex, len(counts)):
 * 			counts[dex] = functions[dex - func_dex](counts)
 */
  if (unlikely(!__pyx_cur_scope->__pyx_v_count_targets)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("count_targets");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_cur_scope->__pyx_v_count_targets, __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (unlikely(!__pyx_cur_scope->__pyx_v_func_names)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func_names");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope->__pyx_v_func_names, 0, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_v_func_dex = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line552")'> 552: 		for dex in range(func_dex, len(counts)):</pre>
<pre id='line552' class='code' style='background-color: #FFFF1c'>
  /* "libchemicalstring_2.pyx":552
 * 	def update_function():
 * 		func_dex = count_targets.index(func_names[0])
 * 		for dex in range(func_dex, len(counts)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			counts[dex] = functions[dex - func_dex](counts)
 * 
 */
  if (unlikely(!__pyx_cur_scope->__pyx_v_counts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("counts");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_2 = __pyx_cur_scope->__pyx_v_counts;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_func_dex);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_func_dex);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_func_dex);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (!__pyx_t_5 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_5 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_2 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex);
    __pyx_v_dex = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line553")'> 553: 			counts[dex] = functions[dex - func_dex](counts)</pre>
<pre id='line553' class='code' style='background-color: #FFFF2f'>
    /* "libchemicalstring_2.pyx":553
 * 		func_dex = count_targets.index(func_names[0])
 * 		for dex in range(func_dex, len(counts)):
 * 			counts[dex] = functions[dex - func_dex](counts)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	if not func_names: return dummy
 */
    if (unlikely(!__pyx_cur_scope->__pyx_v_functions)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("functions");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_dex, __pyx_v_func_dex);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_cur_scope->__pyx_v_functions, __pyx_t_2);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope->__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_cur_scope->__pyx_v_counts);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_cur_scope->__pyx_v_counts);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_cur_scope->__pyx_v_counts, __pyx_v_dex, __pyx_t_6) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_update_functions.update_function", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_func_dex);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dex);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line554")'> 554: </pre>
<pre id='line554' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line555")'> 555: 	if not func_names: return dummy</pre>
<pre id='line555' class='code' style='background-color: #FFFF96'>
  /* "libchemicalstring_2.pyx":555
 * 			counts[dex] = functions[dex - func_dex](counts)
 * 
 * 	if not func_names: return dummy             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	else: return update_function
 * 
 */
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_cur_scope->__pyx_v_func_names);<span class='error_goto'> if (unlikely(__pyx_t_2 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = ((!__pyx_t_2) != 0);
  if (__pyx_t_3) {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dummy);
    __pyx_r = __pyx_v_dummy;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line556")'> 556: 	else: return update_function</pre>
<pre id='line556' class='code' style='background-color: #FFFF38'>
    /* "libchemicalstring_2.pyx":556
 * 
 * 	if not func_names: return dummy
 * 	else: return update_function             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_update_function);
    __pyx_r = __pyx_v_update_function;
    goto __pyx_L0;
  }
  __pyx_L3:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.generate_update_functions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dummy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_update_function);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_14stringchemical_29simulate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14stringchemical_29simulate = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("simulate"), (PyCFunction)__pyx_pw_14stringchemical_29simulate, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_14stringchemical_29simulate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_system_string = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("simulate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__system_string,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_kp_s_125);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__system_string);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simulate") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_system_string = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simulate", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.simulate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14stringchemical_28simulate(__pyx_self, __pyx_v_system_string);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line557")'> 557: </pre>
<pre id='line557' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line558")'> 558: </pre>
<pre id='line558' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line559")'> 559: </pre>
<pre id='line559' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line560")'> 560: #temporarily here to use debug_string.txt</pre>
<pre id='line560' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line561")'> 561: import os</pre>
<pre id='line561' class='code' style='background-color: #FFFF8d'>
  /* "libchemicalstring_2.pyx":561
 * 
 * #temporarily here to use debug_string.txt
 * import os             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * @cython.boundscheck(False) #no IndexErrors can be allowed to occur
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__os), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__os, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line562")'> 562: </pre>
<pre id='line562' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line563")'> 563: @cython.boundscheck(False) #no IndexErrors can be allowed to occur</pre>
<pre id='line563' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line564")'> 564: @cython.cdivision(False)</pre>
<pre id='line564' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line565")'> 565: #simulates and returns data of one trajectory of a system</pre>
<pre id='line565' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line566")'> 566: def simulate(system_string = '&lt;species&gt;Substrate:10000,Enzyme:5000,ES_Complex:0,Product:0&lt;variables&gt;k:0.5&lt;functions&gt;ratio=Substrate/(Enzyme+k)&lt;reactions&gt;(1)Substrate+(1)Enzyme-&gt;1.0-&gt;(1)ES_Complex,(1)ES_Complex-&gt;0.01-&gt;(1)Substrate+(1)Enzyme,(1)ES_Complex-&gt;800.0-&gt;(1)Enzyme+(1)Product&lt;end&gt;iteration&gt;=10000&lt;capture&gt;increment:time:0.00002&lt;targets&gt;ES_Complex,Product,iteration,time,fixed_time||'):</pre>
<pre id='line566' class='code' style='background-color: #FFFF62'>
/* "libchemicalstring_2.pyx":566
 * @cython.cdivision(False)
 * #simulates and returns data of one trajectory of a system
 * def simulate(system_string = '<code><</code>species>Substrate:10000,Enzyme:5000,ES_Complex:0,Product:0<code><</code>variables>k:0.5<code><</code>functions>ratio=Substrate/(Enzyme+k)<code><</code>reactions>(1)Substrate+(1)Enzyme->1.0->(1)ES_Complex,(1)ES_Complex->0.01->(1)Substrate+(1)Enzyme,(1)ES_Complex->800.0->(1)Enzyme+(1)Product<code><</code>end>iteration>=10000<code><</code>capture>increment:time:0.00002<code><</code>targets>ES_Complex,Product,iteration,time,fixed_time||'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#some code to print a system_string to a txt file... to be certain the system_strings I give you work
 */

static PyObject *__pyx_pf_14stringchemical_28simulate(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_system_string) {
  PyObject *__pyx_v_path = NULL;
  PyObject *__pyx_v_handle = NULL;
  int __pyx_v_iteration;
  int __pyx_v_rxn_dex;
  double __pyx_v_time;
  double __pyx_v_fixed_time;
  double __pyx_v_fixed_delt;
  double __pyx_v_fixed_time_step;
  double __pyx_v_time_step;
  double __pyx_v_last_time;
  double __pyx_v_last_fixed_time;
  double __pyx_v_propensity_total;
  double __pyx_v_propensity_total_inv;
  double __pyx_v_rand_rxn;
  double __pyx_v_rand_time;
  int __pyx_v_prop_dex;
  int __pyx_v_propensity_count;
  int __pyx_v_next_dex;
  int __pyx_v_dex;
  int __pyx_v_fixed_steps;
  PyObject *__pyx_v_species = NULL;
  PyObject *__pyx_v_variables = NULL;
  PyObject *__pyx_v_functions = NULL;
  PyObject *__pyx_v_rxns = NULL;
  PyObject *__pyx_v_end = NULL;
  PyObject *__pyx_v_capture = NULL;
  PyObject *__pyx_v_targets = NULL;
  PyObject *__pyx_v_sub_var_string = NULL;
  PyObject *__pyx_v_var_vals = NULL;
  PyObject *__pyx_v_counts = NULL;
  PyObject *__pyx_v_count_targets = NULL;
  PyObject *__pyx_v_func_names = NULL;
  PyObject *__pyx_v_update_functions = NULL;
  PyObject *__pyx_v_rxn_split = NULL;
  PyObject *__pyx_v_rate_call_group = NULL;
  PyObject *__pyx_v_propensities = NULL;
  PyObject *__pyx_v_validators = NULL;
  PyObject *__pyx_v_reactions = NULL;
  PyObject *__pyx_v_reagents = NULL;
  PyObject *__pyx_v_products = NULL;
  __Pyx_memviewslice __pyx_v_propensity_table = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_prop = NULL;
  PyObject *__pyx_v_data = NULL;
  PyObject *__pyx_v_target_dexes = NULL;
  PyObject *__pyx_v_ends = NULL;
  PyObject *__pyx_v_end_test = NULL;
  PyObject *__pyx_v_capts = NULL;
  PyObject *__pyx_v_capture_test = NULL;
  PyObject *__pyx_v_uses_time = NULL;
  PyObject *__pyx_v_capt = NULL;
  int __pyx_v_seed;
  struct __pyx_obj_14stringchemical_GENRAND *__pyx_v_rndvar = 0;
  __Pyx_memviewslice __pyx_v_rxn_table = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_timedex = NULL;
  PyObject *__pyx_v_bad_dex = NULL;
  PyObject *__pyx_v_step = NULL;
  double __pyx_v_remainder_time;
  PyObject *__pyx_v_vari = NULL;
  PyObject *__pyx_v_amt = NULL;
  PyObject *__pyx_v_spec = NULL;
  PyObject *__pyx_v_func = NULL;
  PyObject *__pyx_v_rxn_string = NULL;
  PyObject *__pyx_v_targ = NULL;
  PyObject *__pyx_v_spl = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("simulate", 0);

  /* "libchemicalstring_2.pyx":566
 * @cython.cdivision(False)
 * #simulates and returns data of one trajectory of a system
 * def simulate(system_string = '<code><</code>species>Substrate:10000,Enzyme:5000,ES_Complex:0,Product:0<code><</code>variables>k:0.5<code><</code>functions>ratio=Substrate/(Enzyme+k)<code><</code>reactions>(1)Substrate+(1)Enzyme->1.0->(1)ES_Complex,(1)ES_Complex->0.01->(1)Substrate+(1)Enzyme,(1)ES_Complex->800.0->(1)Enzyme+(1)Product<code><</code>end>iteration>=10000<code><</code>capture>increment:time:0.00002<code><</code>targets>ES_Complex,Product,iteration,time,fixed_time||'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#some code to print a system_string to a txt file... to be certain the system_strings I give you work
 */
  __pyx_k_tuple_219 = <span class='py_c_api'>PyTuple_Pack</span>(66, ((PyObject *)__pyx_n_s__system_string), ((PyObject *)__pyx_n_s__path), ((PyObject *)__pyx_n_s__handle), ((PyObject *)__pyx_n_s__iteration), ((PyObject *)__pyx_n_s__rxn_dex), ((PyObject *)__pyx_n_s__time), ((PyObject *)__pyx_n_s__fixed_time), ((PyObject *)__pyx_n_s__fixed_delt), ((PyObject *)__pyx_n_s__fixed_time_step), ((PyObject *)__pyx_n_s__time_step), ((PyObject *)__pyx_n_s__last_time), ((PyObject *)__pyx_n_s__last_fixed_time), ((PyObject *)__pyx_n_s__propensity_total), ((PyObject *)__pyx_n_s_218), ((PyObject *)__pyx_n_s__rand_rxn), ((PyObject *)__pyx_n_s__rand_time), ((PyObject *)__pyx_n_s__prop_dex), ((PyObject *)__pyx_n_s__propensity_count), ((PyObject *)__pyx_n_s__next_dex), ((PyObject *)__pyx_n_s__dex), ((PyObject *)__pyx_n_s__fixed_steps), ((PyObject *)__pyx_n_s__fixed_update), ((PyObject *)__pyx_n_s__species), ((PyObject *)__pyx_n_s__variables), ((PyObject *)__pyx_n_s__functions), ((PyObject *)__pyx_n_s__rxns), ((PyObject *)__pyx_n_s__end), ((PyObject *)__pyx_n_s__capture), ((PyObject *)__pyx_n_s__targets), ((PyObject *)__pyx_n_s__sub_var_string), ((PyObject *)__pyx_n_s__var_vals), ((PyObject *)__pyx_n_s__counts), ((PyObject *)__pyx_n_s__count_targets), ((PyObject *)__pyx_n_s__func_names), ((PyObject *)__pyx_n_s__update_functions), ((PyObject *)__pyx_n_s__rxn_split), ((PyObject *)__pyx_n_s__rate_call_group), ((PyObject *)__pyx_n_s__propensities), ((PyObject *)__pyx_n_s__validators), ((PyObject *)__pyx_n_s__reactions), ((PyObject *)__pyx_n_s__reagents), ((PyObject *)__pyx_n_s__products), ((PyObject *)__pyx_n_s__propensity_table), ((PyObject *)__pyx_n_s__prop), ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__target_dexes), ((PyObject *)__pyx_n_s__ends), ((PyObject *)__pyx_n_s__end_test), ((PyObject *)__pyx_n_s__capts), ((PyObject *)__pyx_n_s__capture_test), ((PyObject *)__pyx_n_s__uses_time), ((PyObject *)__pyx_n_s__capt), ((PyObject *)__pyx_n_s__seed), ((PyObject *)__pyx_n_s__rndvar), ((PyObject *)__pyx_n_s__rxn_table), ((PyObject *)__pyx_n_s__timedex), ((PyObject *)__pyx_n_s__bad_dex), ((PyObject *)__pyx_n_s__step), ((PyObject *)__pyx_n_s__remainder_time), ((PyObject *)__pyx_n_s__vari), ((PyObject *)__pyx_n_s__amt), ((PyObject *)__pyx_n_s__spec), ((PyObject *)__pyx_n_s__func), ((PyObject *)__pyx_n_s__rxn_string), ((PyObject *)__pyx_n_s__targ), ((PyObject *)__pyx_n_s__spl));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_219)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_219);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_219));

  /* "libchemicalstring_2.pyx":566
 * @cython.cdivision(False)
 * #simulates and returns data of one trajectory of a system
 * def simulate(system_string = '<code><</code>species>Substrate:10000,Enzyme:5000,ES_Complex:0,Product:0<code><</code>variables>k:0.5<code><</code>functions>ratio=Substrate/(Enzyme+k)<code><</code>reactions>(1)Substrate+(1)Enzyme->1.0->(1)ES_Complex,(1)ES_Complex->0.01->(1)Substrate+(1)Enzyme,(1)ES_Complex->800.0->(1)Enzyme+(1)Product<code><</code>end>iteration>=10000<code><</code>capture>increment:time:0.00002<code><</code>targets>ES_Complex,Product,iteration,time,fixed_time||'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#some code to print a system_string to a txt file... to be certain the system_strings I give you work
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14stringchemical_29simulate, NULL, __pyx_n_s__stringchemical);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__simulate, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_220 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(1, 0, 66, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_219, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_18, __pyx_n_s__simulate, 566, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_220)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line567")'> 567: </pre>
<pre id='line567' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line568")'> 568: 	#some code to print a system_string to a txt file... to be certain the system_strings I give you work</pre>
<pre id='line568' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2c' onclick='toggleDiv("line569")'> 569: 	path = os.path.join(os.getcwd(), 'libs', 'modules', 'debug_string.txt')</pre>
<pre id='line569' class='code' style='background-color: #FFFF2c'>
  /* "libchemicalstring_2.pyx":569
 * 
 * 	#some code to print a system_string to a txt file... to be certain the system_strings I give you work
 * 	path = os.path.join(os.getcwd(), 'libs', 'modules', 'debug_string.txt')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	with open(path, 'w') as handle: handle.write(system_string)
 * 	#
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__os);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__path);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__join);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__os);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__getcwd);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__libs));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, ((PyObject *)__pyx_n_s__libs));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__libs));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__modules));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, ((PyObject *)__pyx_n_s__modules));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__modules));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_126));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, ((PyObject *)__pyx_kp_s_126));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_126));
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_v_path = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF14' onclick='toggleDiv("line570")'> 570: 	with open(path, 'w') as handle: handle.write(system_string)</pre>
<pre id='line570' class='code' style='background-color: #FFFF14'>
  /* "libchemicalstring_2.pyx":570
 * 	#some code to print a system_string to a txt file... to be certain the system_strings I give you work
 * 	path = os.path.join(os.getcwd(), 'libs', 'modules', 'debug_string.txt')
 * 	with open(path, 'w') as handle: handle.write(system_string)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	#
 * 
 */
  /*with:*/ {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_path);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_path);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_path);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__w));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_n_s__w));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__w));
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s____exit__);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s____enter__);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    /*try:*/ {
      {
        <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_7);
        /*try:*/ {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          __pyx_v_handle = __pyx_t_1;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_handle, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L7_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L7_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_system_string);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_system_string);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_system_string);
          __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L7_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        goto __pyx_L14_try_end;
        __pyx_L7_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        /*except:*/ {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.simulate", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_2, &__pyx_t_3, &__pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L9_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L9_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
          __pyx_t_10 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, __pyx_t_8, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          if (unlikely(!__pyx_t_10))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L9_except_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
          __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          if (__pyx_t_9 <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L9_except_error;}</span>
          __pyx_t_11 = ((!(__pyx_t_9 != 0)) != 0);
          if (__pyx_t_11) {
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
            <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);
            __pyx_t_2 = 0; __pyx_t_3 = 0; __pyx_t_1 = 0; 
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L9_except_error;}</span>
            goto __pyx_L18;
          }
          __pyx_L18:;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          goto __pyx_L8_exception_handled;
        }
        __pyx_L9_except_error:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_5, __pyx_t_6, __pyx_t_7);
        goto __pyx_L1_error;
        __pyx_L8_exception_handled:;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_5);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_5, __pyx_t_6, __pyx_t_7);
        __pyx_L14_try_end:;
      }
    }
    /*finally:*/ {
      if (__pyx_t_4) {
        __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, __pyx_k_tuple_127, NULL);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_7))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        __pyx_t_11 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (__pyx_t_11 <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
    goto __pyx_L19;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L1_error;
    __pyx_L19:;
  }

  /* "libchemicalstring_2.pyx":570
 * 	#some code to print a system_string to a txt file... to be certain the system_strings I give you work
 * 	path = os.path.join(os.getcwd(), 'libs', 'modules', 'debug_string.txt')
 * 	with open(path, 'w') as handle: handle.write(system_string)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	#
 * 
 */
  __pyx_k_tuple_127 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_127)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_127);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_127));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line571")'> 571: 	#</pre>
<pre id='line571' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line572")'> 572: </pre>
<pre id='line572' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line573")'> 573: </pre>
<pre id='line573' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line574")'> 574: 	#initializations, mostly used for cython</pre>
<pre id='line574' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line575")'> 575: 	cdef int iteration = 0</pre>
<pre id='line575' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":575
 * 
 * 	#initializations, mostly used for cython
 * 	cdef int iteration = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef int rxn_dex = 0
 * 	cdef double time = 0.0
 */
  __pyx_v_iteration = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line576")'> 576: 	cdef int rxn_dex = 0</pre>
<pre id='line576' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":576
 * 	#initializations, mostly used for cython
 * 	cdef int iteration = 0
 * 	cdef int rxn_dex = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef double time = 0.0
 * 	cdef double fixed_time = 0.0
 */
  __pyx_v_rxn_dex = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line577")'> 577: 	cdef double time = 0.0</pre>
<pre id='line577' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":577
 * 	cdef int iteration = 0
 * 	cdef int rxn_dex = 0
 * 	cdef double time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef double fixed_time = 0.0
 * 	cdef double fixed_delt = 1.0
 */
  __pyx_v_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line578")'> 578: 	cdef double fixed_time = 0.0</pre>
<pre id='line578' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":578
 * 	cdef int rxn_dex = 0
 * 	cdef double time = 0.0
 * 	cdef double fixed_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef double fixed_delt = 1.0
 * 	cdef double fixed_time_step = 0.0
 */
  __pyx_v_fixed_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line579")'> 579: 	cdef double fixed_delt = 1.0</pre>
<pre id='line579' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":579
 * 	cdef double time = 0.0
 * 	cdef double fixed_time = 0.0
 * 	cdef double fixed_delt = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef double fixed_time_step = 0.0
 * 	cdef double time_step = 0.0
 */
  __pyx_v_fixed_delt = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line580")'> 580: 	cdef double fixed_time_step = 0.0</pre>
<pre id='line580' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":580
 * 	cdef double fixed_time = 0.0
 * 	cdef double fixed_delt = 1.0
 * 	cdef double fixed_time_step = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef double time_step = 0.0
 * 	cdef double last_time = 0.0
 */
  __pyx_v_fixed_time_step = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line581")'> 581: 	cdef double time_step = 0.0</pre>
<pre id='line581' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":581
 * 	cdef double fixed_delt = 1.0
 * 	cdef double fixed_time_step = 0.0
 * 	cdef double time_step = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef double last_time = 0.0
 * 	cdef double last_fixed_time = 0.0
 */
  __pyx_v_time_step = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line582")'> 582: 	cdef double last_time = 0.0</pre>
<pre id='line582' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":582
 * 	cdef double fixed_time_step = 0.0
 * 	cdef double time_step = 0.0
 * 	cdef double last_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef double last_fixed_time = 0.0
 * 	cdef double propensity_total
 */
  __pyx_v_last_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line583")'> 583: 	cdef double last_fixed_time = 0.0</pre>
<pre id='line583' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":583
 * 	cdef double time_step = 0.0
 * 	cdef double last_time = 0.0
 * 	cdef double last_fixed_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef double propensity_total
 * 	cdef double propensity_total_inv
 */
  __pyx_v_last_fixed_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line584")'> 584: 	cdef double propensity_total</pre>
<pre id='line584' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line585")'> 585: 	cdef double propensity_total_inv</pre>
<pre id='line585' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line586")'> 586: 	cdef double rand_rxn</pre>
<pre id='line586' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line587")'> 587: 	cdef double rand_time</pre>
<pre id='line587' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line588")'> 588: 	cdef int prop_dex</pre>
<pre id='line588' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line589")'> 589: 	cdef int propensity_count</pre>
<pre id='line589' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line590")'> 590: 	cdef int next_dex</pre>
<pre id='line590' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line591")'> 591: 	cdef int dex</pre>
<pre id='line591' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line592")'> 592: 	cdef int fixed_steps</pre>
<pre id='line592' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line593")'> 593: 	cdef int fixed_update</pre>
<pre id='line593' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line594")'> 594: </pre>
<pre id='line594' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line595")'> 595: </pre>
<pre id='line595' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line596")'> 596: 	#break the system_string up for processing</pre>
<pre id='line596' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF25' onclick='toggleDiv("line597")'> 597: 	species, next_dex = parse(system_string, 0, '&lt;variables&gt;')</pre>
<pre id='line597' class='code' style='background-color: #FFFF25'>
  /* "libchemicalstring_2.pyx":597
 * 
 * 	#break the system_string up for processing
 * 	species, next_dex = parse(system_string, 0, '<code><</code>variables>')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	variables, next_dex = parse(system_string, next_dex, '<code><</code>functions>')
 * 	functions, next_dex = parse(system_string, next_dex, '<code><</code>reactions>')
 */
  __pyx_t_1 = __pyx_f_14stringchemical_parse(__pyx_v_system_string, 0, ((PyObject *)__pyx_kp_s_128));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else
  {
    Py_ssize_t index = -1;
    __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = Py_TYPE(__pyx_t_8)->tp_iternext;
    index = 0; __pyx_t_3 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_3)) goto __pyx_L20_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_2)) goto __pyx_L20_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_8), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    goto __pyx_L21_unpacking_done;
    __pyx_L20_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_12 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L21_unpacking_done:;
  }
  __pyx_t_13 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_13 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_species = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_next_dex = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF25' onclick='toggleDiv("line598")'> 598: 	variables, next_dex = parse(system_string, next_dex, '&lt;functions&gt;')</pre>
<pre id='line598' class='code' style='background-color: #FFFF25'>
  /* "libchemicalstring_2.pyx":598
 * 	#break the system_string up for processing
 * 	species, next_dex = parse(system_string, 0, '<code><</code>variables>')
 * 	variables, next_dex = parse(system_string, next_dex, '<code><</code>functions>')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	functions, next_dex = parse(system_string, next_dex, '<code><</code>reactions>')
 * 	rxns, next_dex = parse(system_string, next_dex, '<code><</code>end>')
 */
  __pyx_t_1 = __pyx_f_14stringchemical_parse(__pyx_v_system_string, __pyx_v_next_dex, ((PyObject *)__pyx_kp_s_129));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 598; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 598; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 598; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 598; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else
  {
    Py_ssize_t index = -1;
    __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 598; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = Py_TYPE(__pyx_t_8)->tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_2)) goto __pyx_L22_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_3)) goto __pyx_L22_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_8), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 598; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    goto __pyx_L23_unpacking_done;
    __pyx_L22_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_12 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 598; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L23_unpacking_done:;
  }
  __pyx_t_13 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_13 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 598; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_variables = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_next_dex = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF25' onclick='toggleDiv("line599")'> 599: 	functions, next_dex = parse(system_string, next_dex, '&lt;reactions&gt;')</pre>
<pre id='line599' class='code' style='background-color: #FFFF25'>
  /* "libchemicalstring_2.pyx":599
 * 	species, next_dex = parse(system_string, 0, '<code><</code>variables>')
 * 	variables, next_dex = parse(system_string, next_dex, '<code><</code>functions>')
 * 	functions, next_dex = parse(system_string, next_dex, '<code><</code>reactions>')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	rxns, next_dex = parse(system_string, next_dex, '<code><</code>end>')
 * 	end, next_dex = parse(system_string, next_dex, '<code><</code>capture>')
 */
  __pyx_t_1 = __pyx_f_14stringchemical_parse(__pyx_v_system_string, __pyx_v_next_dex, ((PyObject *)__pyx_kp_s_130));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else
  {
    Py_ssize_t index = -1;
    __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = Py_TYPE(__pyx_t_8)->tp_iternext;
    index = 0; __pyx_t_3 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_3)) goto __pyx_L24_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_2)) goto __pyx_L24_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_8), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    goto __pyx_L25_unpacking_done;
    __pyx_L24_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_12 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L25_unpacking_done:;
  }
  __pyx_t_13 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_13 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_functions = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_next_dex = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF25' onclick='toggleDiv("line600")'> 600: 	rxns, next_dex = parse(system_string, next_dex, '&lt;end&gt;')</pre>
<pre id='line600' class='code' style='background-color: #FFFF25'>
  /* "libchemicalstring_2.pyx":600
 * 	variables, next_dex = parse(system_string, next_dex, '<code><</code>functions>')
 * 	functions, next_dex = parse(system_string, next_dex, '<code><</code>reactions>')
 * 	rxns, next_dex = parse(system_string, next_dex, '<code><</code>end>')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	end, next_dex = parse(system_string, next_dex, '<code><</code>capture>')
 * 	capture, next_dex = parse(system_string, next_dex, '<code><</code>targets>')
 */
  __pyx_t_1 = __pyx_f_14stringchemical_parse(__pyx_v_system_string, __pyx_v_next_dex, ((PyObject *)__pyx_kp_s_131));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else
  {
    Py_ssize_t index = -1;
    __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = Py_TYPE(__pyx_t_8)->tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_2)) goto __pyx_L26_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_3)) goto __pyx_L26_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_8), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    goto __pyx_L27_unpacking_done;
    __pyx_L26_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_12 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L27_unpacking_done:;
  }
  __pyx_t_13 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_13 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rxns = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_next_dex = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF25' onclick='toggleDiv("line601")'> 601: 	end, next_dex = parse(system_string, next_dex, '&lt;capture&gt;')</pre>
<pre id='line601' class='code' style='background-color: #FFFF25'>
  /* "libchemicalstring_2.pyx":601
 * 	functions, next_dex = parse(system_string, next_dex, '<code><</code>reactions>')
 * 	rxns, next_dex = parse(system_string, next_dex, '<code><</code>end>')
 * 	end, next_dex = parse(system_string, next_dex, '<code><</code>capture>')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	capture, next_dex = parse(system_string, next_dex, '<code><</code>targets>')
 * 	targets, next_dex = parse(system_string, next_dex, '||')
 */
  __pyx_t_1 = __pyx_f_14stringchemical_parse(__pyx_v_system_string, __pyx_v_next_dex, ((PyObject *)__pyx_kp_s_132));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else
  {
    Py_ssize_t index = -1;
    __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = Py_TYPE(__pyx_t_8)->tp_iternext;
    index = 0; __pyx_t_3 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_3)) goto __pyx_L28_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_2)) goto __pyx_L28_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_8), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    goto __pyx_L29_unpacking_done;
    __pyx_L28_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_12 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L29_unpacking_done:;
  }
  __pyx_t_13 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_13 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_end = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_next_dex = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF25' onclick='toggleDiv("line602")'> 602: 	capture, next_dex = parse(system_string, next_dex, '&lt;targets&gt;')</pre>
<pre id='line602' class='code' style='background-color: #FFFF25'>
  /* "libchemicalstring_2.pyx":602
 * 	rxns, next_dex = parse(system_string, next_dex, '<code><</code>end>')
 * 	end, next_dex = parse(system_string, next_dex, '<code><</code>capture>')
 * 	capture, next_dex = parse(system_string, next_dex, '<code><</code>targets>')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	targets, next_dex = parse(system_string, next_dex, '||')
 * 
 */
  __pyx_t_1 = __pyx_f_14stringchemical_parse(__pyx_v_system_string, __pyx_v_next_dex, ((PyObject *)__pyx_kp_s_133));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else
  {
    Py_ssize_t index = -1;
    __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = Py_TYPE(__pyx_t_8)->tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_2)) goto __pyx_L30_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_3)) goto __pyx_L30_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_8), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    goto __pyx_L31_unpacking_done;
    __pyx_L30_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_12 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L31_unpacking_done:;
  }
  __pyx_t_13 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_13 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_capture = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_next_dex = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF25' onclick='toggleDiv("line603")'> 603: 	targets, next_dex = parse(system_string, next_dex, '||')</pre>
<pre id='line603' class='code' style='background-color: #FFFF25'>
  /* "libchemicalstring_2.pyx":603
 * 	end, next_dex = parse(system_string, next_dex, '<code><</code>capture>')
 * 	capture, next_dex = parse(system_string, next_dex, '<code><</code>targets>')
 * 	targets, next_dex = parse(system_string, next_dex, '||')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = __pyx_f_14stringchemical_parse(__pyx_v_system_string, __pyx_v_next_dex, ((PyObject *)__pyx_kp_s_134));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else
  {
    Py_ssize_t index = -1;
    __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = Py_TYPE(__pyx_t_8)->tp_iternext;
    index = 0; __pyx_t_3 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_3)) goto __pyx_L32_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_12(__pyx_t_8); if (unlikely(!__pyx_t_2)) goto __pyx_L32_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_8), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    goto __pyx_L33_unpacking_done;
    __pyx_L32_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_12 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L33_unpacking_done:;
  }
  __pyx_t_13 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_13 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_targets = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_next_dex = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line604")'> 604: </pre>
<pre id='line604' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line605")'> 605: </pre>
<pre id='line605' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line606")'> 606: 	#parse variables and their values</pre>
<pre id='line606' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line607")'> 607: 	# variables are always constant</pre>
<pre id='line607' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line608")'> 608: 	sub_var_string = variables[variables.find('&gt;') + 1:].split(',')</pre>
<pre id='line608' class='code' style='background-color: #FFFF2e'>
  /* "libchemicalstring_2.pyx":608
 * 	#parse variables and their values
 * 	# variables are always constant
 * 	sub_var_string = variables[variables.find('>') + 1:].split(',')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	if sub_var_string[0]:
 * 		variables, var_vals = zip(*[vari.split(':')
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_variables, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_135), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_variables, 0, 0, &__pyx_t_1, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;

  /* "libchemicalstring_2.pyx":608
 * 	#parse variables and their values
 * 	# variables are always constant
 * 	sub_var_string = variables[variables.find('>') + 1:].split(',')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	if sub_var_string[0]:
 * 		variables, var_vals = zip(*[vari.split(':')
 */
  __pyx_k_tuple_135 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_90));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_135)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_135);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_135));
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_137), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_sub_var_string = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_k_tuple_137 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_136));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_137)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_137);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_137));
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line609")'> 609: 	if sub_var_string[0]:</pre>
<pre id='line609' class='code' style='background-color: #FFFF8d'>
  /* "libchemicalstring_2.pyx":609
 * 	# variables are always constant
 * 	sub_var_string = variables[variables.find('>') + 1:].split(',')
 * 	if sub_var_string[0]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		variables, var_vals = zip(*[vari.split(':')
 * 					for vari in sub_var_string])
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_sub_var_string, 0, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_11 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_11 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_11) {
</pre><pre class='line' style='background-color: #FFFF1a' onclick='toggleDiv("line610")'> 610: 		variables, var_vals = zip(*[vari.split(':')</pre>
<pre id='line610' class='code' style='background-color: #FFFF1a'>
    /* "libchemicalstring_2.pyx":610
 * 	sub_var_string = variables[variables.find('>') + 1:].split(',')
 * 	if sub_var_string[0]:
 * 		variables, var_vals = zip(*[vari.split(':')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 					for vari in sub_var_string])
 * 		var_vals = [float(amt) for amt in var_vals]
 */
    __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);

      /* "libchemicalstring_2.pyx":610
 * 	sub_var_string = variables[variables.find('>') + 1:].split(',')
 * 	if sub_var_string[0]:
 * 		variables, var_vals = zip(*[vari.split(':')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 					for vari in sub_var_string])
 * 		var_vals = [float(amt) for amt in var_vals]
 */
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_vari, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_138), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_2, (PyObject*)__pyx_t_8)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PySequence_Tuple</span>(((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_zip, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    {
      Py_ssize_t index = -1;
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_3)->tp_iternext;
      index = 0; __pyx_t_1 = __pyx_t_12(__pyx_t_3); if (unlikely(!__pyx_t_1)) goto __pyx_L37_unpacking_failed;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      index = 1; __pyx_t_8 = __pyx_t_12(__pyx_t_3); if (unlikely(!__pyx_t_8)) goto __pyx_L37_unpacking_failed;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_3), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L38_unpacking_done;
      __pyx_L37_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_L38_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_variables);
    __pyx_v_variables = __pyx_t_1;
    __pyx_t_1 = 0;
    __pyx_v_var_vals = __pyx_t_8;
    __pyx_t_8 = 0;

  /* "libchemicalstring_2.pyx":610
 * 	sub_var_string = variables[variables.find('>') + 1:].split(',')
 * 	if sub_var_string[0]:
 * 		variables, var_vals = zip(*[vari.split(':')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 					for vari in sub_var_string])
 * 		var_vals = [float(amt) for amt in var_vals]
 */
  __pyx_k_tuple_138 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_5));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_138)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_138);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_138));
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line611")'> 611: 					for vari in sub_var_string])</pre>
<pre id='line611' class='code' style='background-color: #FFFF2a'>
    /* "libchemicalstring_2.pyx":611
 * 	if sub_var_string[0]:
 * 		variables, var_vals = zip(*[vari.split(':')
 * 					for vari in sub_var_string])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		var_vals = [float(amt) for amt in var_vals]
 * 
 */
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_sub_var_string) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_sub_var_string)) {
      __pyx_t_1 = __pyx_v_sub_var_string; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
    } else {
      __pyx_t_14 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_sub_var_string);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_15 = Py_TYPE(__pyx_t_1)->tp_iternext;
    }
    for (;;) {
      if (!__pyx_t_15 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_14 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_15 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_14 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_3 = __pyx_t_15(__pyx_t_1);
        if (unlikely(!__pyx_t_3)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vari);
      __pyx_v_vari = __pyx_t_3;
      __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line612")'> 612: 		var_vals = [float(amt) for amt in var_vals]</pre>
<pre id='line612' class='code' style='background-color: #FFFF1e'>
    /* "libchemicalstring_2.pyx":612
 * 		variables, var_vals = zip(*[vari.split(':')
 * 					for vari in sub_var_string])
 * 		var_vals = [float(amt) for amt in var_vals]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	else: variables, var_vals = [], []
 */
    __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_var_vals) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_var_vals)) {
      __pyx_t_8 = __pyx_v_var_vals; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
    } else {
      __pyx_t_14 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_var_vals);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_15 = Py_TYPE(__pyx_t_8)->tp_iternext;
    }
    for (;;) {
      if (!__pyx_t_15 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8)) {
        if (__pyx_t_14 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_15 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8)) {
        if (__pyx_t_14 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_1 = __pyx_t_15(__pyx_t_8);
        if (unlikely(!__pyx_t_1)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_amt);
      __pyx_v_amt = __pyx_t_1;
      __pyx_t_1 = 0;
      __pyx_t_16 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_v_amt);<span class='error_goto'> if (unlikely(__pyx_t_16 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_2, (PyObject*)__pyx_t_1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_var_vals);
    __pyx_v_var_vals = ((PyObject *)__pyx_t_2);
    __pyx_t_2 = 0;
    goto __pyx_L34;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line613")'> 613: </pre>
<pre id='line613' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line614")'> 614: 	else: variables, var_vals = [], []</pre>
<pre id='line614' class='code' style='background-color: #FFFF79'>
    /* "libchemicalstring_2.pyx":614
 * 		var_vals = [float(amt) for amt in var_vals]
 * 
 * 	else: variables, var_vals = [], []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 614; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 614; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_variables);
    __pyx_v_variables = ((PyObject *)__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_v_var_vals = ((PyObject *)__pyx_t_8);
    __pyx_t_8 = 0;
  }
  __pyx_L34:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line615")'> 615: </pre>
<pre id='line615' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line616")'> 616: </pre>
<pre id='line616' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line617")'> 617: 	#initialize the current state vector, counts</pre>
<pre id='line617' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line618")'> 618: 	#counts should follow the form:</pre>
<pre id='line618' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line619")'> 619: 	# ['null', 'iteration', 'time', 'fixed_time', species1, ..., speciesN, variable1, ..., variableM, function1, ..., functionR]</pre>
<pre id='line619' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line620")'> 620: 	#count_targets is a 1 - 1 list of labels for these data slots</pre>
<pre id='line620' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1a' onclick='toggleDiv("line621")'> 621: 	species, counts = zip(*[spec.split(':') for spec in</pre>
<pre id='line621' class='code' style='background-color: #FFFF1a'>
  /* "libchemicalstring_2.pyx":621
 * 	# ['null', 'iteration', 'time', 'fixed_time', species1, ..., speciesN, variable1, ..., variableM, function1, ..., functionR]
 * 	#count_targets is a 1 - 1 list of labels for these data slots
 * 	species, counts = zip(*[spec.split(':') for spec in             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			species[species.find('>') + 1:].split(',')])
 * 	count_targets = ['null', 'iteration', 'time', 'fixed_time'] + \
 */
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);

    /* "libchemicalstring_2.pyx":621
 * 	# ['null', 'iteration', 'time', 'fixed_time', species1, ..., speciesN, variable1, ..., variableM, function1, ..., functionR]
 * 	#count_targets is a 1 - 1 list of labels for these data slots
 * 	species, counts = zip(*[spec.split(':') for spec in             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			species[species.find('>') + 1:].split(',')])
 * 	count_targets = ['null', 'iteration', 'time', 'fixed_time'] + \
 */
    __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_spec, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_141), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_8, (PyObject*)__pyx_t_3)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PySequence_Tuple</span>(((PyObject *)__pyx_t_8));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_zip, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
    PyObject* sequence = __pyx_t_8;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  } else
  {
    Py_ssize_t index = -1;
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_12 = Py_TYPE(__pyx_t_1)->tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_12(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L43_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_12(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L43_unpacking_failed;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_1), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L44_unpacking_done;
    __pyx_L43_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L44_unpacking_done:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_species);
  __pyx_v_species = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_counts = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "libchemicalstring_2.pyx":621
 * 	# ['null', 'iteration', 'time', 'fixed_time', species1, ..., speciesN, variable1, ..., variableM, function1, ..., functionR]
 * 	#count_targets is a 1 - 1 list of labels for these data slots
 * 	species, counts = zip(*[spec.split(':') for spec in             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			species[species.find('>') + 1:].split(',')])
 * 	count_targets = ['null', 'iteration', 'time', 'fixed_time'] + \
 */
  __pyx_k_tuple_141 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_5));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_141)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_141);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_141));
</pre><pre class='line' style='background-color: #FFFF18' onclick='toggleDiv("line622")'> 622: 			species[species.find('&gt;') + 1:].split(',')])</pre>
<pre id='line622' class='code' style='background-color: #FFFF18'>
  /* "libchemicalstring_2.pyx":622
 * 	#count_targets is a 1 - 1 list of labels for these data slots
 * 	species, counts = zip(*[spec.split(':') for spec in
 * 			species[species.find('>') + 1:].split(',')])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	count_targets = ['null', 'iteration', 'time', 'fixed_time'] + \
 * 									list(species) + list(variables)
 */
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_species, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_139), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_species, 0, 0, &__pyx_t_2, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":622
 * 	#count_targets is a 1 - 1 list of labels for these data slots
 * 	species, counts = zip(*[spec.split(':') for spec in
 * 			species[species.find('>') + 1:].split(',')])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	count_targets = ['null', 'iteration', 'time', 'fixed_time'] + \
 * 									list(species) + list(variables)
 */
  __pyx_k_tuple_139 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_90));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_139)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_139);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_139));
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_140), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_14 = 0;
    __pyx_t_15 = NULL;
  } else {
    __pyx_t_14 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_15 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (!__pyx_t_15 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_15 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_1 = __pyx_t_15(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_spec);
    __pyx_v_spec = __pyx_t_1;
    __pyx_t_1 = 0;
  __pyx_k_tuple_140 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_136));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_140)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_140);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_140));
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line623")'> 623: 	count_targets = ['null', 'iteration', 'time', 'fixed_time'] + \</pre>
<pre id='line623' class='code' style='background-color: #FFFF6e'>
  /* "libchemicalstring_2.pyx":623
 * 	species, counts = zip(*[spec.split(':') for spec in
 * 			species[species.find('>') + 1:].split(',')])
 * 	count_targets = ['null', 'iteration', 'time', 'fixed_time'] + \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 									list(species) + list(variables)
 * 	counts = [0, iteration, time, fixed_time] + \
 */
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__null));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, ((PyObject *)__pyx_n_s__null));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__null));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__iteration));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, ((PyObject *)__pyx_n_s__iteration));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__iteration));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__time));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 2, ((PyObject *)__pyx_n_s__time));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__time));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__fixed_time));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 3, ((PyObject *)__pyx_n_s__fixed_time));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__fixed_time));
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line624")'> 624: 									list(species) + list(variables)</pre>
<pre id='line624' class='code' style='background-color: #FFFF33'>
  /* "libchemicalstring_2.pyx":624
 * 			species[species.find('>') + 1:].split(',')])
 * 	count_targets = ['null', 'iteration', 'time', 'fixed_time'] + \
 * 									list(species) + list(variables)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	counts = [0, iteration, time, fixed_time] + \
 * 			[int(amt) for amt in counts] + var_vals
 */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 624; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_species);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_species);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_species);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyList_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 624; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_t_8), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 624; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_variables);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_variables);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_variables);
  __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyList_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 624; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_t_3), __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 624; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_count_targets = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line625")'> 625: 	counts = [0, iteration, time, fixed_time] + \</pre>
<pre id='line625' class='code' style='background-color: #FFFF48'>
  /* "libchemicalstring_2.pyx":625
 * 	count_targets = ['null', 'iteration', 'time', 'fixed_time'] + \
 * 									list(species) + list(variables)
 * 	counts = [0, iteration, time, fixed_time] + \             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			[int(amt) for amt in counts] + var_vals
 * 
 */
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_iteration);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_time);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_fixed_time);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_8);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_8 = 0;
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF1a' onclick='toggleDiv("line626")'> 626: 			[int(amt) for amt in counts] + var_vals</pre>
<pre id='line626' class='code' style='background-color: #FFFF1a'>
  /* "libchemicalstring_2.pyx":626
 * 									list(species) + list(variables)
 * 	counts = [0, iteration, time, fixed_time] + \
 * 			[int(amt) for amt in counts] + var_vals             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_counts) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_counts)) {
    __pyx_t_8 = __pyx_v_counts; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_14 = 0;
    __pyx_t_15 = NULL;
  } else {
    __pyx_t_14 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_counts);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_15 = Py_TYPE(__pyx_t_8)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_15 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_15 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_2 = __pyx_t_15(__pyx_t_8);
      if (unlikely(!__pyx_t_2)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_amt);
    __pyx_v_amt = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_amt);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_amt);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_amt);
    __pyx_t_17 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_17)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_t_1), ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_t_8), __pyx_v_var_vals);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_counts);
  __pyx_v_counts = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line627")'> 627: </pre>
<pre id='line627' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line628")'> 628: </pre>
<pre id='line628' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line629")'> 629: 	#functions depend on variables and species - initialize and add last</pre>
<pre id='line629' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line630")'> 630: 	#parse functions and calculate their initial values</pre>
<pre id='line630' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line631")'> 631: 	#functions may not depend on each other</pre>
<pre id='line631' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line632")'> 632: 	functions = functions[functions.find('&gt;') + 1:].split(',')</pre>
<pre id='line632' class='code' style='background-color: #FFFF2d'>
  /* "libchemicalstring_2.pyx":632
 * 	#parse functions and calculate their initial values
 * 	#functions may not depend on each other
 * 	functions = functions[functions.find('>') + 1:].split(',')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	if functions[0]:
 * 		func_names, functions = generate_functions(
 */
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_functions, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_142), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_functions, 0, 0, &__pyx_t_3, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;

  /* "libchemicalstring_2.pyx":632
 * 	#parse functions and calculate their initial values
 * 	#functions may not depend on each other
 * 	functions = functions[functions.find('>') + 1:].split(',')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	if functions[0]:
 * 		func_names, functions = generate_functions(
 */
  __pyx_k_tuple_142 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_90));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_142)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_142);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_142));
  __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_143), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_functions);
  __pyx_v_functions = __pyx_t_8;
  __pyx_t_8 = 0;
  __pyx_k_tuple_143 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_136));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_143)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_143);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_143));
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line633")'> 633: 	if functions[0]:</pre>
<pre id='line633' class='code' style='background-color: #FFFF8d'>
  /* "libchemicalstring_2.pyx":633
 * 	#functions may not depend on each other
 * 	functions = functions[functions.find('>') + 1:].split(',')
 * 	if functions[0]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		func_names, functions = generate_functions(
 * 				functions, count_targets, counts)
 */
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_functions, 0, sizeof(long), PyInt_FromLong, 0, 0, 0);<span class='error_goto'> if (!__pyx_t_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 633; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_11 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_11 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 633; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (__pyx_t_11) {
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line634")'> 634: 		func_names, functions = generate_functions(</pre>
<pre id='line634' class='code' style='background-color: #FFFFc4'>
    /* "libchemicalstring_2.pyx":634
 * 	functions = functions[functions.find('>') + 1:].split(',')
 * 	if functions[0]:
 * 		func_names, functions = generate_functions(             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				functions, count_targets, counts)
 * 
 */
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__generate_functions);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);

    /* "libchemicalstring_2.pyx":634
 * 	functions = functions[functions.find('>') + 1:].split(',')
 * 	if functions[0]:
 * 		func_names, functions = generate_functions(             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				functions, count_targets, counts)
 * 
 */
    __pyx_v_func_names = __pyx_t_3;
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_functions);
    __pyx_v_functions = __pyx_t_8;
    __pyx_t_8 = 0;
    goto __pyx_L47;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line635")'> 635: 				functions, count_targets, counts)</pre>
<pre id='line635' class='code' style='background-color: #FFFF22'>
    /* "libchemicalstring_2.pyx":635
 * 	if functions[0]:
 * 		func_names, functions = generate_functions(
 * 				functions, count_targets, counts)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	else: func_names, functions = [], []
 */
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_functions);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_functions);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_functions);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_count_targets));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, ((PyObject *)__pyx_v_count_targets));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_count_targets));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_v_counts);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else
    {
      Py_ssize_t index = -1;
      __pyx_t_17 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_17)->tp_iternext;
      index = 0; __pyx_t_3 = __pyx_t_12(__pyx_t_17); if (unlikely(!__pyx_t_3)) goto __pyx_L48_unpacking_failed;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      index = 1; __pyx_t_8 = __pyx_t_12(__pyx_t_17); if (unlikely(!__pyx_t_8)) goto __pyx_L48_unpacking_failed;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_17), 2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      goto __pyx_L49_unpacking_done;
      __pyx_L48_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_L49_unpacking_done:;
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line636")'> 636: </pre>
<pre id='line636' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line637")'> 637: 	else: func_names, functions = [], []</pre>
<pre id='line637' class='code' style='background-color: #FFFF79'>
    /* "libchemicalstring_2.pyx":637
 * 				functions, count_targets, counts)
 * 
 * 	else: func_names, functions = [], []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	count_targets.extend(func_names)
 * 	counts.extend([func(counts) for func in functions])
 */
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_v_func_names = ((PyObject *)__pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_functions);
    __pyx_v_functions = ((PyObject *)__pyx_t_8);
    __pyx_t_8 = 0;
  }
  __pyx_L47:;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line638")'> 638: 	count_targets.extend(func_names)</pre>
<pre id='line638' class='code' style='background-color: #FFFF55'>
  /* "libchemicalstring_2.pyx":638
 * 
 * 	else: func_names, functions = [], []
 * 	count_targets.extend(func_names)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	counts.extend([func(counts) for func in functions])
 * 	update_functions = generate_update_functions(
 */
  __pyx_t_8 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_count_targets), __pyx_n_s__extend);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_func_names);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_func_names);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_func_names);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line639")'> 639: 	counts.extend([func(counts) for func in functions])</pre>
<pre id='line639' class='code' style='background-color: #FFFF19'>
  /* "libchemicalstring_2.pyx":639
 * 	else: func_names, functions = [], []
 * 	count_targets.extend(func_names)
 * 	counts.extend([func(counts) for func in functions])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	update_functions = generate_update_functions(
 * 		count_targets, counts, functions, func_names)
 */
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_counts, __pyx_n_s__extend);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_functions) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_functions)) {
    __pyx_t_8 = __pyx_v_functions; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_14 = 0;
    __pyx_t_15 = NULL;
  } else {
    __pyx_t_14 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_functions);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_15 = Py_TYPE(__pyx_t_8)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_15 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_17 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_17 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_15 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_17 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_17 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_17 = __pyx_t_15(__pyx_t_8);
      if (unlikely(!__pyx_t_17)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_func);
    __pyx_v_func = __pyx_t_17;
    __pyx_t_17 = 0;
    __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_v_counts);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_v_func, ((PyObject *)__pyx_t_17), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_2)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, ((PyObject *)__pyx_t_1));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_1));
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line640")'> 640: 	update_functions = generate_update_functions(</pre>
<pre id='line640' class='code' style='background-color: #FFFFd4'>
  /* "libchemicalstring_2.pyx":640
 * 	count_targets.extend(func_names)
 * 	counts.extend([func(counts) for func in functions])
 * 	update_functions = generate_update_functions(             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		count_targets, counts, functions, func_names)
 * 	#functions are captured but not updated in the counts lists
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_144);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line641")'> 641: 		count_targets, counts, functions, func_names)</pre>
<pre id='line641' class='code' style='background-color: #FFFF55'>
  /* "libchemicalstring_2.pyx":641
 * 	counts.extend([func(counts) for func in functions])
 * 	update_functions = generate_update_functions(
 * 		count_targets, counts, functions, func_names)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	#functions are captured but not updated in the counts lists
 * 
 */
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_count_targets));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, ((PyObject *)__pyx_v_count_targets));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_count_targets));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_functions);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_v_functions);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_functions);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_func_names);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 3, __pyx_v_func_names);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_func_names);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
  __pyx_v_update_functions = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line642")'> 642: 	#functions are captured but not updated in the counts lists</pre>
<pre id='line642' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line643")'> 643: </pre>
<pre id='line643' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line644")'> 644: </pre>
<pre id='line644' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line645")'> 645: 	#parse and create the reactions</pre>
<pre id='line645' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line646")'> 646: 	rxn_split = rxns[rxns.find('&gt;') + 1:].split(',')</pre>
<pre id='line646' class='code' style='background-color: #FFFF2e'>
  /* "libchemicalstring_2.pyx":646
 * 
 * 	#parse and create the reactions
 * 	rxn_split = rxns[rxns.find('>') + 1:].split(',')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	rate_call_group = []
 * 	propensities, validators, reactions, reagents, products =\
 */
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_rxns, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_145), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_rxns, 0, 0, &__pyx_t_3, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;

  /* "libchemicalstring_2.pyx":646
 * 
 * 	#parse and create the reactions
 * 	rxn_split = rxns[rxns.find('>') + 1:].split(',')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	rate_call_group = []
 * 	propensities, validators, reactions, reagents, products =\
 */
  __pyx_k_tuple_145 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_90));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_145)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_145);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_145));
  __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_146), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rxn_split = __pyx_t_8;
  __pyx_t_8 = 0;
  __pyx_k_tuple_146 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_136));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_146)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_146);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_146));
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line647")'> 647: 	rate_call_group = []</pre>
<pre id='line647' class='code' style='background-color: #FFFFaa'>
  /* "libchemicalstring_2.pyx":647
 * 	#parse and create the reactions
 * 	rxn_split = rxns[rxns.find('>') + 1:].split(',')
 * 	rate_call_group = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	propensities, validators, reactions, reagents, products =\
 * 			zip(*[generate_reaction(count_targets, counts, functions,
 */
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 647; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_v_rate_call_group = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line648")'> 648: 	propensities, validators, reactions, reagents, products =\</pre>
<pre id='line648' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":648
 * 	rxn_split = rxns[rxns.find('>') + 1:].split(',')
 * 	rate_call_group = []
 * 	propensities, validators, reactions, reagents, products =\             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			zip(*[generate_reaction(count_targets, counts, functions,
 * 							func_names, var_vals, variables,
 */
  __pyx_v_propensities = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_validators = __pyx_t_17;
  __pyx_t_17 = 0;
  __pyx_v_reactions = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_reagents = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_v_products = __pyx_t_18;
  __pyx_t_18 = 0;
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line649")'> 649: 			zip(*[generate_reaction(count_targets, counts, functions,</pre>
<pre id='line649' class='code' style='background-color: #FFFF96'>
  /* "libchemicalstring_2.pyx":649
 * 	rate_call_group = []
 * 	propensities, validators, reactions, reagents, products =\
 * 			zip(*[generate_reaction(count_targets, counts, functions,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 							func_names, var_vals, variables,
 * 								rxn_string, rate_call_group)
 */
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);

    /* "libchemicalstring_2.pyx":649
 * 	rate_call_group = []
 * 	propensities, validators, reactions, reagents, products =\
 * 			zip(*[generate_reaction(count_targets, counts, functions,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 							func_names, var_vals, variables,
 * 								rxn_string, rate_call_group)
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__generate_reaction);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line650")'> 650: 							func_names, var_vals, variables,</pre>
<pre id='line650' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF17' onclick='toggleDiv("line651")'> 651: 								rxn_string, rate_call_group)</pre>
<pre id='line651' class='code' style='background-color: #FFFF17'>
    /* "libchemicalstring_2.pyx":651
 * 			zip(*[generate_reaction(count_targets, counts, functions,
 * 							func_names, var_vals, variables,
 * 								rxn_string, rate_call_group)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 								for rxn_string in rxn_split])
 * 
 */
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_count_targets));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_count_targets));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_count_targets));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_counts);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_functions);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_functions);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_functions);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_func_names);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_v_func_names);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_func_names);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_var_vals);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 4, __pyx_v_var_vals);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_var_vals);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_variables);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 5, __pyx_v_variables);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_variables);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rxn_string);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 6, __pyx_v_rxn_string);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_rxn_string);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_rate_call_group));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 7, ((PyObject *)__pyx_v_rate_call_group));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_rate_call_group));
    __pyx_t_17 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_8, (PyObject*)__pyx_t_17)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PySequence_Tuple</span>(((PyObject *)__pyx_t_8));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_zip, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
    PyObject* sequence = __pyx_t_8;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 5)) {
      if (size > 5) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(5);
      else if (size >= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_17 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
      __pyx_t_18 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_17 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
      __pyx_t_18 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);
    #else
    Py_ssize_t i;
    PyObject** temps[5] = {&__pyx_t_3,&__pyx_t_17,&__pyx_t_2,&__pyx_t_1,&__pyx_t_18};
    for (i=0; i <code><</code> 5; i++) {
      PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(item);
      *(temps[i]) = item;
    }
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  } else
  {
    Py_ssize_t index = -1;
    PyObject** temps[5] = {&__pyx_t_3,&__pyx_t_17,&__pyx_t_2,&__pyx_t_1,&__pyx_t_18};
    __pyx_t_19 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_19);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_12 = Py_TYPE(__pyx_t_19)->tp_iternext;
    for (index=0; index <code><</code> 5; index++) {
      PyObject* item = __pyx_t_12(__pyx_t_19); if (unlikely(!item)) goto __pyx_L54_unpacking_failed;
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(item);
      *(temps[index]) = item;
    }
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_19), 5) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    goto __pyx_L55_unpacking_done;
    __pyx_L54_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    __pyx_t_12 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_L55_unpacking_done:;
  }
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line652")'> 652: 								for rxn_string in rxn_split])</pre>
<pre id='line652' class='code' style='background-color: #FFFF2a'>
  /* "libchemicalstring_2.pyx":652
 * 							func_names, var_vals, variables,
 * 								rxn_string, rate_call_group)
 * 								for rxn_string in rxn_split])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#maintain propensities in one to one with reactions
 */
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_rxn_split) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_rxn_split)) {
    __pyx_t_3 = __pyx_v_rxn_split; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_14 = 0;
    __pyx_t_15 = NULL;
  } else {
    __pyx_t_14 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_rxn_split);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_15 = Py_TYPE(__pyx_t_3)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_15 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_15 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_1 = __pyx_t_15(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rxn_string);
    __pyx_v_rxn_string = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line653")'> 653: </pre>
<pre id='line653' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line654")'> 654: 	#maintain propensities in one to one with reactions</pre>
<pre id='line654' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line655")'> 655: 	#only update when necessary; initialize here</pre>
<pre id='line655' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line656")'> 656: 	propensity_count = len(rxn_split)</pre>
<pre id='line656' class='code' style='background-color: #FFFFaa'>
  /* "libchemicalstring_2.pyx":656
 * 	#maintain propensities in one to one with reactions
 * 	#only update when necessary; initialize here
 * 	propensity_count = len(rxn_split)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef double [:] propensity_table
 * 	propensity_table = np.zeros(propensity_count)
 */
  __pyx_t_14 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_rxn_split);<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 656; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_propensity_count = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line657")'> 657: 	cdef double [:] propensity_table</pre>
<pre id='line657' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line658")'> 658: 	propensity_table = np.zeros(propensity_count)</pre>
<pre id='line658' class='code' style='background-color: #FFFF41'>
  /* "libchemicalstring_2.pyx":658
 * 	propensity_count = len(rxn_split)
 * 	cdef double [:] propensity_table
 * 	propensity_table = np.zeros(propensity_count)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	for dex, prop in enumerate(propensities):
 * 		propensity_table[dex] = prop()
 */
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_18 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_propensity_count);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_8);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_18, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_20.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_propensity_table = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line659")'> 659: 	for dex, prop in enumerate(propensities):</pre>
<pre id='line659' class='code' style='background-color: #FFFF2a'>
  /* "libchemicalstring_2.pyx":659
 * 	cdef double [:] propensity_table
 * 	propensity_table = np.zeros(propensity_count)
 * 	for dex, prop in enumerate(propensities):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		propensity_table[dex] = prop()
 * 
 */
  __pyx_t_13 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_propensities) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_propensities)) {
    __pyx_t_8 = __pyx_v_propensities; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_14 = 0;
    __pyx_t_15 = NULL;
  } else {
    __pyx_t_14 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_propensities);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_15 = Py_TYPE(__pyx_t_8)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_15 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_15 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_1 = __pyx_t_15(__pyx_t_8);
      if (unlikely(!__pyx_t_1)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_prop);
    __pyx_v_prop = __pyx_t_1;
    __pyx_t_1 = 0;
    __pyx_v_dex = __pyx_t_13;
    __pyx_t_13 = (__pyx_t_13 + 1);
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line660")'> 660: 		propensity_table[dex] = prop()</pre>
<pre id='line660' class='code' style='background-color: #FFFF5e'>
    /* "libchemicalstring_2.pyx":660
 * 	propensity_table = np.zeros(propensity_count)
 * 	for dex, prop in enumerate(propensities):
 * 		propensity_table[dex] = prop()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#wrap propensities so that each instead function
 */
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_v_prop, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_16 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_16 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_21 = __pyx_v_dex;
    if (__pyx_t_21 <code><</code> 0) __pyx_t_21 += __pyx_v_propensity_table.shape[0];
    *((double *) ( /* dim=0 */ (__pyx_v_propensity_table.data + __pyx_t_21 * __pyx_v_propensity_table.strides[0]) )) = __pyx_t_16;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line661")'> 661: </pre>
<pre id='line661' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line662")'> 662: 	#wrap propensities so that each instead function</pre>
<pre id='line662' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line663")'> 663: 	# instead updates the propensity which its corresponding rxn</pre>
<pre id='line663' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line664")'> 664: 	#  modified while reacting</pre>
<pre id='line664' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line665")'> 665: 	#subsequently call rxn's propensity function post-reacting</pre>
<pre id='line665' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line666")'> 666: 	propensities = wrap_propensities(propensity_table,</pre>
<pre id='line666' class='code' style='background-color: #FFFFd4'>
  /* "libchemicalstring_2.pyx":666
 * 	#  modified while reacting
 * 	#subsequently call rxn's propensity function post-reacting
 * 	propensities = wrap_propensities(propensity_table,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		propensities, reagents, products, rate_call_group)
 * 	#could/should the same thing be done with functions?
 */
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__wrap_propensities);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_propensity_table, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line667")'> 667: 		propensities, reagents, products, rate_call_group)</pre>
<pre id='line667' class='code' style='background-color: #FFFF4f'>
  /* "libchemicalstring_2.pyx":667
 * 	#subsequently call rxn's propensity function post-reacting
 * 	propensities = wrap_propensities(propensity_table,
 * 		propensities, reagents, products, rate_call_group)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	#could/should the same thing be done with functions?
 * 	# could update a function_values table before capture
 */
  __pyx_t_18 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_propensities);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 1, __pyx_v_propensities);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_propensities);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_reagents);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 2, __pyx_v_reagents);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_reagents);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_products);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 3, __pyx_v_products);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_products);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_rate_call_group));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 4, ((PyObject *)__pyx_v_rate_call_group));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_rate_call_group));
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_18), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_18)); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_propensities);
  __pyx_v_propensities = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line668")'> 668: 	#could/should the same thing be done with functions?</pre>
<pre id='line668' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line669")'> 669: 	# could update a function_values table before capture</pre>
<pre id='line669' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line670")'> 670: 	# also update function_values table based on reactions</pre>
<pre id='line670' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line671")'> 671: 	#  effect on the system (changes in species count, time, etc)</pre>
<pre id='line671' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line672")'> 672: 	# thus a function would only not need to be updated if it</pre>
<pre id='line672' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line673")'> 673: 	#  depends on no species whose count changed not on time/fixed_time</pre>
<pre id='line673' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line674")'> 674: </pre>
<pre id='line674' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line675")'> 675: </pre>
<pre id='line675' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line676")'> 676: 	#targets string parsed into a list or strings</pre>
<pre id='line676' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line677")'> 677: 	# targets can be species, variables, or functions</pre>
<pre id='line677' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line678")'> 678: 	#initialize output data structure</pre>
<pre id='line678' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line679")'> 679: 	targets = targets[targets.find('&gt;') + 1:].split(',')</pre>
<pre id='line679' class='code' style='background-color: #FFFF2d'>
  /* "libchemicalstring_2.pyx":679
 * 	# targets can be species, variables, or functions
 * 	#initialize output data structure
 * 	targets = targets[targets.find('>') + 1:].split(',')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	targets = follow_order(targets, count_targets)
 * 
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_targets, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_18 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_147), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_18, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_18 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_targets, 0, 0, &__pyx_t_1, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_18, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;

  /* "libchemicalstring_2.pyx":679
 * 	# targets can be species, variables, or functions
 * 	#initialize output data structure
 * 	targets = targets[targets.find('>') + 1:].split(',')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	targets = follow_order(targets, count_targets)
 * 
 */
  __pyx_k_tuple_147 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_90));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_147)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_147);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_147));
  __pyx_t_18 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_148), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_targets);
  __pyx_v_targets = __pyx_t_18;
  __pyx_t_18 = 0;
  __pyx_k_tuple_148 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_136));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_148)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_148);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_148));
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line680")'> 680: 	targets = follow_order(targets, count_targets)</pre>
<pre id='line680' class='code' style='background-color: #FFFFe7'>
  /* "libchemicalstring_2.pyx":680
 * 	#initialize output data structure
 * 	targets = targets[targets.find('>') + 1:].split(',')
 * 	targets = follow_order(targets, count_targets)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#DETERMINE TOTAL POINTS, REWRITE ALGORITHM SO EXACTLY THIS MANY CAPTURES OCCUR
 */
  __pyx_t_18 = __pyx_f_14stringchemical_follow_order(__pyx_v_targets, ((PyObject *)__pyx_v_count_targets));<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 680; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_targets);
  __pyx_v_targets = __pyx_t_18;
  __pyx_t_18 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line681")'> 681: </pre>
<pre id='line681' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line682")'> 682: 	#DETERMINE TOTAL POINTS, REWRITE ALGORITHM SO EXACTLY THIS MANY CAPTURES OCCUR</pre>
<pre id='line682' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line683")'> 683: 	# KEEP THE DATA IN A NP MATRIX!!!</pre>
<pre id='line683' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line684")'> 684: 	data = [[] for dex in range(len(count_targets))]</pre>
<pre id='line684' class='code' style='background-color: #FFFF6a'>
  /* "libchemicalstring_2.pyx":684
 * 	#DETERMINE TOTAL POINTS, REWRITE ALGORITHM SO EXACTLY THIS MANY CAPTURES OCCUR
 * 	# KEEP THE DATA IN A NP MATRIX!!!
 * 	data = [[] for dex in range(len(count_targets))]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	target_dexes = [count_targets.index(targ) for targ in targets]
 * 
 */
  __pyx_t_18 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  __pyx_t_14 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_count_targets));<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  for (__pyx_t_13 = 0; __pyx_t_13 <code><</code> __pyx_t_14; __pyx_t_13+=1) {
    __pyx_v_dex = __pyx_t_13;
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_18, (PyObject*)__pyx_t_1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  }
  __pyx_v_data = ((PyObject*)__pyx_t_18);
  __pyx_t_18 = 0;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line685")'> 685: 	target_dexes = [count_targets.index(targ) for targ in targets]</pre>
<pre id='line685' class='code' style='background-color: #FFFF1c'>
  /* "libchemicalstring_2.pyx":685
 * 	# KEEP THE DATA IN A NP MATRIX!!!
 * 	data = [[] for dex in range(len(count_targets))]
 * 	target_dexes = [count_targets.index(targ) for targ in targets]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_18 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_targets) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_targets)) {
    __pyx_t_1 = __pyx_v_targets; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14 = 0;
    __pyx_t_15 = NULL;
  } else {
    __pyx_t_14 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_targets);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_15 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_15 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_15 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_8 = __pyx_t_15(__pyx_t_1);
      if (unlikely(!__pyx_t_8)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_targ);
    __pyx_v_targ = __pyx_t_8;
    __pyx_t_8 = 0;
    __pyx_t_8 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_count_targets), __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_targ);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_targ);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_targ);
    __pyx_t_17 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_18, (PyObject*)__pyx_t_17)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_target_dexes = ((PyObject*)__pyx_t_18);
  __pyx_t_18 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line686")'> 686: </pre>
<pre id='line686' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line687")'> 687: </pre>
<pre id='line687' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line688")'> 688: 	#create a function which tests if the simulation should end</pre>
<pre id='line688' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line689")'> 689: 	ends = end[end.find('&gt;') + 1:].split(',')</pre>
<pre id='line689' class='code' style='background-color: #FFFF2e'>
  /* "libchemicalstring_2.pyx":689
 * 
 * 	#create a function which tests if the simulation should end
 * 	ends = end[end.find('>') + 1:].split(',')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	end_test = generate_test(count_targets, data, counts, ends)
 * 
 */
  __pyx_t_18 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_end, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_18, ((PyObject *)__pyx_k_tuple_149), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_18 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_end, 0, 0, &__pyx_t_18, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_18 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

  /* "libchemicalstring_2.pyx":689
 * 
 * 	#create a function which tests if the simulation should end
 * 	ends = end[end.find('>') + 1:].split(',')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	end_test = generate_test(count_targets, data, counts, ends)
 * 
 */
  __pyx_k_tuple_149 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_90));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_149)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_149);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_149));
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_18, ((PyObject *)__pyx_k_tuple_150), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_v_ends = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_k_tuple_150 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_136));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_150)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_150);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_150));
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line690")'> 690: 	end_test = generate_test(count_targets, data, counts, ends)</pre>
<pre id='line690' class='code' style='background-color: #FFFF4f'>
  /* "libchemicalstring_2.pyx":690
 * 	#create a function which tests if the simulation should end
 * 	ends = end[end.find('>') + 1:].split(',')
 * 	end_test = generate_test(count_targets, data, counts, ends)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__generate_test);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 690; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_18 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 690; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_count_targets));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0, ((PyObject *)__pyx_v_count_targets));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_count_targets));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_data));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 1, ((PyObject *)__pyx_v_data));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_data));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 2, __pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ends);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 3, __pyx_v_ends);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_ends);
  __pyx_t_17 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_18), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 690; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_18)); __pyx_t_18 = 0;
  __pyx_v_end_test = __pyx_t_17;
  __pyx_t_17 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line691")'> 691: </pre>
<pre id='line691' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line692")'> 692: </pre>
<pre id='line692' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line693")'> 693: 	#create a function which tests of the current state</pre>
<pre id='line693' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line694")'> 694: 	# of the system should be captured</pre>
<pre id='line694' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line695")'> 695: 	#create a function which captures the current state of the system</pre>
<pre id='line695' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line696")'> 696: 	capts = capture[capture.find('&gt;') + 1:].split(',')</pre>
<pre id='line696' class='code' style='background-color: #FFFF2e'>
  /* "libchemicalstring_2.pyx":696
 * 	# of the system should be captured
 * 	#create a function which captures the current state of the system
 * 	capts = capture[capture.find('>') + 1:].split(',')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	capture_test = generate_test(count_targets, data, counts, capts)
 * 	capture = generate_capture_function(data, target_dexes, counts)
 */
  __pyx_t_17 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_capture, __pyx_n_s__find);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
  __pyx_t_18 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_17, ((PyObject *)__pyx_k_tuple_151), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  __pyx_t_17 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_18, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_18 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_capture, 0, 0, &__pyx_t_17, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  __pyx_t_17 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_18, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;

  /* "libchemicalstring_2.pyx":696
 * 	# of the system should be captured
 * 	#create a function which captures the current state of the system
 * 	capts = capture[capture.find('>') + 1:].split(',')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	capture_test = generate_test(count_targets, data, counts, capts)
 * 	capture = generate_capture_function(data, target_dexes, counts)
 */
  __pyx_k_tuple_151 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_90));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_151)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_151);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_151));
  __pyx_t_18 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_17, ((PyObject *)__pyx_k_tuple_152), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  __pyx_v_capts = __pyx_t_18;
  __pyx_t_18 = 0;
  __pyx_k_tuple_152 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_136));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_152)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_152);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_152));
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line697")'> 697: 	capture_test = generate_test(count_targets, data, counts, capts)</pre>
<pre id='line697' class='code' style='background-color: #FFFF4f'>
  /* "libchemicalstring_2.pyx":697
 * 	#create a function which captures the current state of the system
 * 	capts = capture[capture.find('>') + 1:].split(',')
 * 	capture_test = generate_test(count_targets, data, counts, capts)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	capture = generate_capture_function(data, target_dexes, counts)
 * 
 */
  __pyx_t_18 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__generate_test);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_count_targets));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, ((PyObject *)__pyx_v_count_targets));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_count_targets));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_data));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, ((PyObject *)__pyx_v_data));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_data));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_capts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 3, __pyx_v_capts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_capts);
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_18, ((PyObject *)__pyx_t_17), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __pyx_v_capture_test = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line698")'> 698: 	capture = generate_capture_function(data, target_dexes, counts)</pre>
<pre id='line698' class='code' style='background-color: #FFFF52'>
  /* "libchemicalstring_2.pyx":698
 * 	capts = capture[capture.find('>') + 1:].split(',')
 * 	capture_test = generate_test(count_targets, data, counts, capts)
 * 	capture = generate_capture_function(data, target_dexes, counts)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_153);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 698; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 698; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_data));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, ((PyObject *)__pyx_v_data));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_data));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_target_dexes));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, ((PyObject *)__pyx_v_target_dexes));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_target_dexes));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_v_counts);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_counts);
  __pyx_t_18 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_17), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 698; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_capture);
  __pyx_v_capture = __pyx_t_18;
  __pyx_t_18 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line699")'> 699: </pre>
<pre id='line699' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line700")'> 700: </pre>
<pre id='line700' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line701")'> 701: 	#if 'time' is used for capture criteria,</pre>
<pre id='line701' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line702")'> 702: 	# inherit increment for fixed_delt</pre>
<pre id='line702' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line703")'> 703: 	uses_time = ['time' in spl for spl in capts]</pre>
<pre id='line703' class='code' style='background-color: #FFFF20'>
  /* "libchemicalstring_2.pyx":703
 * 	#if 'time' is used for capture criteria,
 * 	# inherit increment for fixed_delt
 * 	uses_time = ['time' in spl for spl in capts]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	if True in uses_time:
 * 		capt = capts[uses_time.index(True)]
 */
  __pyx_t_18 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_capts) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_capts)) {
    __pyx_t_17 = __pyx_v_capts; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17); __pyx_t_14 = 0;
    __pyx_t_15 = NULL;
  } else {
    __pyx_t_14 = -1; __pyx_t_17 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_capts);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
    __pyx_t_15 = Py_TYPE(__pyx_t_17)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_15 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_17)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_17)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_17, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_17, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_15 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_17)) {
      if (__pyx_t_14 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_17)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_17, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_17, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_1 = __pyx_t_15(__pyx_t_17);
      if (unlikely(!__pyx_t_1)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_spl);
    __pyx_v_spl = __pyx_t_1;
    __pyx_t_1 = 0;
    __pyx_t_11 = (__Pyx_<span class='py_c_api'>PySequence_Contains</span>(((PyObject *)__pyx_n_s__time), __pyx_v_spl, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_11 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_18, (PyObject*)__pyx_t_1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  __pyx_v_uses_time = ((PyObject*)__pyx_t_18);
  __pyx_t_18 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line704")'> 704: 	if True in uses_time:</pre>
<pre id='line704' class='code' style='background-color: #FFFF79'>
  /* "libchemicalstring_2.pyx":704
 * 	# inherit increment for fixed_delt
 * 	uses_time = ['time' in spl for spl in capts]
 * 	if True in uses_time:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		capt = capts[uses_time.index(True)]
 * 		fixed_delt = float(capt[capt.rfind(':') + 1:])
 */
  __pyx_t_18 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 704; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  __pyx_t_11 = (__Pyx_<span class='py_c_api'>PySequence_Contains</span>(__pyx_t_18, ((PyObject *)__pyx_v_uses_time), Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_11 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 704; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_9 = (__pyx_t_11 != 0);
  if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line705")'> 705: 		capt = capts[uses_time.index(True)]</pre>
<pre id='line705' class='code' style='background-color: #FFFF41'>
    /* "libchemicalstring_2.pyx":705
 * 	uses_time = ['time' in spl for spl in capts]
 * 	if True in uses_time:
 * 		capt = capts[uses_time.index(True)]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		fixed_delt = float(capt[capt.rfind(':') + 1:])
 * 
 */
    __pyx_t_18 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_uses_time), __pyx_n_s__index);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
    __pyx_t_17 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_17);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_17);
    __pyx_t_17 = 0;
    __pyx_t_17 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_18, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_capts, __pyx_t_17);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
    __pyx_v_capt = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF34' onclick='toggleDiv("line706")'> 706: 		fixed_delt = float(capt[capt.rfind(':') + 1:])</pre>
<pre id='line706' class='code' style='background-color: #FFFF34'>
    /* "libchemicalstring_2.pyx":706
 * 	if True in uses_time:
 * 		capt = capts[uses_time.index(True)]
 * 		fixed_delt = float(capt[capt.rfind(':') + 1:])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_capt, __pyx_n_s__rfind);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_17 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_154), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_17, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
    __pyx_t_17 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_capt, 0, 0, &__pyx_t_1, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_16 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_17);<span class='error_goto'> if (unlikely(__pyx_t_16 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
    __pyx_v_fixed_delt = __pyx_t_16;
    goto __pyx_L64;
  }
  __pyx_L64:;

  /* "libchemicalstring_2.pyx":706
 * 	if True in uses_time:
 * 		capt = capts[uses_time.index(True)]
 * 		fixed_delt = float(capt[capt.rfind(':') + 1:])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_k_tuple_154 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_5));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_154)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_154);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_154));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line707")'> 707: </pre>
<pre id='line707' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line708")'> 708: </pre>
<pre id='line708' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line709")'> 709: 	#use the genrand class to generate all random numbers at once</pre>
<pre id='line709' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line710")'> 710: 	cdef int seed = int(random.random()*10000000.0)</pre>
<pre id='line710' class='code' style='background-color: #FFFF2b'>
  /* "libchemicalstring_2.pyx":710
 * 
 * 	#use the genrand class to generate all random numbers at once
 * 	cdef int seed = int(random.random()*10000000.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	cdef GENRAND rndvar = GENRAND(seed = seed)
 * 
 */
  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__random);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_17, __pyx_n_s__random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  __pyx_t_17 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(10000000.0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_18 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_17, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_18);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_18);
  __pyx_t_18 = 0;
  __pyx_t_18 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_13 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_18);<span class='error_goto'> if (unlikely((__pyx_t_13 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_v_seed = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line711")'> 711: 	cdef GENRAND rndvar = GENRAND(seed = seed)</pre>
<pre id='line711' class='code' style='background-color: #FFFF4f'>
  /* "libchemicalstring_2.pyx":711
 * 	#use the genrand class to generate all random numbers at once
 * 	cdef int seed = int(random.random()*10000000.0)
 * 	cdef GENRAND rndvar = GENRAND(seed = seed)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_18 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_18));
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_seed);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_18, ((PyObject *)__pyx_n_s__seed), __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_14stringchemical_GENRAND)), ((PyObject *)__pyx_empty_tuple), ((PyObject *)__pyx_t_18));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_18)); __pyx_t_18 = 0;
  __pyx_v_rndvar = ((struct __pyx_obj_14stringchemical_GENRAND *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line712")'> 712: </pre>
<pre id='line712' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line713")'> 713: </pre>
<pre id='line713' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line714")'> 714: 	#initilize the rxn_table</pre>
<pre id='line714' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line715")'> 715: 	cdef double [:] rxn_table</pre>
<pre id='line715' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line716")'> 716: 	rxn_table = np.zeros(propensity_count)</pre>
<pre id='line716' class='code' style='background-color: #FFFF41'>
  /* "libchemicalstring_2.pyx":716
 * 	#initilize the rxn_table
 * 	cdef double [:] rxn_table
 * 	rxn_table = np.zeros(propensity_count)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_18 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_propensity_count);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_18, ((PyObject *)__pyx_t_17), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_22.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_rxn_table = __pyx_t_22;
  __pyx_t_22.memview = NULL;
  __pyx_t_22.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line717")'> 717: </pre>
<pre id='line717' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line718")'> 718: </pre>
<pre id='line718' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line719")'> 719: 	#capture the initial state of the system</pre>
<pre id='line719' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line720")'> 720: 	capture()</pre>
<pre id='line720' class='code' style='background-color: #FFFF9f'>
  /* "libchemicalstring_2.pyx":720
 * 
 * 	#capture the initial state of the system
 * 	capture()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#the simulation loop
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_v_capture, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 720; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line721")'> 721: </pre>
<pre id='line721' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line722")'> 722: 	#the simulation loop</pre>
<pre id='line722' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line723")'> 723: 	while not end_test():</pre>
<pre id='line723' class='code' style='background-color: #FFFF79'>
  /* "libchemicalstring_2.pyx":723
 * 
 * 	#the simulation loop
 * 	while not end_test():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		#calculate the rxn_table - for rxn selection
 * 		propensity_total = 0.0 #sum(propensity_table)
 */
  while (1) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_v_end_test, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 723; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 723; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = ((!__pyx_t_9) != 0);
    if (!__pyx_t_11) break;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line724")'> 724: 		#calculate the rxn_table - for rxn selection</pre>
<pre id='line724' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line725")'> 725: 		propensity_total = 0.0 #sum(propensity_table)</pre>
<pre id='line725' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":725
 * 	while not end_test():
 * 		#calculate the rxn_table - for rxn selection
 * 		propensity_total = 0.0 #sum(propensity_table)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		for prop_dex in range(propensity_count):
 * 			if validators[prop_dex]():
 */
    __pyx_v_propensity_total = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line726")'> 726: 		for prop_dex in range(propensity_count):</pre>
<pre id='line726' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":726
 * 		#calculate the rxn_table - for rxn selection
 * 		propensity_total = 0.0 #sum(propensity_table)
 * 		for prop_dex in range(propensity_count):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			if validators[prop_dex]():
 * 				propensity_total += propensity_table[prop_dex]
 */
    __pyx_t_13 = __pyx_v_propensity_count;
    for (__pyx_t_23 = 0; __pyx_t_23 <code><</code> __pyx_t_13; __pyx_t_23+=1) {
      __pyx_v_prop_dex = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line727")'> 727: 			if validators[prop_dex]():</pre>
<pre id='line727' class='code' style='background-color: #FFFF6a'>
      /* "libchemicalstring_2.pyx":727
 * 		propensity_total = 0.0 #sum(propensity_table)
 * 		for prop_dex in range(propensity_count):
 * 			if validators[prop_dex]():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				propensity_total += propensity_table[prop_dex]
 * 
 */
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_validators, __pyx_v_prop_dex, sizeof(int), PyInt_FromLong, 0, 1, 0);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 727; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_17 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 727; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_17);<span class='error_goto'> if (unlikely(__pyx_t_11 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 727; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      if (__pyx_t_11) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line728")'> 728: 				propensity_total += propensity_table[prop_dex]</pre>
<pre id='line728' class='code' style='background-color: #FFFFff'>
        /* "libchemicalstring_2.pyx":728
 * 		for prop_dex in range(propensity_count):
 * 			if validators[prop_dex]():
 * 				propensity_total += propensity_table[prop_dex]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 			rxn_table[prop_dex] = propensity_total
 */
        __pyx_t_24 = __pyx_v_prop_dex;
        if (__pyx_t_24 <code><</code> 0) __pyx_t_24 += __pyx_v_propensity_table.shape[0];
        __pyx_v_propensity_total = (__pyx_v_propensity_total + (*((double *) ( /* dim=0 */ (__pyx_v_propensity_table.data + __pyx_t_24 * __pyx_v_propensity_table.strides[0]) ))));
        goto __pyx_L69;
      }
      __pyx_L69:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line729")'> 729: </pre>
<pre id='line729' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line730")'> 730: 			rxn_table[prop_dex] = propensity_total</pre>
<pre id='line730' class='code' style='background-color: #FFFFff'>
      /* "libchemicalstring_2.pyx":730
 * 				propensity_total += propensity_table[prop_dex]
 * 
 * 			rxn_table[prop_dex] = propensity_total             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		#if at least one rxn propensity is greater than zero,
 */
      __pyx_t_25 = __pyx_v_prop_dex;
      if (__pyx_t_25 <code><</code> 0) __pyx_t_25 += __pyx_v_rxn_table.shape[0];
      *((double *) ( /* dim=0 */ (__pyx_v_rxn_table.data + __pyx_t_25 * __pyx_v_rxn_table.strides[0]) )) = __pyx_v_propensity_total;
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line731")'> 731: </pre>
<pre id='line731' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line732")'> 732: 		#if at least one rxn propensity is greater than zero,</pre>
<pre id='line732' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line733")'> 733: 		# normalize the rxn_table</pre>
<pre id='line733' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line734")'> 734: 		if propensity_total &gt; 0.0:</pre>
<pre id='line734' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":734
 * 		#if at least one rxn propensity is greater than zero,
 * 		# normalize the rxn_table
 * 		if propensity_total > 0.0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			propensity_total_inv = 1.0/propensity_total
 * 			for dex in range(propensity_count):
 */
    __pyx_t_11 = ((__pyx_v_propensity_total > 0.0) != 0);
    if (__pyx_t_11) {
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line735")'> 735: 			propensity_total_inv = 1.0/propensity_total</pre>
<pre id='line735' class='code' style='background-color: #FFFFaa'>
      /* "libchemicalstring_2.pyx":735
 * 		# normalize the rxn_table
 * 		if propensity_total > 0.0:
 * 			propensity_total_inv = 1.0/propensity_total             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			for dex in range(propensity_count):
 * 				rxn_table[dex] = rxn_table[dex] * propensity_total_inv
 */
      if (unlikely(__pyx_v_propensity_total == 0)) {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
        #ifdef WITH_THREAD
        PyGILState_Release(__pyx_gilstate_save);
        #endif
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_propensity_total_inv = (1.0 / __pyx_v_propensity_total);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line736")'> 736: 			for dex in range(propensity_count):</pre>
<pre id='line736' class='code' style='background-color: #FFFFff'>
      /* "libchemicalstring_2.pyx":736
 * 		if propensity_total > 0.0:
 * 			propensity_total_inv = 1.0/propensity_total
 * 			for dex in range(propensity_count):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				rxn_table[dex] = rxn_table[dex] * propensity_total_inv
 * 
 */
      __pyx_t_13 = __pyx_v_propensity_count;
      for (__pyx_t_23 = 0; __pyx_t_23 <code><</code> __pyx_t_13; __pyx_t_23+=1) {
        __pyx_v_dex = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line737")'> 737: 				rxn_table[dex] = rxn_table[dex] * propensity_total_inv</pre>
<pre id='line737' class='code' style='background-color: #FFFFff'>
        /* "libchemicalstring_2.pyx":737
 * 			propensity_total_inv = 1.0/propensity_total
 * 			for dex in range(propensity_count):
 * 				rxn_table[dex] = rxn_table[dex] * propensity_total_inv             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		#else all reactions are impossible; end the simulation
 */
        __pyx_t_26 = __pyx_v_dex;
        if (__pyx_t_26 <code><</code> 0) __pyx_t_26 += __pyx_v_rxn_table.shape[0];
        __pyx_t_27 = __pyx_v_dex;
        if (__pyx_t_27 <code><</code> 0) __pyx_t_27 += __pyx_v_rxn_table.shape[0];
        *((double *) ( /* dim=0 */ (__pyx_v_rxn_table.data + __pyx_t_27 * __pyx_v_rxn_table.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_rxn_table.data + __pyx_t_26 * __pyx_v_rxn_table.strides[0]) ))) * __pyx_v_propensity_total_inv);
      }
      goto __pyx_L70;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line738")'> 738: </pre>
<pre id='line738' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line739")'> 739: 		#else all reactions are impossible; end the simulation</pre>
<pre id='line739' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line740")'> 740: 		else:</pre>
<pre id='line740' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line741")'> 741: 			timedex = len(data) - 1</pre>
<pre id='line741' class='code' style='background-color: #FFFF9f'>
      /* "libchemicalstring_2.pyx":741
 * 		#else all reactions are impossible; end the simulation
 * 		else:
 * 			timedex = len(data) - 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			bad_dex = validate_data(data, timedex)
 * 			print 'all reactions impossible; ending'
 */
      __pyx_t_14 = <span class='py_macro_api'>PyList_GET_SIZE</span>(((PyObject *)__pyx_v_data));<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_17 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_t_14 - 1));<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
      __pyx_v_timedex = __pyx_t_17;
      __pyx_t_17 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line742")'> 742: 			bad_dex = validate_data(data, timedex)</pre>
<pre id='line742' class='code' style='background-color: #FFFF7f'>
      /* "libchemicalstring_2.pyx":742
 * 		else:
 * 			timedex = len(data) - 1
 * 			bad_dex = validate_data(data, timedex)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			print 'all reactions impossible; ending'
 * 			return data, targets, bad_dex
 */
      __pyx_t_13 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_timedex);<span class='error_goto'> if (unlikely((__pyx_t_13 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_17 = __pyx_f_14stringchemical_validate_data(((PyObject *)__pyx_v_data), __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
      __pyx_v_bad_dex = __pyx_t_17;
      __pyx_t_17 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line743")'> 743: 			print 'all reactions impossible; ending'</pre>
<pre id='line743' class='code' style='background-color: #FFFFd4'>
      /* "libchemicalstring_2.pyx":743
 * 			timedex = len(data) - 1
 * 			bad_dex = validate_data(data, timedex)
 * 			print 'all reactions impossible; ending'             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			return data, targets, bad_dex
 * 
 */
      if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, ((PyObject *)__pyx_kp_s_155)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line744")'> 744: 			return data, targets, bad_dex</pre>
<pre id='line744' class='code' style='background-color: #FFFF73'>
      /* "libchemicalstring_2.pyx":744
 * 			bad_dex = validate_data(data, timedex)
 * 			print 'all reactions impossible; ending'
 * 			return data, targets, bad_dex             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		#choose a reaction based on the updated rxn_table
 */
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_data));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, ((PyObject *)__pyx_v_data));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_data));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_targets);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_v_targets);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_targets);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_bad_dex);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_v_bad_dex);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_bad_dex);
      __pyx_r = ((PyObject *)__pyx_t_17);
      __pyx_t_17 = 0;
      goto __pyx_L0;
    }
    __pyx_L70:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line745")'> 745: </pre>
<pre id='line745' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line746")'> 746: 		#choose a reaction based on the updated rxn_table</pre>
<pre id='line746' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line747")'> 747: 		#rand_rxn = random.random()</pre>
<pre id='line747' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line748")'> 748: 		rand_rxn = rndvar.gen()</pre>
<pre id='line748' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":748
 * 		#choose a reaction based on the updated rxn_table
 * 		#rand_rxn = random.random()
 * 		rand_rxn = rndvar.gen()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		rxn_dex = pick_reaction(rxn_table, rand_rxn, propensity_count)
 * 
 */
    __pyx_v_rand_rxn = ((struct __pyx_vtabstruct_14stringchemical_GENRAND *)__pyx_v_rndvar->__pyx_vtab)->gen(__pyx_v_rndvar);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line749")'> 749: 		rxn_dex = pick_reaction(rxn_table, rand_rxn, propensity_count)</pre>
<pre id='line749' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":749
 * 		#rand_rxn = random.random()
 * 		rand_rxn = rndvar.gen()
 * 		rxn_dex = pick_reaction(rxn_table, rand_rxn, propensity_count)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		#update the iteration, time
 */
    __pyx_v_rxn_dex = __pyx_f_14stringchemical_pick_reaction(__pyx_v_rxn_table, __pyx_v_rand_rxn, __pyx_v_propensity_count);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line750")'> 750: </pre>
<pre id='line750' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line751")'> 751: 		#update the iteration, time</pre>
<pre id='line751' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line752")'> 752: 		iteration += 1</pre>
<pre id='line752' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":752
 * 
 * 		#update the iteration, time
 * 		iteration += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		counts[1] = iteration
 * 		rand_time = rndvar.gen()
 */
    __pyx_v_iteration = (__pyx_v_iteration + 1);
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line753")'> 753: 		counts[1] = iteration</pre>
<pre id='line753' class='code' style='background-color: #FFFF8d'>
    /* "libchemicalstring_2.pyx":753
 * 		#update the iteration, time
 * 		iteration += 1
 * 		counts[1] = iteration             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		rand_time = rndvar.gen()
 * 		#rand_time = random.random()
 */
    __pyx_t_17 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_iteration);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
    if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_counts, 1, __pyx_t_17, sizeof(long), PyInt_FromLong, 0, 0, 0) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line754")'> 754: 		rand_time = rndvar.gen()</pre>
<pre id='line754' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":754
 * 		iteration += 1
 * 		counts[1] = iteration
 * 		rand_time = rndvar.gen()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		#rand_time = random.random()
 * 		time_step = -1.0 * log(rand_time) * propensity_total_inv
 */
    __pyx_v_rand_time = ((struct __pyx_vtabstruct_14stringchemical_GENRAND *)__pyx_v_rndvar->__pyx_vtab)->gen(__pyx_v_rndvar);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line755")'> 755: 		#rand_time = random.random()</pre>
<pre id='line755' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line756")'> 756: 		time_step = -1.0 * log(rand_time) * propensity_total_inv</pre>
<pre id='line756' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":756
 * 		rand_time = rndvar.gen()
 * 		#rand_time = random.random()
 * 		time_step = -1.0 * log(rand_time) * propensity_total_inv             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		time = (last_time + time_step)
 * 		last_time = time
 */
    __pyx_v_time_step = ((-1.0 * log(__pyx_v_rand_time)) * __pyx_v_propensity_total_inv);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line757")'> 757: 		time = (last_time + time_step)</pre>
<pre id='line757' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":757
 * 		#rand_time = random.random()
 * 		time_step = -1.0 * log(rand_time) * propensity_total_inv
 * 		time = (last_time + time_step)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		last_time = time
 * 		counts[2] = time
 */
    __pyx_v_time = (__pyx_v_last_time + __pyx_v_time_step);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line758")'> 758: 		last_time = time</pre>
<pre id='line758' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":758
 * 		time_step = -1.0 * log(rand_time) * propensity_total_inv
 * 		time = (last_time + time_step)
 * 		last_time = time             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		counts[2] = time
 * 
 */
    __pyx_v_last_time = __pyx_v_time;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line759")'> 759: 		counts[2] = time</pre>
<pre id='line759' class='code' style='background-color: #FFFF8d'>
    /* "libchemicalstring_2.pyx":759
 * 		time = (last_time + time_step)
 * 		last_time = time
 * 		counts[2] = time             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 		#if the capture criteria are met,
 */
    __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_time);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
    if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_counts, 2, __pyx_t_17, sizeof(long), PyInt_FromLong, 0, 0, 0) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line760")'> 760: </pre>
<pre id='line760' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line761")'> 761: 		#if the capture criteria are met,</pre>
<pre id='line761' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line762")'> 762: 		# perform capture and update fixed_time</pre>
<pre id='line762' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line763")'> 763: 		if capture_test():</pre>
<pre id='line763' class='code' style='background-color: #FFFF79'>
    /* "libchemicalstring_2.pyx":763
 * 		#if the capture criteria are met,
 * 		# perform capture and update fixed_time
 * 		if capture_test():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			fixed_time_step = time - data[3][-1]
 * 			fixed_steps = int((fixed_time_step + fixed_delt) / fixed_delt)
 */
    __pyx_t_17 = <span class='py_c_api'>PyObject_Call</span>(__pyx_v_capture_test, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 763; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
    __pyx_t_11 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_17);<span class='error_goto'> if (unlikely(__pyx_t_11 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 763; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
    if (__pyx_t_11) {
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line764")'> 764: 			fixed_time_step = time - data[3][-1]</pre>
<pre id='line764' class='code' style='background-color: #FFFF46'>
      /* "libchemicalstring_2.pyx":764
 * 		# perform capture and update fixed_time
 * 		if capture_test():
 * 			fixed_time_step = time - data[3][-1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			fixed_steps = int((fixed_time_step + fixed_delt) / fixed_delt)
 * 			step = 0
 */
      __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_time);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_data, 3), -1, sizeof(long), PyInt_FromLong, 0, 1, 0);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_18 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_17, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_16 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_18);<span class='error_goto'> if (unlikely((__pyx_t_16 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
      __pyx_v_fixed_time_step = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line765")'> 765: 			fixed_steps = int((fixed_time_step + fixed_delt) / fixed_delt)</pre>
<pre id='line765' class='code' style='background-color: #FFFFaa'>
      /* "libchemicalstring_2.pyx":765
 * 		if capture_test():
 * 			fixed_time_step = time - data[3][-1]
 * 			fixed_steps = int((fixed_time_step + fixed_delt) / fixed_delt)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			step = 0
 * 			while step <code><</code> fixed_steps:
 */
      __pyx_t_16 = (__pyx_v_fixed_time_step + __pyx_v_fixed_delt);
      if (unlikely(__pyx_v_fixed_delt == 0)) {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
        #ifdef WITH_THREAD
        PyGILState_Release(__pyx_gilstate_save);
        #endif
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 765; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_fixed_steps = ((int)(__pyx_t_16 / __pyx_v_fixed_delt));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line766")'> 766: 			step = 0</pre>
<pre id='line766' class='code' style='background-color: #FFFFd4'>
      /* "libchemicalstring_2.pyx":766
 * 			fixed_time_step = time - data[3][-1]
 * 			fixed_steps = int((fixed_time_step + fixed_delt) / fixed_delt)
 * 			step = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			while step <code><</code> fixed_steps:
 * 				fixed_time = last_fixed_time + fixed_delt
 */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_step);
      __pyx_v_step = __pyx_int_0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line767")'> 767: 			while step &lt; fixed_steps:</pre>
<pre id='line767' class='code' style='background-color: #FFFF5e'>
      /* "libchemicalstring_2.pyx":767
 * 			fixed_steps = int((fixed_time_step + fixed_delt) / fixed_delt)
 * 			step = 0
 * 			while step <code><</code> fixed_steps:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				fixed_time = last_fixed_time + fixed_delt
 * 				last_fixed_time = fixed_time
 */
      while (1) {
        __pyx_t_18 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_fixed_steps);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 767; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
        __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_step, __pyx_t_18, Py_LT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 767; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_11 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_11 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 767; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (!__pyx_t_11) break;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line768")'> 768: 				fixed_time = last_fixed_time + fixed_delt</pre>
<pre id='line768' class='code' style='background-color: #FFFFff'>
        /* "libchemicalstring_2.pyx":768
 * 			step = 0
 * 			while step <code><</code> fixed_steps:
 * 				fixed_time = last_fixed_time + fixed_delt             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				last_fixed_time = fixed_time
 * 				counts[3] = fixed_time
 */
        __pyx_v_fixed_time = (__pyx_v_last_fixed_time + __pyx_v_fixed_delt);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line769")'> 769: 				last_fixed_time = fixed_time</pre>
<pre id='line769' class='code' style='background-color: #FFFFff'>
        /* "libchemicalstring_2.pyx":769
 * 			while step <code><</code> fixed_steps:
 * 				fixed_time = last_fixed_time + fixed_delt
 * 				last_fixed_time = fixed_time             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				counts[3] = fixed_time
 * 				update_functions()
 */
        __pyx_v_last_fixed_time = __pyx_v_fixed_time;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line770")'> 770: 				counts[3] = fixed_time</pre>
<pre id='line770' class='code' style='background-color: #FFFF8d'>
        /* "libchemicalstring_2.pyx":770
 * 				fixed_time = last_fixed_time + fixed_delt
 * 				last_fixed_time = fixed_time
 * 				counts[3] = fixed_time             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				update_functions()
 * 				capture()
 */
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_fixed_time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_counts, 3, __pyx_t_1, sizeof(long), PyInt_FromLong, 0, 0, 0) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line771")'> 771: 				update_functions()</pre>
<pre id='line771' class='code' style='background-color: #FFFF9f'>
        /* "libchemicalstring_2.pyx":771
 * 				last_fixed_time = fixed_time
 * 				counts[3] = fixed_time
 * 				update_functions()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				capture()
 * 				step += 1
 */
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_v_update_functions, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 771; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line772")'> 772: 				capture()</pre>
<pre id='line772' class='code' style='background-color: #FFFF9f'>
        /* "libchemicalstring_2.pyx":772
 * 				counts[3] = fixed_time
 * 				update_functions()
 * 				capture()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 				step += 1
 * 			'''
 */
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_v_capture, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line773")'> 773: 				step += 1</pre>
<pre id='line773' class='code' style='background-color: #FFFF9f'>
        /* "libchemicalstring_2.pyx":773
 * 				update_functions()
 * 				capture()
 * 				step += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 			'''
 * 			for fixed_update in range(fixed_steps):
 */
        __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_step, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 773; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_step);
        __pyx_v_step = __pyx_t_1;
        __pyx_t_1 = 0;
      }
      goto __pyx_L73;
    }
    __pyx_L73:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line774")'> 774: 			'''</pre>
<pre id='line774' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line775")'> 775: 			for fixed_update in range(fixed_steps):</pre>
<pre id='line775' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line776")'> 776: 				fixed_time = last_fixed_time + fixed_delt</pre>
<pre id='line776' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line777")'> 777: 				last_fixed_time = fixed_time</pre>
<pre id='line777' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line778")'> 778: 				counts[3] = fixed_time</pre>
<pre id='line778' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line779")'> 779: 				update_functions()</pre>
<pre id='line779' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line780")'> 780: 				capture()</pre>
<pre id='line780' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line781")'> 781: 			'''</pre>
<pre id='line781' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line782")'> 782: </pre>
<pre id='line782' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line783")'> 783: 		#react the chosen reaction which modifies the counts vector</pre>
<pre id='line783' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line784")'> 784: 		#update the propensities which depended on this rxn's</pre>
<pre id='line784' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line785")'> 785: 		# change to the system state</pre>
<pre id='line785' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line786")'> 786: 		reactions[rxn_dex]()</pre>
<pre id='line786' class='code' style='background-color: #FFFF86'>
    /* "libchemicalstring_2.pyx":786
 * 		#update the propensities which depended on this rxn's
 * 		# change to the system state
 * 		reactions[rxn_dex]()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		propensities[rxn_dex]()
 * 
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_reactions, __pyx_v_rxn_dex, sizeof(int), PyInt_FromLong, 0, 1, 0);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_18 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line787")'> 787: 		propensities[rxn_dex]()</pre>
<pre id='line787' class='code' style='background-color: #FFFF86'>
    /* "libchemicalstring_2.pyx":787
 * 		# change to the system state
 * 		reactions[rxn_dex]()
 * 		propensities[rxn_dex]()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#hack fix to capture of last time point
 */
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_propensities, __pyx_v_rxn_dex, sizeof(int), PyInt_FromLong, 0, 1, 0);<span class='error_goto'> if (!__pyx_t_18) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_18, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line788")'> 788: </pre>
<pre id='line788' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line789")'> 789: 	#hack fix to capture of last time point</pre>
<pre id='line789' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line790")'> 790: 	remainder_time = time - fixed_time</pre>
<pre id='line790' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":790
 * 
 * 	#hack fix to capture of last time point
 * 	remainder_time = time - fixed_time             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 	if (remainder_time > fixed_delt):
 * 		fixed_time = last_fixed_time + fixed_delt
 */
  __pyx_v_remainder_time = (__pyx_v_time - __pyx_v_fixed_time);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line791")'> 791: 	if (remainder_time &gt; fixed_delt):</pre>
<pre id='line791' class='code' style='background-color: #FFFFff'>
  /* "libchemicalstring_2.pyx":791
 * 	#hack fix to capture of last time point
 * 	remainder_time = time - fixed_time
 * 	if (remainder_time > fixed_delt):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		fixed_time = last_fixed_time + fixed_delt
 * 		last_fixed_time = fixed_time
 */
  __pyx_t_11 = ((__pyx_v_remainder_time > __pyx_v_fixed_delt) != 0);
  if (__pyx_t_11) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line792")'> 792: 		fixed_time = last_fixed_time + fixed_delt</pre>
<pre id='line792' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":792
 * 	remainder_time = time - fixed_time
 * 	if (remainder_time > fixed_delt):
 * 		fixed_time = last_fixed_time + fixed_delt             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		last_fixed_time = fixed_time
 * 		counts[3] = fixed_time
 */
    __pyx_v_fixed_time = (__pyx_v_last_fixed_time + __pyx_v_fixed_delt);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line793")'> 793: 		last_fixed_time = fixed_time</pre>
<pre id='line793' class='code' style='background-color: #FFFFff'>
    /* "libchemicalstring_2.pyx":793
 * 	if (remainder_time > fixed_delt):
 * 		fixed_time = last_fixed_time + fixed_delt
 * 		last_fixed_time = fixed_time             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		counts[3] = fixed_time
 * 		update_functions()
 */
    __pyx_v_last_fixed_time = __pyx_v_fixed_time;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line794")'> 794: 		counts[3] = fixed_time</pre>
<pre id='line794' class='code' style='background-color: #FFFF8d'>
    /* "libchemicalstring_2.pyx":794
 * 		fixed_time = last_fixed_time + fixed_delt
 * 		last_fixed_time = fixed_time
 * 		counts[3] = fixed_time             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		update_functions()
 * 		capture()
 */
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_fixed_time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_counts, 3, __pyx_t_1, sizeof(long), PyInt_FromLong, 0, 0, 0) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line795")'> 795: 		update_functions()</pre>
<pre id='line795' class='code' style='background-color: #FFFF9f'>
    /* "libchemicalstring_2.pyx":795
 * 		last_fixed_time = fixed_time
 * 		counts[3] = fixed_time
 * 		update_functions()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 		capture()
 * 
 */
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_v_update_functions, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line796")'> 796: 		capture()</pre>
<pre id='line796' class='code' style='background-color: #FFFF9f'>
    /* "libchemicalstring_2.pyx":796
 * 		counts[3] = fixed_time
 * 		update_functions()
 * 		capture()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 	#list of labels in 1 - 1 correspondance with data lists
 */
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_v_capture, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 796; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L76;
  }
  __pyx_L76:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line797")'> 797: </pre>
<pre id='line797' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line798")'> 798: 	#list of labels in 1 - 1 correspondance with data lists</pre>
<pre id='line798' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF12' onclick='toggleDiv("line799")'> 799: 	return data, targets</pre>
<pre id='line799' class='code' style='background-color: #FFFF12'>
  /* "libchemicalstring_2.pyx":799
 * 
 * 	#list of labels in 1 - 1 correspondance with data lists
 * 	return data, targets             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_data));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_data));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_data));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_targets);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_targets);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_targets);
  __pyx_r = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  __PYX_XDEC_MEMVIEW(&__pyx_t_20, 1);
  __PYX_XDEC_MEMVIEW(&__pyx_t_22, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stringchemical.simulate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_handle);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_species);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_variables);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_functions);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rxns);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_capture);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_targets);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sub_var_string);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_var_vals);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_counts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_count_targets);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_func_names);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_update_functions);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rxn_split);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rate_call_group);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_propensities);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_validators);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_reactions);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_reagents);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_products);
  __PYX_XDEC_MEMVIEW(&__pyx_v_propensity_table, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_prop);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_target_dexes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ends);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_test);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_capts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_capture_test);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_uses_time);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_capt);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_rndvar);
  __PYX_XDEC_MEMVIEW(&__pyx_v_rxn_table, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_timedex);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bad_dex);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_step);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vari);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_amt);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_spec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_func);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rxn_string);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_targ);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_spl);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_array___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_array___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_shape = 0;
  Py_ssize_t __pyx_v_itemsize;
  PyObject *__pyx_v_format = 0;
  PyObject *__pyx_v_mode = 0;
  int __pyx_v_allocate_buffer;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__shape,&__pyx_n_s__itemsize,&__pyx_n_s__format,&__pyx_n_s__mode,&__pyx_n_s__allocate_buffer,0};
    PyObject* values[5] = {0,0,0,0,0};
    values[3] = ((PyObject *)__pyx_n_u__c);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__shape)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__itemsize)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 3, 5, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[1]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__format)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 3, 5, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[1]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__mode);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__allocate_buffer);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[1]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_shape = ((PyObject*)values[0]);
    __pyx_v_itemsize = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_itemsize == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_format = values[2];
    __pyx_v_mode = values[3];
    if (values[4]) {
      __pyx_v_allocate_buffer = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[4]);<span class='error_goto'> if (unlikely((__pyx_v_allocate_buffer == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line800")'> 800: </pre>
<pre id='line800' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line801")'> 801: </pre>
<pre id='line801' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line802")'> 802: </pre>
<pre id='line802' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line803")'> 803: #__main__ entry point used for profiling using the default system string</pre>
<pre id='line803' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line804")'> 804: if __name__ == '__main__': simulate()</pre>
<pre id='line804' class='code' style='background-color: #FFFF4d'>
  /* "libchemicalstring_2.pyx":804
 * 
 * #__main__ entry point used for profiling using the default system string
 * if __name__ == '__main__': simulate()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s____name__);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 804; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, ((PyObject *)__pyx_n_s____main__), Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 804; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 804; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__simulate);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 804; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 804; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L2;
  }
  __pyx_L2:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line805")'> 805: </pre>
<pre id='line805' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line806")'> 806: </pre>
<pre id='line806' class='code' style='background-color: #FFFFff'></pre></body></html>
